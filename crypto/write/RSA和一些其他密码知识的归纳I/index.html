<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><meta name="theme-color" content="#FFF"><link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png"><link rel="icon" type="image/ico" sizes="32x32" href="/images/favicon.ico"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link rel="alternate" type="application/rss+xml" title="GNI+Eliauk" href="http://kyrita.top/rss.xml"><link rel="alternate" type="application/atom+xml" title="GNI+Eliauk" href="http://kyrita.top/atom.xml"><link rel="alternate" type="application/json" title="GNI+Eliauk" href="http://kyrita.top/feed.json"><link rel="stylesheet" href="//fonts.googleapis.com/css?family=Mulish:300,300italic,400,400italic,700,700italic%7CFredericka%20the%20Great:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20JP:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20SC:300,300italic,400,400italic,700,700italic%7CInconsolata:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext"><link rel="stylesheet" href="/css/app.css?v=0.2.5"><meta name="keywords" content="crypto整合"><link rel="canonical" href="http://kyrita.top/crypto/write/RSA%E5%92%8C%E4%B8%80%E4%BA%9B%E5%85%B6%E4%BB%96%E5%AF%86%E7%A0%81%E7%9F%A5%E8%AF%86%E7%9A%84%E5%BD%92%E7%BA%B3I/"><title>十万个 Crypto【Updating...】 - 密码学 - Write-up | E raser = GNI+Eliauk = 每天身体健康 事事如意</title><meta name="generator" content="Hexo 5.3.0"></head><body itemscope itemtype="http://schema.org/WebPage"><div id="loading"><div id="counter-container" class="container"><div class="animation"><div class="circle top-left"><div class="line a"></div><div class="straight a"></div></div><div class="circle top-right"><div class="line b"></div><div class="straight b"></div></div><div class="drone-body"><div class="counter"><div class="count" id="count"></div></div></div><div class="circle bottom-left"><div class="line c"></div><div class="straight c"></div></div><div class="circle bottom-right"><div class="line d"></div><div class="straight d"></div></div></div><p class="page-loading">LOADING...</p><p class="page-loading2">LOADING...</p></div></div><div id="container"><header id="header" itemscope itemtype="http://schema.org/WPHeader"><div class="inner"><div id="brand"><div class="pjax"><h1 itemprop="name headline">十万个 Crypto【Updating...】</h1><div class="meta"><span class="item" title="创建时间：2022-03-05 22:36:06"><span class="icon"><i class="ic i-calendar"></i> </span><span class="text">发表于</span> <time itemprop="dateCreated datePublished" datetime="2022-03-05T22:36:06+08:00">2022-03-05</time> </span><span class="item" title="本文字数"><span class="icon"><i class="ic i-pen"></i> </span><span class="text">本文字数</span> <span>175k</span> <span class="text">字</span> </span><span class="item" title="阅读时长"><span class="icon"><i class="ic i-clock"></i> </span><span class="text">阅读时长</span> <span>2:39</span></span></div></div></div><nav id="nav"><div class="inner"><div class="toggle"><div class="lines" aria-label="切换导航栏"><span class="line"></span> <span class="line"></span> <span class="line"></span></div></div><ul class="menu"><li class="item title"><a href="/" rel="start">E raser</a></li></ul><ul class="right"><li class="item theme"><i class="ic i-sun"></i></li><li class="item search"><i class="ic i-search"></i></li></ul></div></nav></div><div id="imgs" class="pjax"><img src="https://s1.ax1x.com/2022/04/14/L1Xm4S.jpg"></div><div id="waves"><svg class="waves" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto"><defs><path id="gentle-wave" d="M-160 44c30 0 58-18 88-18s 58 18 88 18 58-18 88-18 58 18 88 18 v44h-352z"/></defs><g class="parallax"><use xlink:href="#gentle-wave" x="48" y="0"/><use xlink:href="#gentle-wave" x="48" y="3"/><use xlink:href="#gentle-wave" x="48" y="5"/><use xlink:href="#gentle-wave" x="48" y="7"/></g></svg></div></header><main><div class="inner"><div id="main" class="pjax"><div class="article wrap"><div class="breadcrumb" itemscope itemtype="https://schema.org/BreadcrumbList"><i class="ic i-home"></i> <span><a href="/">首页</a></span><i class="ic i-angle-right"></i> <span itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem"><a href="/categories/crypto/" itemprop="item" rel="index" title="分类于 Write-up"><span itemprop="name">Write-up</span></a><meta itemprop="position" content="1"></span><i class="ic i-angle-right"></i> <span class="current" itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem"><a href="/categories/crypto/write/" itemprop="item" rel="index" title="分类于 密码学"><span itemprop="name">密码学</span></a><meta itemprop="position" content="2"></span></div><article itemscope itemtype="http://schema.org/Article" class="post block" lang="zh-CN"><link itemprop="mainEntityOfPage" href="http://kyrita.top/crypto/write/RSA%E5%92%8C%E4%B8%80%E4%BA%9B%E5%85%B6%E4%BB%96%E5%AF%86%E7%A0%81%E7%9F%A5%E8%AF%86%E7%9A%84%E5%BD%92%E7%BA%B3I/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/avatar.jpg"><meta itemprop="name" content="GNIeliauk"><meta itemprop="description" content="每天身体健康 事事如意, 再不放假就要坏掉了"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="GNI+Eliauk"></span><div class="body md" itemprop="articleBody"><p>顾及到做密码时候会遇到很多奇奇怪怪的编码，甚至就会因为这几个让人摸不着脑的疑惑卡住整个进程；所以我想在讲述 RSA、ECC 这些算法之前先把我最近遇到过的概念总结一下。<br><a id="more"></a></p><h1 id="rsa"><a class="anchor" href="#rsa">#</a> RSA</h1><h2 id="factoring-large-integers"><a class="anchor" href="#factoring-large-integers">#</a> Factoring Large Integers</h2><p>给定模数 n，共有指数 e 和私有指数 d，如何利用 ed 获取 p 和 q 呢？</p><p>通常都是小网站安排上直接分解 p、q，快捷便利不香么？</p><p>但是这次在这里这招不行</p><p>不信？试试分解一下下面这个</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre>n <span class="token operator">=</span> <span class="token number">16352578963372306131642407541567045533766691177138375676491913897592458965544068296813122740126583082006556217616296009516413202833698268845634497478988128850373221853516973259086845725813424850548682503827191121548693288763243619033224322698075987667531863213468223654181658012754897588147027437229269098246969811226129883327598021859724836993626315476699384610680857047403431430525708390695622848315322636785398223207468754197643541958599210127261345770914514670199047435085714403641469016212958361993969304545214061560160267760786482163373784437641808292654489343487613446165542988382687729593384887516272690654309</span></pre></td></tr><tr><td data-num="2"></td><td><pre>e <span class="token operator">=</span> <span class="token number">65537</span></pre></td></tr><tr><td data-num="3"></td><td><pre>d <span class="token operator">=</span> <span class="token number">9459928379973667430138068528059438139092368625339079253289560577985304435062213121398231875832264894458314629575455553485752685643743266654630829957442008775259776311585654014858165341757547284112061885158006881475740553532826576260839430343960738520822367975528644329172668877696208741007648370045520535298040161675407779239300466681615493892692265542290255408673533853011662134953869432632554008235340864803377610352438146264524770710345273439724107080190182918285547426166561803716644089414078389475072103315432638197578186106576626728869020366214077455194554930725576023274922741115941214789600089166754476449453</span></pre></td></tr></table></figure><p>结果如何。</p><p><img data-src="https://s1.ax1x.com/2022/04/14/L1Xfvd.png" alt=""></p><p>长度 617，还是质数的模数，怎么破都破不开，那是不是就分不出 p 和 q 了呢？</p><p>Don't 担心。其实这个问题早在 90 年代就被 boneh 先生给思考透了</p><p><a target="_blank" rel="noopener" href="https://imgtu.com/i/L1vw01"><img data-src="https://s1.ax1x.com/2022/04/14/L1vw01.png" alt="L1vw01.png"></a></p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>d</mi><mi>e</mi><mo>≡</mo><mn>1</mn><mi>m</mi><mi>o</mi><mi>d</mi><mi>ϕ</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mspace linebreak="newline"></mspace><mtext>对于（</mtext><mn>2</mn><mtext>，</mtext><mi>n</mi><mtext>）中的任何随机数，存在一个数</mtext><mi>x</mi><mtext>使得</mtext><mn>1</mn><mi>m</mi><mi>o</mi><mi>d</mi><mi>n</mi><mtext>存在，最后通过</mtext><mi>g</mi><mi>c</mi><mi>d</mi><mtext>（</mtext><mi>x</mi><mo>−</mo><mn>1</mn><mtext>，</mtext><mi>n</mi><mtext>）求出</mtext><mi>p</mi><mspace linebreak="newline"></mspace><mi>R</mi><mi>S</mi><mi>A</mi><mtext>中恒不变的</mtext><mi>d</mi><mi>e</mi><mo>≡</mo><mn>1</mn><mi>m</mi><mi>o</mi><mi>d</mi><mo stretchy="false">(</mo><mi>p</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo><mtext>及</mtext><mi>d</mi><mi>e</mi><mo>≡</mo><mn>1</mn><mi>m</mi><mi>o</mi><mi>d</mi><mo stretchy="false">(</mo><mi>q</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">de \equiv 1mod \phi(n) \\ 对于（2，n）中的任何随机数，存在一个数x使得1modn存在，最后通过gcd（x-1，n）求出p\\RSA中恒不变的de\equiv1mod(p-1)及de\equiv1mod(q-1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.69444em;vertical-align:0"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">e</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">≡</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord">1</span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mord mathnormal">ϕ</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:.8888799999999999em;vertical-align:-.19444em"></span><span class="mord cjk_fallback">对</span><span class="mord cjk_fallback">于</span><span class="mord cjk_fallback">（</span><span class="mord">2</span><span class="mord cjk_fallback">，</span><span class="mord mathnormal">n</span><span class="mord cjk_fallback">）</span><span class="mord cjk_fallback">中</span><span class="mord cjk_fallback">的</span><span class="mord cjk_fallback">任</span><span class="mord cjk_fallback">何</span><span class="mord cjk_fallback">随</span><span class="mord cjk_fallback">机</span><span class="mord cjk_fallback">数</span><span class="mord cjk_fallback">，</span><span class="mord cjk_fallback">存</span><span class="mord cjk_fallback">在</span><span class="mord cjk_fallback">一</span><span class="mord cjk_fallback">个</span><span class="mord cjk_fallback">数</span><span class="mord mathnormal">x</span><span class="mord cjk_fallback">使</span><span class="mord cjk_fallback">得</span><span class="mord">1</span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mord mathnormal">n</span><span class="mord cjk_fallback">存</span><span class="mord cjk_fallback">在</span><span class="mord cjk_fallback">，</span><span class="mord cjk_fallback">最</span><span class="mord cjk_fallback">后</span><span class="mord cjk_fallback">通</span><span class="mord cjk_fallback">过</span><span class="mord mathnormal" style="margin-right:.03588em">g</span><span class="mord mathnormal">c</span><span class="mord mathnormal">d</span><span class="mord cjk_fallback">（</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.8777699999999999em;vertical-align:-.19444em"></span><span class="mord">1</span><span class="mord cjk_fallback">，</span><span class="mord mathnormal">n</span><span class="mord cjk_fallback">）</span><span class="mord cjk_fallback">求</span><span class="mord cjk_fallback">出</span><span class="mord mathnormal">p</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:.69444em;vertical-align:0"></span><span class="mord mathnormal" style="margin-right:.00773em">R</span><span class="mord mathnormal" style="margin-right:.05764em">S</span><span class="mord mathnormal">A</span><span class="mord cjk_fallback">中</span><span class="mord cjk_fallback">恒</span><span class="mord cjk_fallback">不</span><span class="mord cjk_fallback">变</span><span class="mord cjk_fallback">的</span><span class="mord mathnormal">d</span><span class="mord mathnormal">e</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">≡</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord">1</span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mopen">(</span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord">1</span><span class="mclose">)</span><span class="mord cjk_fallback">及</span><span class="mord mathnormal">d</span><span class="mord mathnormal">e</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">≡</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord">1</span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:.03588em">q</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord">1</span><span class="mclose">)</span></span></span></span></span></p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mtext>定义</mtext><mi>k</mi><mtext>为</mtext><mi>p</mi><mo>−</mo><mn>1</mn><mtext>和</mtext><mi>q</mi><mo>−</mo><mn>1</mn><mtext>的最小公倍数</mtext><mi>l</mi><mi>c</mi><mi>m</mi><mo stretchy="false">(</mo><mi>p</mi><mo>−</mo><mn>1</mn><mo separator="true">,</mo><mi>q</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo><mspace width="1em"><mtext>由此可得</mtext><mi>d</mi><mi>e</mi><mo>≡</mo><mn>1</mn><mi>m</mi><mi>o</mi><mi>d</mi><mi>k</mi><mspace width="1em"><mtext>这是</mtext><mi>ϕ</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mtext>的严格除数</mtext></mrow><annotation encoding="application/x-tex">定义k为p-1和q-1的最小公倍数lcm(p-1,q-1) \quad 由此可得de\equiv1modk \quad 这是\phi(n)的严格除数</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8888799999999999em;vertical-align:-.19444em"></span><span class="mord cjk_fallback">定</span><span class="mord cjk_fallback">义</span><span class="mord mathnormal" style="margin-right:.03148em">k</span><span class="mord cjk_fallback">为</span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.8777699999999999em;vertical-align:-.19444em"></span><span class="mord">1</span><span class="mord cjk_fallback">和</span><span class="mord mathnormal" style="margin-right:.03588em">q</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord">1</span><span class="mord cjk_fallback">的</span><span class="mord cjk_fallback">最</span><span class="mord cjk_fallback">小</span><span class="mord cjk_fallback">公</span><span class="mord cjk_fallback">倍</span><span class="mord cjk_fallback">数</span><span class="mord mathnormal" style="margin-right:.01968em">l</span><span class="mord mathnormal">c</span><span class="mord mathnormal">m</span><span class="mopen">(</span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.8388800000000001em;vertical-align:-.19444em"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord mathnormal" style="margin-right:.03588em">q</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right:1em"></span><span class="mord cjk_fallback">由</span><span class="mord cjk_fallback">此</span><span class="mord cjk_fallback">可</span><span class="mord cjk_fallback">得</span><span class="mord mathnormal">d</span><span class="mord mathnormal">e</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">≡</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord">1</span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mord mathnormal" style="margin-right:.03148em">k</span><span class="mspace" style="margin-right:1em"></span><span class="mord cjk_fallback">这</span><span class="mord cjk_fallback">是</span><span class="mord mathnormal">ϕ</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span><span class="mord cjk_fallback">的</span><span class="mord cjk_fallback">严</span><span class="mord cjk_fallback">格</span><span class="mord cjk_fallback">除</span><span class="mord cjk_fallback">数</span></span></span></span></span></p><p>有些隐约其辞是不啦，简单点来讲就是</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mtext>首先我们需要计算一个未知数</mtext><mi>k</mi><mo>=</mo><mi>d</mi><mi>e</mi><mo>−</mo><mn>1</mn><mo separator="true">,</mo><mtext>选取一个随机变量</mtext><mi>g</mi><mo stretchy="false">(</mo><mn>1</mn><mo>&lt;</mo><mi>g</mi><mo>&lt;</mo><mi>n</mi><mo stretchy="false">)</mo><mtext>；</mtext><mspace linebreak="newline"></mspace><mtext>再设一个数</mtext><mi>k</mi><mo>=</mo><msup><mn>2</mn><mi>t</mi></msup><mi>r</mi><mspace width="1em"><mi>r</mi><mo>∈</mo><mi>o</mi><mi>d</mi><mi>d</mi><mspace width="1em"><mi>a</mi><mi>n</mi><mi>d</mi><mspace width="1em"><mi>t</mi><mo>≥</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">首先我们需要计算一个未知数k=de-1,选取一个随机变量g (1 &lt; g &lt; n)；\\再设一个数k=2^tr \quad r \in odd \quad and \quad t \geq1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.69444em;vertical-align:0"></span><span class="mord cjk_fallback">首</span><span class="mord cjk_fallback">先</span><span class="mord cjk_fallback">我</span><span class="mord cjk_fallback">们</span><span class="mord cjk_fallback">需</span><span class="mord cjk_fallback">要</span><span class="mord cjk_fallback">计</span><span class="mord cjk_fallback">算</span><span class="mord cjk_fallback">一</span><span class="mord cjk_fallback">个</span><span class="mord cjk_fallback">未</span><span class="mord cjk_fallback">知</span><span class="mord cjk_fallback">数</span><span class="mord mathnormal" style="margin-right:.03148em">k</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.77777em;vertical-align:-.08333em"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">e</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord cjk_fallback">选</span><span class="mord cjk_fallback">取</span><span class="mord cjk_fallback">一</span><span class="mord cjk_fallback">个</span><span class="mord cjk_fallback">随</span><span class="mord cjk_fallback">机</span><span class="mord cjk_fallback">变</span><span class="mord cjk_fallback">量</span><span class="mord mathnormal" style="margin-right:.03588em">g</span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.7335400000000001em;vertical-align:-.19444em"></span><span class="mord mathnormal" style="margin-right:.03588em">g</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathnormal">n</span><span class="mclose">)</span><span class="mord cjk_fallback">；</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:.69444em;vertical-align:0"></span><span class="mord cjk_fallback">再</span><span class="mord cjk_fallback">设</span><span class="mord cjk_fallback">一</span><span class="mord cjk_fallback">个</span><span class="mord cjk_fallback">数</span><span class="mord mathnormal" style="margin-right:.03148em">k</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.882656em;vertical-align:-.0391em"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.843556em"><span style="top:-3.113em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:.02778em">r</span><span class="mspace" style="margin-right:1em"></span><span class="mord mathnormal" style="margin-right:.02778em">r</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.83041em;vertical-align:-.13597em"></span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mord mathnormal">d</span><span class="mspace" style="margin-right:1em"></span><span class="mord mathnormal">a</span><span class="mord mathnormal">n</span><span class="mord mathnormal">d</span><span class="mspace" style="margin-right:1em"></span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">≥</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">1</span></span></span></span></span></p><p>由通式可以知道，de 是质数，de-1 一定是合数，k 一定是合数。</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mtext>接下来我们可以计算</mtext><mi>x</mi><mtext>（</mtext><mi>x</mi><mo>=</mo><msup><mi>g</mi><mrow><mi>k</mi><mi mathvariant="normal">/</mi><mn>2</mn></mrow></msup><mo separator="true">,</mo><msup><mi>g</mi><mrow><mi>k</mi><mi mathvariant="normal">/</mi><mn>4</mn></mrow></msup><mo separator="true">,</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo separator="true">,</mo><msup><mi>g</mi><mrow><mi>k</mi><mi mathvariant="normal">/</mi><msup><mn>2</mn><mi>t</mi></msup></mrow></msup><mtext>）直到</mtext><mi>x</mi><mo>&gt;</mo><mn>1</mn><mspace width="1em"><mi>a</mi><mi>n</mi><mi>d</mi><mspace width="1em"><mi>g</mi><mi>c</mi><mi>d</mi><mo stretchy="false">(</mo><mi>x</mi><mo>−</mo><mn>1</mn><mo separator="true">,</mo><mi>n</mi><mo stretchy="false">)</mo><mo>&gt;</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">接下来我们可以计算x（x=g^{k/2},g^{k/4},...,g^{k/2^t}）直到x&gt;1 \quad and \quad gcd(x-1,n)&gt;1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.68333em;vertical-align:0"></span><span class="mord cjk_fallback">接</span><span class="mord cjk_fallback">下</span><span class="mord cjk_fallback">来</span><span class="mord cjk_fallback">我</span><span class="mord cjk_fallback">们</span><span class="mord cjk_fallback">可</span><span class="mord cjk_fallback">以</span><span class="mord cjk_fallback">计</span><span class="mord cjk_fallback">算</span><span class="mord mathnormal">x</span><span class="mord cjk_fallback">（</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1.2166799999999998em;vertical-align:-.19444em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.03588em">g</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.938em"><span style="top:-3.113em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:.03148em">k</span><span class="mord mtight">/</span><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.03588em">g</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.938em"><span style="top:-3.113em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:.03148em">k</span><span class="mord mtight">/</span><span class="mord mtight">4</span></span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.03588em">g</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.0222399999999998em"><span style="top:-3.113em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:.03148em">k</span><span class="mord mtight">/</span><span class="mord mtight"><span class="mord mtight">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8703428571428571em"><span style="top:-2.931em;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="mord cjk_fallback">）</span><span class="mord cjk_fallback">直</span><span class="mord cjk_fallback">到</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord">1</span><span class="mspace" style="margin-right:1em"></span><span class="mord mathnormal">a</span><span class="mord mathnormal">n</span><span class="mord mathnormal">d</span><span class="mspace" style="margin-right:1em"></span><span class="mord mathnormal" style="margin-right:.03588em">g</span><span class="mord mathnormal">c</span><span class="mord mathnormal">d</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord mathnormal">n</span><span class="mclose">)</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">1</span></span></span></span></span></p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mtext>最后</mtext><mi>p</mi><mtext>为</mtext><mi>g</mi><mi>c</mi><mi>d</mi><mo stretchy="false">(</mo><mi>x</mi><mo>−</mo><mn>1</mn><mo separator="true">,</mo><mi>n</mi><mo stretchy="false">)</mo><mo separator="true">,</mo><mi>q</mi><mtext>为</mtext><mi>n</mi><mi mathvariant="normal">/</mi><mi>p</mi></mrow><annotation encoding="application/x-tex">最后p为gcd(x-1,n),q为n/p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord cjk_fallback">最</span><span class="mord cjk_fallback">后</span><span class="mord mathnormal">p</span><span class="mord cjk_fallback">为</span><span class="mord mathnormal" style="margin-right:.03588em">g</span><span class="mord mathnormal">c</span><span class="mord mathnormal">d</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord mathnormal">n</span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord mathnormal" style="margin-right:.03588em">q</span><span class="mord cjk_fallback">为</span><span class="mord mathnormal">n</span><span class="mord">/</span><span class="mord mathnormal">p</span></span></span></span></span></p><figure class="highlight matlab"><figcaption data-lang="MATLAB"></figcaption><table><tr><td data-num="1"></td><td><pre>Input<span class="token operator">:</span> N<span class="token operator">=</span><span class="token number">25777</span><span class="token punctuation">,</span> e<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">,</span> d<span class="token operator">=</span><span class="token number">16971</span></pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre>k<span class="token operator">=</span>de<span class="token operator">-</span><span class="token number">1</span><span class="token operator">=</span><span class="token number">50912</span></pre></td></tr><tr><td data-num="4"></td><td><pre></pre></td></tr><tr><td data-num="5"></td><td><pre>Trying g<span class="token operator">=</span><span class="token number">2</span></pre></td></tr><tr><td data-num="6"></td><td><pre></pre></td></tr><tr><td data-num="7"></td><td><pre>t<span class="token operator">=</span><span class="token number">25456</span></pre></td></tr><tr><td data-num="8"></td><td><pre>x<span class="token operator">=</span>g<span class="token operator">^</span>t mod N<span class="token operator">=</span><span class="token number">1</span></pre></td></tr><tr><td data-num="9"></td><td><pre></pre></td></tr><tr><td data-num="10"></td><td><pre>t<span class="token operator">=</span><span class="token number">12728</span></pre></td></tr><tr><td data-num="11"></td><td><pre>x<span class="token operator">=</span>g<span class="token operator">^</span>t mod N<span class="token operator">=</span><span class="token number">1</span></pre></td></tr><tr><td data-num="12"></td><td><pre></pre></td></tr><tr><td data-num="13"></td><td><pre>t<span class="token operator">=</span><span class="token number">6364</span></pre></td></tr><tr><td data-num="14"></td><td><pre>x<span class="token operator">=</span>g<span class="token operator">^</span>t mod N<span class="token operator">=</span><span class="token number">1</span></pre></td></tr><tr><td data-num="15"></td><td><pre></pre></td></tr><tr><td data-num="16"></td><td><pre>t<span class="token operator">=</span><span class="token number">3182</span></pre></td></tr><tr><td data-num="17"></td><td><pre>x<span class="token operator">=</span>g<span class="token operator">^</span>t mod N<span class="token operator">=</span><span class="token number">25776</span></pre></td></tr><tr><td data-num="18"></td><td><pre>y<span class="token operator">=</span><span class="token function">gcd</span><span class="token punctuation">(</span>x<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span>N<span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">1</span></pre></td></tr><tr><td data-num="19"></td><td><pre></pre></td></tr><tr><td data-num="20"></td><td><pre>t<span class="token operator">=</span><span class="token number">1591</span></pre></td></tr><tr><td data-num="21"></td><td><pre>x<span class="token operator">=</span>g<span class="token operator">^</span>t mod N<span class="token operator">=</span><span class="token number">12709</span></pre></td></tr><tr><td data-num="22"></td><td><pre>y<span class="token operator">=</span><span class="token function">gcd</span><span class="token punctuation">(</span>x<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span>N<span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">1</span></pre></td></tr><tr><td data-num="23"></td><td><pre></pre></td></tr><tr><td data-num="24"></td><td><pre>···g<span class="token operator">=</span><span class="token number">2</span> failed···</pre></td></tr><tr><td data-num="25"></td><td><pre></pre></td></tr><tr><td data-num="26"></td><td><pre>Trying g<span class="token operator">=</span><span class="token number">5</span></pre></td></tr><tr><td data-num="27"></td><td><pre></pre></td></tr><tr><td data-num="28"></td><td><pre>t<span class="token operator">=</span><span class="token number">25456</span></pre></td></tr><tr><td data-num="29"></td><td><pre>x<span class="token operator">=</span>g<span class="token operator">^</span>t mod N<span class="token operator">=</span><span class="token number">1</span></pre></td></tr><tr><td data-num="30"></td><td><pre></pre></td></tr><tr><td data-num="31"></td><td><pre>t<span class="token operator">=</span><span class="token number">12728</span></pre></td></tr><tr><td data-num="32"></td><td><pre>x<span class="token operator">=</span>g<span class="token operator">^</span>t mod N<span class="token operator">=</span><span class="token number">1</span></pre></td></tr><tr><td data-num="33"></td><td><pre></pre></td></tr><tr><td data-num="34"></td><td><pre>t<span class="token operator">=</span><span class="token number">6364</span></pre></td></tr><tr><td data-num="35"></td><td><pre>x<span class="token operator">=</span>g<span class="token operator">^</span>t mod N<span class="token operator">=</span><span class="token number">1</span></pre></td></tr><tr><td data-num="36"></td><td><pre></pre></td></tr><tr><td data-num="37"></td><td><pre>t<span class="token operator">=</span><span class="token number">3182</span></pre></td></tr><tr><td data-num="38"></td><td><pre>x<span class="token operator">=</span>g<span class="token operator">^</span>t mod N<span class="token operator">=</span><span class="token number">15050</span></pre></td></tr><tr><td data-num="39"></td><td><pre>y<span class="token operator">=</span><span class="token function">gcd</span><span class="token punctuation">(</span>x<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span>N<span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">149</span></pre></td></tr><tr><td data-num="40"></td><td><pre>p<span class="token operator">=</span><span class="token number">149</span></pre></td></tr><tr><td data-num="41"></td><td><pre>q<span class="token operator">=</span>N<span class="token operator">/</span>p<span class="token operator">=</span><span class="token number">25777</span><span class="token operator">/</span><span class="token number">149</span><span class="token operator">=</span><span class="token number">173</span></pre></td></tr><tr><td data-num="42"></td><td><pre></pre></td></tr><tr><td data-num="43"></td><td><pre>Output<span class="token operator">:</span> p<span class="token operator">=</span><span class="token number">173</span><span class="token punctuation">,</span> q<span class="token operator">=</span><span class="token number">149</span></pre></td></tr></table></figure><p>贴 脚 本</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">import</span> gmpy2</pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">import</span> random</pre></td></tr><tr><td data-num="3"></td><td><pre></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">def</span> <span class="token function">gcd</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="5"></td><td><pre>    <span class="token keyword">if</span> a <span class="token operator">&lt;</span> b<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="6"></td><td><pre>        a<span class="token punctuation">,</span> b <span class="token operator">=</span> b<span class="token punctuation">,</span> a</pre></td></tr><tr><td data-num="7"></td><td><pre>    <span class="token keyword">while</span> b<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="8"></td><td><pre>        a<span class="token punctuation">,</span> b <span class="token operator">=</span> b<span class="token punctuation">,</span> a <span class="token operator">%</span> b</pre></td></tr><tr><td data-num="9"></td><td><pre>    <span class="token keyword">return</span> a</pre></td></tr><tr><td data-num="10"></td><td><pre></pre></td></tr><tr><td data-num="11"></td><td><pre></pre></td></tr><tr><td data-num="12"></td><td><pre><span class="token keyword">def</span> <span class="token function">getpq</span><span class="token punctuation">(</span>n<span class="token punctuation">,</span>e<span class="token punctuation">,</span>d<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="13"></td><td><pre>	p <span class="token operator">=</span> <span class="token number">1</span></pre></td></tr><tr><td data-num="14"></td><td><pre>	q <span class="token operator">=</span> <span class="token number">1</span></pre></td></tr><tr><td data-num="15"></td><td><pre>	<span class="token keyword">while</span> p<span class="token operator">==</span><span class="token number">1</span> <span class="token keyword">and</span> q<span class="token operator">==</span><span class="token number">1</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="16"></td><td><pre>		k <span class="token operator">=</span> e<span class="token operator">*</span>d <span class="token operator">-</span> <span class="token number">1</span></pre></td></tr><tr><td data-num="17"></td><td><pre>		g <span class="token operator">=</span> random<span class="token punctuation">.</span>randint <span class="token punctuation">(</span> <span class="token number">0</span> <span class="token punctuation">,</span> n <span class="token punctuation">)</span></pre></td></tr><tr><td data-num="18"></td><td><pre>		<span class="token keyword">while</span> k <span class="token operator">%</span> <span class="token number">2</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="19"></td><td><pre>			k <span class="token operator">//=</span> <span class="token number">2</span></pre></td></tr><tr><td data-num="20"></td><td><pre>			y <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>g<span class="token punctuation">,</span>k<span class="token punctuation">,</span>n<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="21"></td><td><pre>			<span class="token keyword">if</span> y<span class="token operator">></span><span class="token number">1</span> <span class="token keyword">and</span> gcd<span class="token punctuation">(</span>y<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span>n<span class="token punctuation">)</span><span class="token operator">></span><span class="token number">1</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="22"></td><td><pre>				p <span class="token operator">=</span> gcd<span class="token punctuation">(</span>y<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span>n<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="23"></td><td><pre>				q <span class="token operator">=</span> n<span class="token operator">//</span>p</pre></td></tr><tr><td data-num="24"></td><td><pre>	<span class="token keyword">return</span> p<span class="token punctuation">,</span>q</pre></td></tr><tr><td data-num="25"></td><td><pre></pre></td></tr><tr><td data-num="26"></td><td><pre><span class="token keyword">def</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="27"></td><td><pre>    n <span class="token operator">=</span> <span class="token number">16352578963372306131642407541567045533766691177138375676491913897592458965544068296813122740126583082006556217616296009516413202833698268845634497478988128850373221853516973259086845725813424850548682503827191121548693288763243619033224322698075987667531863213468223654181658012754897588147027437229269098246969811226129883327598021859724836993626315476699384610680857047403431430525708390695622848315322636785398223207468754197643541958599210127261345770914514670199047435085714403641469016212958361993969304545214061560160267760786482163373784437641808292654489343487613446165542988382687729593384887516272690654309</span></pre></td></tr><tr><td data-num="28"></td><td><pre>    e <span class="token operator">=</span> <span class="token number">65537</span></pre></td></tr><tr><td data-num="29"></td><td><pre>    d <span class="token operator">=</span> <span class="token number">9459928379973667430138068528059438139092368625339079253289560577985304435062213121398231875832264894458314629575455553485752685643743266654630829957442008775259776311585654014858165341757547284112061885158006881475740553532826576260839430343960738520822367975528644329172668877696208741007648370045520535298040161675407779239300466681615493892692265542290255408673533853011662134953869432632554008235340864803377610352438146264524770710345273439724107080190182918285547426166561803716644089414078389475072103315432638197578186106576626728869020366214077455194554930725576023274922741115941214789600089166754476449453</span></pre></td></tr><tr><td data-num="30"></td><td><pre>    p<span class="token punctuation">,</span>q <span class="token operator">=</span> getpq<span class="token punctuation">(</span>n<span class="token punctuation">,</span>e<span class="token punctuation">,</span>d<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="31"></td><td><pre>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"p: %d\nq: %d"</span> <span class="token operator">%</span> <span class="token punctuation">(</span>p<span class="token punctuation">,</span> q<span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="32"></td><td><pre></pre></td></tr><tr><td data-num="33"></td><td><pre></pre></td></tr><tr><td data-num="34"></td><td><pre></pre></td></tr><tr><td data-num="35"></td><td><pre><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="36"></td><td><pre>	main<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="37"></td><td><pre></pre></td></tr><tr><td data-num="38"></td><td><pre></pre></td></tr><tr><td data-num="39"></td><td><pre>    </pre></td></tr><tr><td data-num="40"></td><td><pre><span class="token triple-quoted-string string">'''</span></pre></td></tr><tr><td data-num="41"></td><td><pre>k = e * d - 1</pre></td></tr><tr><td data-num="42"></td><td><pre>x = gmpy2.powmod(2, k // 4, n)</pre></td></tr><tr><td data-num="43"></td><td><pre>assert x != 1</pre></td></tr><tr><td data-num="44"></td><td><pre></pre></td></tr><tr><td data-num="45"></td><td><pre>p = gcd(x - 1, n)</pre></td></tr><tr><td data-num="46"></td><td><pre>q = n//p</pre></td></tr><tr><td data-num="47"></td><td><pre>'''</pre></td></tr><tr><td data-num="48"></td><td><pre><span class="token comment"># print("p: %d\nq: %d" % (p, q))</span></pre></td></tr><tr><td data-num="49"></td><td><pre></pre></td></tr><tr><td data-num="50"></td><td><pre></pre></td></tr><tr><td data-num="51"></td><td><pre><span class="token triple-quoted-string string">'''</span></pre></td></tr><tr><td data-num="52"></td><td><pre>x=0x7876a540f245042663ad66dc19be6714d986f497b2556337b51254d10f503e550076338299765d8afed0df95ac5a0ed57debacd6c7efece0792a0ff5446deec0c4b674b3ead84d23e68e942eac745341d6042519fdf1327c45180ad2683df91625830c05824eaae697e9a620289bd00631207e245f7d55b09bca405f302cbd89f3f9baed871a616ce4c2764c194777b2b516b6ddbbd84daf37a5b46c4b24017b5aca61ef8b6b996910b9504401f0d339d79190ccdcf5176c02c3903e866a02ce75ad3951eecf6b770fed7bd5d5e6e2db3bb6accdf21d9d7ed453bb36b7f35bb9af6e4521e4722625de7f1502544308c9d73fb09fe664d0c8105f75f555bce1ae956a3a6892573d00f5fa5eda68a8a67dc5517d471f9f55925dfe31a907f2bc4b68442690d7ef64f1840ed6862624a7a2d1564415fa82ad9a1aedfe08ea403413f60dadedebd448e8d33d663ec6b4529f1e787f7a0a2293d0d64ed13b57d84d7ddb5943cc74a1871abe8aeef50cadb9c913da012dd6fb74ba1457604c35326ded639deed97187fd513ac8f664160e1ce5896d80a0b224391ebd733a74bd2c204956758d32c719873a9e265f47fa1d5bd1552019eec0893b90cd2933b770155638b8c7322eefd3bdaeef21c52de9def334f1a2b48bddc70c2c7b2bd3f4205cfbabe8d8d816f06e56a1367726cfb3494f32cc65e6749d6523ff5cfc0574e063b4dd</pre></td></tr><tr><td data-num="53"></td><td><pre>print(x)</pre></td></tr><tr><td data-num="54"></td><td><pre>'''</pre></td></tr><tr><td data-num="55"></td><td><pre><span class="token comment">#p: 121681461613856685891389697655082707982324934394003375745821514797619569583750841725694490585739982440237839675155146102668334623474524757328414864963814738071946391260695792366762521733527504377788503669628114869921159658618293030663730923781347146576731525405173348568491361155907470541865888995846800200299</span></pre></td></tr><tr><td data-num="56"></td><td><pre><span class="token comment">#q: 134388416661738455437155072073325006890713121761597606147089758733385481112565493304597414841403553334452751594251761452974840757858360219741735123120957682353146947112071576479841838875008748813717254467137424822946053401492632307085887983816096569782409349352398269269865393361999329194582827715646840442991</span></pre></td></tr></table></figure><p>有好几种写法，其中有一种始终想不明白，为什么 k/4 呢，这个迭代是怎么想出来的啊？有友友懂得求教一下</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre>x <span class="token operator">=</span> gmpy2<span class="token punctuation">.</span>powmod<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> k <span class="token operator">//</span> <span class="token number">4</span><span class="token punctuation">,</span> n<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">assert</span> x <span class="token operator">!=</span> <span class="token number">1</span></pre></td></tr></table></figure><p>而且 getpq 里更改得到的结果完全不一样啊。</p><h2 id="共模攻击"><a class="anchor" href="#共模攻击">#</a> 共模攻击</h2><p>这应该是 buu 的原创题 RSA &amp; what，首先给出两份 output 和一段源码</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> bytes_to_long<span class="token punctuation">,</span> getPrime</pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">from</span> random <span class="token keyword">import</span> randint</pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">from</span> gmpy2 <span class="token keyword">import</span> powmod</pre></td></tr><tr><td data-num="4"></td><td><pre>p <span class="token operator">=</span> getPrime<span class="token punctuation">(</span><span class="token number">2048</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="5"></td><td><pre>q <span class="token operator">=</span> getPrime<span class="token punctuation">(</span><span class="token number">2048</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="6"></td><td><pre>N <span class="token operator">=</span> p<span class="token operator">*</span>q</pre></td></tr><tr><td data-num="7"></td><td><pre>Phi <span class="token operator">=</span> <span class="token punctuation">(</span>p<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>q<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token keyword">def</span> <span class="token function">get_enc_key</span><span class="token punctuation">(</span>N<span class="token punctuation">,</span>Phi<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="9"></td><td><pre>    e <span class="token operator">=</span> getPrime<span class="token punctuation">(</span>N<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="10"></td><td><pre>    <span class="token keyword">if</span> Phi <span class="token operator">%</span> e <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="11"></td><td><pre>        <span class="token keyword">return</span> get_enc_key<span class="token punctuation">(</span>N<span class="token punctuation">,</span> Phi<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="12"></td><td><pre>    <span class="token keyword">else</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="13"></td><td><pre>        <span class="token keyword">return</span> e</pre></td></tr><tr><td data-num="14"></td><td><pre>e1 <span class="token operator">=</span> get_enc_key<span class="token punctuation">(</span>randint<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">,</span> Phi<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="15"></td><td><pre>e2 <span class="token operator">=</span> get_enc_key<span class="token punctuation">(</span>randint<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">,</span> Phi<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="16"></td><td><pre></pre></td></tr><tr><td data-num="17"></td><td><pre>fr <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">r"./base64"</span><span class="token punctuation">,</span> <span class="token string">"rb"</span><span class="token punctuation">)</span><span class="token comment">#flag is in this file</span></pre></td></tr><tr><td data-num="18"></td><td><pre>f1 <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">r"./HUB1"</span><span class="token punctuation">,</span> <span class="token string">"wb"</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="19"></td><td><pre>f2 <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">r"./HUB2"</span><span class="token punctuation">,</span> <span class="token string">"wb"</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="20"></td><td><pre>base64 <span class="token operator">=</span> fr<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="21"></td><td><pre>f1<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string">"%d\n%d\n"</span> <span class="token operator">%</span> <span class="token punctuation">(</span>N<span class="token punctuation">,</span> e1<span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="22"></td><td><pre>f2<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string">"%d\n%d\n"</span> <span class="token operator">%</span> <span class="token punctuation">(</span>N<span class="token punctuation">,</span> e2<span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="23"></td><td><pre><span class="token keyword">while</span> <span class="token builtin">len</span><span class="token punctuation">(</span>base64<span class="token punctuation">)</span><span class="token operator">></span><span class="token number">0</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="24"></td><td><pre>    pt <span class="token operator">=</span> bytes_to_long<span class="token punctuation">(</span>base64<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="25"></td><td><pre>    ct1 <span class="token operator">=</span> powmod<span class="token punctuation">(</span>pt<span class="token punctuation">,</span> e1<span class="token punctuation">,</span> N<span class="token punctuation">)</span>  <span class="token operator">//</span>pt<span class="token operator">^</span>e1MODn<span class="token operator">==</span>ct1</pre></td></tr><tr><td data-num="26"></td><td><pre>    ct2 <span class="token operator">=</span> powmod<span class="token punctuation">(</span>pt<span class="token punctuation">,</span> e2<span class="token punctuation">,</span> N<span class="token punctuation">)</span><span class="token operator">//</span>pt<span class="token operator">^</span>e2MODn<span class="token operator">==</span>ct2</pre></td></tr><tr><td data-num="27"></td><td><pre>    f1<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string">"\n%d"</span> <span class="token operator">%</span> ct1<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="28"></td><td><pre>    f2<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string">"\n%d"</span> <span class="token operator">%</span> ct2<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="29"></td><td><pre>    base64 <span class="token operator">=</span> fr<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="30"></td><td><pre>fr<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="31"></td><td><pre>f1<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="32"></td><td><pre>f2<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr></table></figure><figure class="highlight html"><figcaption data-lang="HTML"></figcaption><table><tr><td data-num="1"></td><td><pre>#output1</pre></td></tr><tr><td data-num="2"></td><td><pre>785095419718268286866508214304816985447077293766819398728046411166917810820484759314291028976498223661229395009474063173705162627037610993539617751905443039278227583504604808251931083818909467613277587874545761074364427549966555519371913859875313577282243053150056274667798049694695703660313532933165449312949725581708965417273055582216295994587600975970124811496270080896977076946000102701030260990598181466447208054713391526313700681341093922240317428173599031624125155188216489476825606191521182034969120343287691181300399683515414809262700457525876691808180257730351707673660380698973884642306898810000633684878715402823143549139850732982897459698089649561190746850698130299458080255582312696873149210028240898137822888492559957665067936573356367589784593119016624072433872744537432005911668494455733330689385141214653091888017782049043434862620306783436169856564175929871100669913438980899219579329897753233450934770193915434791427728636586218049874617231705308003720066269312729135764175698611068808404054125581540114956463603240222497919384691718744014002554201602395969312999994159599536026359879060218056496345745457493919771337601177449899066579857630036350871090452649830775029695488575574985078428560054253180863725364147</pre></td></tr><tr><td data-num="3"></td><td><pre>1697</pre></td></tr><tr><td data-num="4"></td><td><pre></pre></td></tr><tr><td data-num="5"></td><td><pre>412629526163150748619328091306742267675740578011800062477174189782151273970783531227579758540364970485350157944321579108232221072397135934034064481497887079641131808838242743811511451355024436983050572020925065644355566434625618133203024215941534926113892937988520918939061441606915556516246057349589921494351383160036280826024605351878408056180907759973804117263002554923041750587548819746346813966673034182913325507826219961923932100526305289894965216608254252188398580139545189681875824089456195044984585824938384521905334289906422454152976834867304693292466676355760173232407753256256317546190171995276258924613533179898467683358934751999655196790168438343198229183747091108262988777659858609744709324571850262293294975336628234767258858873839342596887193772615000676401522431518310648303975593582965021189182246986957349253156736526071639973844039068996404290548474640668851856078201093335425412842295604919065487301340901573809617549185106072798799159726375235125260509158832996701927878713084753334549129580912412168594170659605421750204835970231909591063407612779337478065175988365401590396247576709343727196106058477166945670117868989025903023998142850338956985816131805349549059377047477131270847579095628384569645636821650</pre></td></tr><tr><td data-num="6"></td><td><pre>494644347943710545224678831941589086572700792465459558770782213550069709458568349686998660541810166872034041584767487150140111151788221460027897193248273461607411027815984883969396220626358625041781558277804930212654296704055890683796941327712758797770820006623289146990000114915293539639766846910274034245607746230740851938158390562286057002223177609606376329007676845450142537930798148258428701466415483232670659815791064681384406494388237742330786225557303988025468036820082959712050733095860546860468575857084616069132051094882919253745234762029759124776348047587755897123575123506976140900565238840752841856713613368250071926171873213897914794115466890719123299469964019450899291410760762179836946570945555295288184698184555018368687708432612286248476073758067175481771199066581572870175460016017100414479346437034291784837132240891321931601494414908927713208448927221095745802380014441841139882391378410438764884597938773868771896252329517440068673532468372840830510218585255432000690265226016573313570977945083879214961394087065558376158826938257664840570952233832852869328785568175434516247720356520242602299510374317488182738732700078879665745909603766482100138001417023680647717824323143388857817595766172152883484274718248</pre></td></tr><tr><td data-num="7"></td><td><pre>152942283599728307168144137370127212672611894072038732126041098102628831053000986759260271210671922070555948023688596575415822984026159010574404359474670428678518262175033880513984372909748992727828381694416776740981021730545374002974037896534944567124543272737618380646771071804878796585983783360553761828325817820260204820004421979881871027255562690952334900616675606524933557440263648233514757200263521499508373975003431306847453046714027687108396945719803444444954079308404947126216395526551292104722047878178373207886033071857277857997932255251315982837892164421298202073945919187779856785892717251746704537315003771369737854896595170485152591013676942418134278534037654467840633528916812275267230155352077736583130992587670941654695382287023971261529987384520843829695778029311786431227409189019205818351911572757145556993606643464336196802350204616056286497246016800105003143046120608673496196758720552776772796609670537056331996894322779267635281472481559819839042424017171718303214059720568484939239370144038161541354254182769979771948759413102933987773401644506930205164891773826513161783736386604783484446345744957119469799231796368324927570694496679453313927562345656690240414624431304646248599226046524702364131095964335</pre></td></tr><tr><td data-num="8"></td><td><pre>79717988936247951265489157583697956031893477858854186991051529161879478488281744062318600470906120960002282886511477294555606503083169449335174864424180701080203993329996226566203834693869525797695969610065991941396723959032680019082506816443041598300477625793433080664346470586416385854692124426348587211026568667694805849554780794033764714016521711467557284846737236374990121316809833819996821592832639024026411520407330206281265390130763948165694574512140518775603040182029818771866749548761938870605590174330887949847420877829240131490902432602005681085180807294176837646062568094875766945890382971790015490163385088144673549085079635083262975154206269679142412897438231719704933258660779310737302680265445437771977749959110744959368586293082016067927548564967400845992380076107522755566531760628823374519718763740378295585535591752887339222947397184116326706799921515431185636740825707782742373783475781052674257292910213843986132987466810027275052416774693363446184518901899202502828670309452622347532932678874990809930682575738653876289384151496807194146308614368821006660626870989784697045160231069428458961107751207771093777394616856305293335603892178327520756554333365975114235981173451368131680404850832773147333013716920</pre></td></tr><tr><td data-num="9"></td><td><pre>123111353650401158556639983459870663057297871992927053886971224773529636525110628183715748795987525113177540092814119928708272290370336537110381023134637759740716140969662183269370676630325583385284994943164692397459103195434968057377474610500216801375394703781249039351368816958227409657934091741509357152328382960684515093945552479461382281913961956745154260686029997827565075768703774895750561575155143606297116391666385705899138085693913246313778033627210312268959737394553510894720099165193981333775907531107232556909478156441457899797515694348816961762796703443502856101079430585547997496001098926600499728389113862894833789669213630332988693669889340482430613291490613803204484751470676686041002772556117213612152322606737150858116122936539131795111263513114569794532805886643087299918196635113037777138666914296986040549274559835214505300618256105508764026461518876579387159881983544667258537064954616097750399839661065797883103731694314852301848272092388637114950059216922969842082648527035538090054093890365647676119748995243416337805666557501345234056968476142608491830438065401219751688687373709390057521910942736632126729711606256158399963682990881473178216060827021373776598901281958527655543318413664277921492723185984</pre></td></tr><tr><td data-num="10"></td><td><pre>36869806815936046911848195817405817350259890871483063184373728397968909458432625046025376290214729914038387534731762237978339011724858818860181178811639468996206294711495853807311240013786226884265118119546377272154555615363105236192878292703331473547623021744317034819416624562896226194523639793573028006666236271812390759036235867495803255905843636447252225413871038762657801345647584493917576263471587347202664391908570140389126903204602391093990827188675090199750617303773574821926387194478875191828814971296674530519321530805302667925998711835019806761133078403281404889374663875077339168901297819436499920958268483684335998301056068380228873524800383911402490807139268964095165069610454677558808756444381542173782815227920906224931028457073652453777424387873533280455944646592996920617956675786286711447540353883400282402551158169958389450168079568459656526911857835375748015814860506707921852997096156275804955989964215077733621769938075413007804223217091604613132253046399456747595300404564172224333936405545921819654435437072133387523533568472443532200069133022979195685683508297337961701169394794966256415112246587706103819620428258245999539040721929317130088874161577093962579487428358736401687123174207198251449851429295</pre></td></tr><tr><td data-num="11"></td><td><pre></pre></td></tr><tr><td data-num="12"></td><td><pre></pre></td></tr><tr><td data-num="13"></td><td><pre>#output2</pre></td></tr><tr><td data-num="14"></td><td><pre></pre></td></tr><tr><td data-num="15"></td><td><pre>785095419718268286866508214304816985447077293766819398728046411166917810820484759314291028976498223661229395009474063173705162627037610993539617751905443039278227583504604808251931083818909467613277587874545761074364427549966555519371913859875313577282243053150056274667798049694695703660313532933165449312949725581708965417273055582216295994587600975970124811496270080896977076946000102701030260990598181466447208054713391526313700681341093922240317428173599031624125155188216489476825606191521182034969120343287691181300399683515414809262700457525876691808180257730351707673660380698973884642306898810000633684878715402823143549139850732982897459698089649561190746850698130299458080255582312696873149210028240898137822888492559957665067936573356367589784593119016624072433872744537432005911668494455733330689385141214653091888017782049043434862620306783436169856564175929871100669913438980899219579329897753233450934770193915434791427728636586218049874617231705308003720066269312729135764175698611068808404054125581540114956463603240222497919384691718744014002554201602395969312999994159599536026359879060218056496345745457493919771337601177449899066579857630036350871090452649830775029695488575574985078428560054253180863725364147</pre></td></tr><tr><td data-num="16"></td><td><pre>599</pre></td></tr><tr><td data-num="17"></td><td><pre></pre></td></tr><tr><td data-num="18"></td><td><pre>592169079372093727306100216011395857825646323934289480976073629037543922902098120901138454462177159996376654176248238979132528728327590301098966139983157980612320563496546128644967731000716697705104079039156276714872147463350811303393260622707024952543509891692246246277965823414460326811240048060543656588688604452353899779068825120910282167004715339763187734797180326976132213325054697165320479166356562518029805927741656605174809726397565772271562066078076105491745903986597877400370206718954975288721072048333678609055008135809089304229015364348490924974097403734627265297637171818849461766523691595241613878709865506436588268999163342945070495338153600520537498539457396582804692959296612715752573140296135784933206146091436617979599749774330699946637591406356289409716084034451049094715202196203486088368791744107629271647320273259836915312794297246589501008666299165717722507702866033454215783240025504356157664454861755286285777763585177751796252655008206383024707883077513745863312079349790275094080707502392866946325796914450602264462588722052297430827681750827349094323968337670311272933785838850649376115667223821665435911506351891489985627506615492005617098615432522564204152887767244129985681083657783356557756654335186</pre></td></tr><tr><td data-num="19"></td><td><pre>373940646416832740878733255707567753033716583448402000789202767511920210382830343955553654111486728333980557319799362514960627879016797491389812007768832730979916230647641872759001906846747977631675704310179448857128160385701185892914523053669366534408863734305635222625590986006420486092550427301086984563126480814987024980594613542978310129247678826691418335300577577527951623696426435497835228167084738007750914270251001921329521479047662848650808989996085600197309361410863238526802127877523767262921515150984998560136647154865791163316503073285223966216441025637452229043510097323724381056976302288136843260163922706692913035222445496716008888946581535004546355744211680390731257309941902587303353139951102244865270295414474488798335404630458489706639805186573874814586736746232358849677477533671968344154242963289415569487579895910660999043578737461300406937828924818002658292769882181668784501439254131996848948120781562158861495883827848139425862249576454689133681009549361314460818658995959098228995702202268649635363105549975932395335076521137604288520082040121286614922986554652700056148966514178935952363036963217619879899671383604638416567950421350546204434902113156720006282720889591288850271076074941927715678306057176</pre></td></tr><tr><td data-num="20"></td><td><pre>527630926460622936571385649841758214453416849039412401087443444317101857090904711485538107058823056085840539073345920792871368232355475394571098380596835468509997340505604333730547799560998822989747473780307779717715522787724471724766494090783971030594671013168209717686720448579582618378459567979027822271918653169622428153856198907810040224340270362413432495029672123261375400927159831537760709974778708160583252613784358234858583174544777979242887938827573604837766801998381379999076416444683891078093889686055482709838668356120916040352123019019255084513769603803814947774554028717814638951416291274696771515474086351482107953150253616922787262398450376249126999644026382478413080973933173079111305142716133389111399235545279259017424722601848670061556859163943895466553927946412523750166582734005733378328468250568944945912238495877929717101722314678120172228493787964904072583905721074766711732215815561012960394537195757832959268603775112932862105945720853959285187521763557915356428113876893276879775603217718981852114599706699524551973934242045743122744146361596971245034059345915315495232135483464496114770357536576200511490922413208178149869347802988786513451486411409887164516065062084917556120712465074206435831498113605</pre></td></tr><tr><td data-num="21"></td><td><pre>8786437178698940322877889807009957616777351844979869726962356553244050911283984280960665761649310895230455072977431415102053987735969326553978994853162483051544656873294555116009995592043183070208706258164840540599577072097104139505857517663273929851202628854185356185647194933800084230503413037858893307713037149307477830536758283681093517617820169181420796105338681582230788318108428132051793761014952837330456262272828627355701464740578197966332613127307037255647286823496355917642353327912440019621838870388091824748629637425759125214639885130163183752378908729773517053259212525494555880921052679512582051516604297098204363525081039382358483926727008679327719083138865969291911863630382097160230960738043575559330264018212774424527719153248563876760067931499029384228993253862501939337758514377472011933279273181144830381169849387893799390755052093069179605579485710343655570028592595882436632426527654452895431758715126580164902410286422637215098476316042367916779431052267545769495994723721129943616294879642305545894912914632980455031755879087401575310699765408473606166727137934224515998416625122213056208800095077933103150699272650116151674702438463062734472714004926103668378506804002740045547964716693536349447660850580</pre></td></tr><tr><td data-num="22"></td><td><pre>205314962204511500352858372254132533167549960825498949618514841570703199264867431580754674275990554478140637041427842111391746883257447120035947621456863890934062044010795443059281736346976175772415034838334682726635263432655537852942177334888025283748611576171534251461847349566505628290587224150869640386437623371249743165260396675220683302142805646368906930575140628610003919131999295855501215111393294818218799982703289304596989070475000081175510085432290264502023736899104746316830742226946395027029820825791831870857382647221322734605026210073093918331247494307555600335550942340526536281372036612138713881098866303169425501998978400008829873080965592009371176208668290074288903681417933657472279670688597862835627506340169978450918788539270346340385928840299573889292189531738082166408734046381423516467694328971385421907314814283489322619386570046183556572383980777277173349209330683424343658179781015072259378576130442222984963071166207642585589822061597282467850868050737957726423713761694231879497037175627546427449730638216214828463003483408928375620315193290871300316930139260521382533279767663839278693750409419493280753368451508802658272220767624766390639285308433607255253282702383762149755935518922075584637512494819</pre></td></tr><tr><td data-num="23"></td><td><pre>271453634732502613378948161256470991260052778799128789839624515809143527363206813219580098196957510291648493698144497567392065251244844074992734669490296293997386198359280316655904691639367482203210051809125904410431506925238374843856343243276508280641059690938930957474434518308646618959004216831130099873532714372402117796666560677624822509159287675432413016478948594640872091688482149004426363946048517480052906306290126242866034249478040406351940088231081456109195799442996799641647167552689564613346415247906852055588498305665928450828756152103096629274760601528737639415361467941349982213641454967962723875032638267311935042334584913897338553953961877439389588793074211502597238465542889335363559052368180212013206172712561221352833891640659020253527584706465205486408990762759230842192028381048563437724528409174790022752557512795782713125166158329880702730769957185428522011430144840232256419113631679343171680631630775266488738173707357123139368825087043785842169049943237537188129367275730984789479909103397937113837824575137021012333461552176687570010445744268373840742899299977372834041925102853718964831225250407279578465008537542659673685686242773379131904890865110699190451534445434533919127658976874721029586168106207</pre></td></tr></table></figure><p>先分析一下 py 文件 e1,e2 通过 get_enc_key 输出到 output，f1,f2 的作用就是写入 N 和 e1,e2.ct1,ct2 通过模运算 pt^e1MODn==ct1 得到<br>拥有相同的模数 N，两个不同的公钥指数 e 和不同的密文 c。这种类型就是共模，且 gcd (e1,e2)==1<br>又叫模不互素。共模攻击时 n 不需要分解，从而也就不需要求私钥 d。<br>此题中 base64 = fr.read (255) 最后运算得到的是一串 base64 但是被分串了。看了 wp 说是 base64 隐写，之前接触过但没有研究一下就潦草而过了。关于 base64 隐写解码的脚本在下面一段，即本题的 payload</p><h3 id="base64隐写"><a class="anchor" href="#base64隐写">#</a> BASE64 隐写</h3><p>base64 包含的字符有<span class="label warning"> A-Za-z0-9+/</span><br>总共有<span class="label warning"> 26+26+10+2=64 个字符</span></p><p><img data-src="https://s3.bmp.ovh/imgs/2022/03/5c09c31b1ba4c32f.png" alt=""></p><p>Base64 要求把每三个 8Bit 的字节转换为四个 6Bit 的字节（3x8 = 4x6 = 24），然后把 6Bit 再添两位高位 0，组成四个 8Bit 的字节，也就是说，转换后的字符串理论上将要比原来的长 1/3。我在这里做三个英文字母然后分解一下</p><p><img data-src="https://s3.bmp.ovh/imgs/2022/03/98a5cd8a11b1a6aa.png" alt=""><br>会发现经过 base 编码后的字符从三位变成了四位；<span class="label primary">3x8 ----&gt; 4x6</span><br>如果给的是四个字符串呢？ 3x8=24 能够被 6 整除但是 4x8=32 不能整除 6 了；这时候我们需要补零</p><p><img data-src="https://s3.bmp.ovh/imgs/2022/03/ab3acf6eebe78522.png" alt=""></p><p>仅仅是补上那四位 0 是不够的，BAsDEQ 总共才 6 位数尚未满足被 4 整除的条件，要知道 'ELD' 生成的 'BAsD' 是四个字母并且刚好满足 24%4=0 的条件，所以我们必须要字符串个数满足 i%4=0 的状况</p><p><img data-src="https://s3.bmp.ovh/imgs/2022/03/6a9ac6fd9acba101.png" alt=""><br>在后面添上两个 '==' 就可以了，解码的时候把等号去掉，转换为对应的二进制码，从左至右，8 位一组；末尾去掉多余的 0</p><p>说完了 base64 的构成，那么究竟什么是 base64 隐写呢？</p><p><img data-src="https://s3.bmp.ovh/imgs/2022/03/4a2aee80ff51e517.png" alt=""></p><p>解码时候绿色部分都会丢弃掉，所以我们无论怎样更改这里面的内容都是不会发生值的变化的，这也是可以发挥隐写的地方 <span class="label warning">但是请注意等号部分的 0 不可以用于隐写，修改其中的值会导致等号的数量发生变化，对后来的解码有质的影响</span></p><p>绿色部分作为字符的最后组成部分丢弃也不影响解码，还原的时候只会用到最后一个字符的前半部分，唯一会变化的就是字符会变化罢了，但是不影响解码结果</p><p><span class="label warning">要隐藏一个字符串我们得做好多行的 base64 才能将他们隐写，一行 base64 只能有 2 个等号</span></p><h4 id="encode"><a class="anchor" href="#encode">#</a> Encode</h4><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">#转载自：https://www.tr0y.wang/2017/06/14/Base64steg/</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">import</span> base64</pre></td></tr><tr><td data-num="3"></td><td><pre>flag <span class="token operator">=</span> <span class="token string">'Tr0y&#123;Base64isF4n&#125;'</span> <span class="token comment">#flag</span></pre></td></tr><tr><td data-num="4"></td><td><pre>bin_str <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token builtin">bin</span><span class="token punctuation">(</span><span class="token builtin">ord</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">'0b'</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">.</span>zfill<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span> <span class="token keyword">for</span> c <span class="token keyword">in</span> flag<span class="token punctuation">]</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="5"></td><td><pre>base64chars <span class="token operator">=</span> <span class="token string">'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/'</span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'0.txt'</span><span class="token punctuation">,</span> <span class="token string">'rb'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f0<span class="token punctuation">,</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'1.txt'</span><span class="token punctuation">,</span> <span class="token string">'wb'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f1<span class="token punctuation">:</span> <span class="token comment">#'0.txt' 是明文，'1.txt' 用于存放隐写后的 base64</span></pre></td></tr><tr><td data-num="7"></td><td><pre>    <span class="token keyword">for</span> line <span class="token keyword">in</span> f0<span class="token punctuation">.</span>readlines<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="8"></td><td><pre>        rowstr <span class="token operator">=</span> base64<span class="token punctuation">.</span>b64encode<span class="token punctuation">(</span>line<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">'\n'</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="9"></td><td><pre>        equalnum <span class="token operator">=</span> rowstr<span class="token punctuation">.</span>count<span class="token punctuation">(</span><span class="token string">'='</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="10"></td><td><pre>        <span class="token keyword">if</span> equalnum <span class="token keyword">and</span> <span class="token builtin">len</span><span class="token punctuation">(</span>bin_str<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="11"></td><td><pre>            offset <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span><span class="token string">'0b'</span><span class="token operator">+</span>bin_str<span class="token punctuation">[</span><span class="token punctuation">:</span>equalnum <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="12"></td><td><pre>            char <span class="token operator">=</span> rowstr<span class="token punctuation">[</span><span class="token builtin">len</span><span class="token punctuation">(</span>rowstr<span class="token punctuation">)</span> <span class="token operator">-</span> equalnum <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="13"></td><td><pre>            rowstr <span class="token operator">=</span> rowstr<span class="token punctuation">.</span>replace<span class="token punctuation">(</span>char<span class="token punctuation">,</span> base64chars<span class="token punctuation">[</span>base64chars<span class="token punctuation">.</span>index<span class="token punctuation">(</span>char<span class="token punctuation">)</span> <span class="token operator">+</span> offset<span class="token punctuation">]</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="14"></td><td><pre>            bin_str <span class="token operator">=</span> bin_str<span class="token punctuation">[</span>equalnum<span class="token operator">*</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="15"></td><td><pre>        f1<span class="token punctuation">.</span>write<span class="token punctuation">(</span>rowstr <span class="token operator">+</span> <span class="token string">'\n'</span><span class="token punctuation">)</span></pre></td></tr></table></figure><h4 id="decode"><a class="anchor" href="#decode">#</a> Decode</h4><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span><span class="token operator">*</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">import</span> base64</pre></td></tr><tr><td data-num="3"></td><td><pre>c <span class="token operator">=</span> <span class="token string">b'VEhJUz==\nRkxBR3==\nSVN=\nSElEREVOLo==\nQ0FO\nWU9V\nRklORM==\nSVT=\nT1VUP4==\nRE8=\nWU9V\nS05PV9==\nQkFTRTY0P5==\nWW91bmdD\nVEhJTku=\nWU9V\nQVJF\nTk9U\nVEhBVE==\nRkFNSUxJQVI=\nV0lUSO==\nQkFTRTY0Lh==\nQmFzZTY0\naXO=\nYW==\nZ3JvdXA=\nb2b=\nc2ltaWxhcn==\nYmluYXJ5LXRvLXRleHR=\nZW5jb2Rpbme=\nc2NoZW1lc0==\ndGhhdD==\ncmVwcmVzZW50\nYmluYXJ5\nZGF0YW==\naW5=\nYW6=\nQVNDSUl=\nc3RyaW5n\nZm9ybWF0\nYnk=\ndHJhbnNsYXRpbmd=\naXS=\naW50b1==\nYT==\ncmFkaXgtNjQ=\ncmVwcmVzZW50YXRpb24u\nVGhl\ndGVybc==\nQmFzZTY0\nb3JpZ2luYXRlc8==\nZnJvbd==\nYY==\nc3BlY2lmaWN=\nTUlNRT==\nY29udGVudI==\ndHJhbnNmZXI=\nZW5jb2Rpbmcu\nVGhl\ncGFydGljdWxhct==\nc2V0\nb2b=\nNjR=\nY2hhcmFjdGVyc5==\nY2hvc2Vu\ndG+=\ncmVwcmVzZW50\ndGhl\nNjQ=\ncGxhY2UtdmFsdWVz\nZm9y\ndGhl\nYmFzZd==\ndmFyaWVz\nYmV0d2Vlbt==\naW1wbGVtZW50YXRpb25zLp==\nVGhl\nZ2VuZXJhbI==\nc3RyYXRlZ3n=\naXO=\ndG9=\nY2hvb3Nl\nNjR=\nY2hhcmFjdGVyc5==\ndGhhdA==\nYXJl\nYm90aN==\nbWVtYmVyc5==\nb2a=\nYS==\nc3Vic2V0\nY29tbW9u\ndG8=\nbW9zdM==\nZW5jb2RpbmdzLA==\nYW5k\nYWxzb8==\ncHJpbnRhYmxlLg==\nVGhpc9==\nY29tYmluYXRpb25=\nbGVhdmVz\ndGhl\nZGF0YW==\ndW5saWtlbHk=\ndG/=\nYmV=\nbW9kaWZpZWS=\naW5=\ndHJhbnNpdE==\ndGhyb3VnaN==\naW5mb3JtYXRpb26=\nc3lzdGVtcyw=\nc3VjaN==\nYXM=\nRS1tYWlsLD==\ndGhhdA==\nd2VyZQ==\ndHJhZGl0aW9uYWxseQ==\nbm90\nOC1iaXQ=\nY2xlYW4uWzFd\nRm9y\nZXhhbXBsZSw=\nTUlNRSdz\nQmFzZTY0\naW1wbGVtZW50YXRpb24=\ndXNlcw==\nQahDWiw=\nYahDeiw=\nYW5k\nMKhDOQ==\nZm9y\ndGhl\nZmlyc3Q=\nNjI=\ndmFsdWVzLg==\nT3RoZXI=\ndmFyaWF0aW9ucw==\nc2hhcmU=\ndGhpcw==\ncHJvcGVydHk=\nYnV0\nZGlmZmVy\naW4=\ndGhl\nc3ltYm9scw==\nY2hvc2Vu\nZm9y\ndGhl\nbGFzdA==\ndHdv\ndmFsdWVzOw==\nYW4=\nZXhhbXBsZQ==\naXM=\nVVRGLTcu'</span></pre></td></tr><tr><td data-num="4"></td><td><pre></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token keyword">def</span> <span class="token function">get_base64_diff_value</span><span class="token punctuation">(</span>s1<span class="token punctuation">,</span> s2<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="6"></td><td><pre>    base64chars <span class="token operator">=</span> <span class="token string">b'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/'</span></pre></td></tr><tr><td data-num="7"></td><td><pre>    res <span class="token operator">=</span> <span class="token number">0</span></pre></td></tr><tr><td data-num="8"></td><td><pre>    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>s2<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="9"></td><td><pre>        <span class="token keyword">if</span> s1<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">!=</span> s2<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="10"></td><td><pre>            <span class="token keyword">return</span> <span class="token builtin">abs</span><span class="token punctuation">(</span>base64chars<span class="token punctuation">.</span>index<span class="token punctuation">(</span>s1<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">-</span> base64chars<span class="token punctuation">.</span>index<span class="token punctuation">(</span>s2<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="11"></td><td><pre>    <span class="token keyword">return</span> res</pre></td></tr><tr><td data-num="12"></td><td><pre></pre></td></tr><tr><td data-num="13"></td><td><pre><span class="token keyword">def</span> <span class="token function">solve_stego</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="14"></td><td><pre>    line<span class="token operator">=</span><span class="token string">b''</span></pre></td></tr><tr><td data-num="15"></td><td><pre>    bin_str<span class="token operator">=</span><span class="token string">''</span></pre></td></tr><tr><td data-num="16"></td><td><pre>    <span class="token keyword">for</span> i <span class="token keyword">in</span> c<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="17"></td><td><pre>        k<span class="token operator">=</span>long_to_bytes<span class="token punctuation">(</span>i<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="18"></td><td><pre>        <span class="token keyword">if</span> k<span class="token operator">==</span><span class="token string">b'\n'</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="19"></td><td><pre>            steg_line <span class="token operator">=</span> line</pre></td></tr><tr><td data-num="20"></td><td><pre>            norm_line <span class="token operator">=</span> base64<span class="token punctuation">.</span>b64encode<span class="token punctuation">(</span>base64<span class="token punctuation">.</span>b64decode<span class="token punctuation">(</span>line<span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="21"></td><td><pre>            diff <span class="token operator">=</span> get_base64_diff_value<span class="token punctuation">(</span>steg_line<span class="token punctuation">,</span> norm_line<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="22"></td><td><pre>            <span class="token comment">#print(diff)</span></pre></td></tr><tr><td data-num="23"></td><td><pre>            pads_num <span class="token operator">=</span> steg_line<span class="token punctuation">.</span>count<span class="token punctuation">(</span><span class="token string">b'='</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="24"></td><td><pre>            <span class="token keyword">if</span> diff<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="25"></td><td><pre>                bin_str <span class="token operator">+=</span> <span class="token builtin">bin</span><span class="token punctuation">(</span>diff<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">.</span>zfill<span class="token punctuation">(</span>pads_num <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="26"></td><td><pre>            <span class="token keyword">else</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="27"></td><td><pre>                bin_str <span class="token operator">+=</span> <span class="token string">'0'</span> <span class="token operator">*</span> pads_num <span class="token operator">*</span> <span class="token number">2</span></pre></td></tr><tr><td data-num="28"></td><td><pre>            <span class="token keyword">print</span><span class="token punctuation">(</span>goflag<span class="token punctuation">(</span>bin_str<span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="29"></td><td><pre>            line<span class="token operator">=</span><span class="token string">b''</span></pre></td></tr><tr><td data-num="30"></td><td><pre>            <span class="token keyword">continue</span></pre></td></tr><tr><td data-num="31"></td><td><pre>        line<span class="token operator">+=</span>k</pre></td></tr><tr><td data-num="32"></td><td><pre></pre></td></tr><tr><td data-num="33"></td><td><pre><span class="token keyword">def</span> <span class="token function">goflag</span><span class="token punctuation">(</span>bin_str<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="34"></td><td><pre>    res_str <span class="token operator">=</span> <span class="token string">''</span></pre></td></tr><tr><td data-num="35"></td><td><pre>    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>bin_str<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="36"></td><td><pre>        res_str <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span>bin_str<span class="token punctuation">[</span>i<span class="token punctuation">:</span>i <span class="token operator">+</span> <span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="37"></td><td><pre>    <span class="token keyword">return</span> res_str</pre></td></tr><tr><td data-num="38"></td><td><pre></pre></td></tr><tr><td data-num="39"></td><td><pre></pre></td></tr><tr><td data-num="40"></td><td><pre><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="41"></td><td><pre>    solve_stego<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr></table></figure><h2 id="低解密指数攻击"><a class="anchor" href="#低解密指数攻击">#</a> 低解密指数攻击</h2><p>当 e 过大时会显得 d 特别小 Wiener’s Attack 算法从 e 中快速推断出 d 的值。 网上关于维纳攻击的介绍实在太少了，要么就是天文数字看着脑壳都痛，关于这段以后在补上吧。</p><p>这是寒假 hgame 的一道 week3 的密码题</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> getPrime</pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">from</span> gmpy2 <span class="token keyword">import</span> invert</pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">from</span> libnum <span class="token keyword">import</span> s2n</pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">from</span> secret <span class="token keyword">import</span> flag</pre></td></tr><tr><td data-num="5"></td><td><pre></pre></td></tr><tr><td data-num="6"></td><td><pre>p <span class="token operator">=</span> getPrime<span class="token punctuation">(</span><span class="token number">2048</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="7"></td><td><pre>q <span class="token operator">=</span> getPrime<span class="token punctuation">(</span><span class="token number">2048</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="8"></td><td><pre>n <span class="token operator">=</span> p <span class="token operator">*</span> q</pre></td></tr><tr><td data-num="9"></td><td><pre>d <span class="token operator">=</span> getPrime<span class="token punctuation">(</span><span class="token number">64</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="10"></td><td><pre>e <span class="token operator">=</span> invert<span class="token punctuation">(</span>d<span class="token punctuation">,</span> <span class="token punctuation">(</span>p <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>q <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="11"></td><td><pre>c <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>s2n<span class="token punctuation">(</span>flag<span class="token punctuation">)</span><span class="token punctuation">,</span> e<span class="token punctuation">,</span> n<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="12"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"n = </span><span class="token interpolation"><span class="token punctuation">&#123;</span>n<span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="13"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"e = </span><span class="token interpolation"><span class="token punctuation">&#123;</span>e<span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="14"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"c = </span><span class="token interpolation"><span class="token punctuation">&#123;</span>c<span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="15"></td><td><pre></pre></td></tr><tr><td data-num="16"></td><td><pre><span class="token comment">#n = 507419170088344932990702256911694788408493968749527614421614568612944144764889717229444020813658893362983714454159980719026366361318789415279417172858536381938870379267670180128174798344744371725609827872339512302232610590888649555446972990419313445687852636305518801236132032618350847705234643521557851434711389664130274468354405273873218264222293858509477860634889001898462547712800153111774564939279190835857445378261920532206352364005840238252284065587291779196975457288580812526597185332036342330147250312262816994625317482869849388424397437470502449815132000588425028055964432298176942124697105509057090546600330760364385753313923003549670107599757996810939165300581847068233156887269181096893089415302163770884312255957584660964506028002922164767453287973102961910781312351686488047510932997937700597992705557881172640175117476017503918294534205898046483981707558521558992058512940087192655700351675718815723840568640509355338482631416345193176708501897458649841539192993142790402734898948352382350766125000186026261167277014748183012844440603384989647664190074853086693408529737767147592432979469020671772152652865219092597717869942730499507426269170189547020660681363276871874469322437194397171763927907099922324375991793759</span></pre></td></tr><tr><td data-num="17"></td><td><pre><span class="token comment">#e = 77310199867448677782081572109343472783781135641712597643597122591443011229091533516758925238949755491395489408922437493670252550920826641442189683907973926843505436730014899918587477913032286153545247063493885982941194996251799882984145155733050069564485120660716110828110738784644223519725613280140006783618393995138076030616463398284819550627612102010214315235269945251741407899692274978642663650687157736417831290404871181902463904311095448368498432147292938825418930527188720696497596867575843476810225152659244529481480993843168383016583068747733118703000287423374094051895724494193455175131120243097065270804457787026492578916584536863548445813916819417857064037664101684455000184987531252344582899589746272173970083733130106407810619258077266603898529285634495710846838011858287024329514491058790557305041389614650730267774482954666726949886313386881066593946789460028399523245777171320319444673551268379126203862576627540177888290265714418064334752499940587750374552330008143708562065940245637685833371348603338834447212248648869514585047871442060412622164276894766238383894693759347590977926306581080390685360615407766600573527565016914830132066428454738135380178959590692145577418811677639050929791996313180297924833690095</span></pre></td></tr><tr><td data-num="18"></td><td><pre><span class="token comment">#c = 165251729917394529793163344300848992394021337429474789711805041655116845722480301677817165053253655027459227404782607373107477419083333844871948673626672704233977397989843349633720167495862807995411682262559392496273163155214888276398332204954185252030616473235814999366132031184631541209554169938146205402400412307638567132128690379079483633171535375278689326189057930259534983374296873110199636558962144635514392282351103900375366360933088605794654279480277782805401749872568584335215630740265944133347038070337891035560658434763924576508969938866566235926587685108811154229747423410476421860059769485356567301897413767088823807510568561254627099309752215808220067495561412081320541540679503218232020279947159175547517811501280846596226165148013762293861131544331444165070186672186027410082671602892508739473724143698396105392623164025712124329254933353509384748403154342322725203183050328143736631333990445537119855865348221215277608372952942702104088940952142851523651639574409075484106857403651453121036577767672430612728022444370874223001778580387635197325043524719396707713385963432915855227152371800527536048555551237729690663544828830627192867570345853910196397851763591543484023134551876591248557980182981967782409054277224</span></pre></td></tr></table></figure><p>payload</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">import</span> ContinuedFractions<span class="token punctuation">,</span> Arithmetic<span class="token punctuation">,</span> RSAvulnerableKeyGenerator</pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> long_to_bytes</pre></td></tr><tr><td data-num="3"></td><td><pre></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">def</span> <span class="token function">hack_RSA</span><span class="token punctuation">(</span>e<span class="token punctuation">,</span>n<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="5"></td><td><pre>    <span class="token triple-quoted-string string">'''</span></pre></td></tr><tr><td data-num="6"></td><td><pre>    Finds d knowing (e,n)</pre></td></tr><tr><td data-num="7"></td><td><pre>    applying the Wiener continued fraction attack</pre></td></tr><tr><td data-num="8"></td><td><pre>    '''</pre></td></tr><tr><td data-num="9"></td><td><pre>    frac <span class="token operator">=</span> ContinuedFractions<span class="token punctuation">.</span>rational_to_contfrac<span class="token punctuation">(</span>e<span class="token punctuation">,</span> n<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="10"></td><td><pre>    convergents <span class="token operator">=</span> ContinuedFractions<span class="token punctuation">.</span>convergents_from_contfrac<span class="token punctuation">(</span>frac<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="11"></td><td><pre>    </pre></td></tr><tr><td data-num="12"></td><td><pre>    <span class="token keyword">for</span> <span class="token punctuation">(</span>k<span class="token punctuation">,</span>d<span class="token punctuation">)</span> <span class="token keyword">in</span> convergents<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="13"></td><td><pre>        </pre></td></tr><tr><td data-num="14"></td><td><pre>        <span class="token comment">#check if d is actually the key</span></pre></td></tr><tr><td data-num="15"></td><td><pre>        <span class="token keyword">if</span> k<span class="token operator">!=</span><span class="token number">0</span> <span class="token keyword">and</span> <span class="token punctuation">(</span>e<span class="token operator">*</span>d<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">%</span>k <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="16"></td><td><pre>            phi <span class="token operator">=</span> <span class="token punctuation">(</span>e<span class="token operator">*</span>d<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">//</span>k</pre></td></tr><tr><td data-num="17"></td><td><pre>            s <span class="token operator">=</span> n <span class="token operator">-</span> phi <span class="token operator">+</span> <span class="token number">1</span></pre></td></tr><tr><td data-num="18"></td><td><pre>            <span class="token comment"># check if the equation x^2 - s*x + n = 0</span></pre></td></tr><tr><td data-num="19"></td><td><pre>            <span class="token comment"># has integer roots</span></pre></td></tr><tr><td data-num="20"></td><td><pre>            discr <span class="token operator">=</span> s<span class="token operator">*</span>s <span class="token operator">-</span> <span class="token number">4</span><span class="token operator">*</span>n</pre></td></tr><tr><td data-num="21"></td><td><pre>            <span class="token keyword">if</span><span class="token punctuation">(</span>discr<span class="token operator">>=</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="22"></td><td><pre>                t <span class="token operator">=</span> Arithmetic<span class="token punctuation">.</span>is_perfect_square<span class="token punctuation">(</span>discr<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="23"></td><td><pre>                <span class="token keyword">if</span> t<span class="token operator">!=</span><span class="token operator">-</span><span class="token number">1</span> <span class="token keyword">and</span> <span class="token punctuation">(</span>s<span class="token operator">+</span>t<span class="token punctuation">)</span><span class="token operator">%</span><span class="token number">2</span><span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="24"></td><td><pre>                    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Hacked!"</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="25"></td><td><pre>                    <span class="token keyword">return</span> d</pre></td></tr><tr><td data-num="26"></td><td><pre><span class="token keyword">def</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="27"></td><td><pre>    n <span class="token operator">=</span> <span class="token number">507419170088344932990702256911694788408493968749527614421614568612944144764889717229444020813658893362983714454159980719026366361318789415279417172858536381938870379267670180128174798344744371725609827872339512302232610590888649555446972990419313445687852636305518801236132032618350847705234643521557851434711389664130274468354405273873218264222293858509477860634889001898462547712800153111774564939279190835857445378261920532206352364005840238252284065587291779196975457288580812526597185332036342330147250312262816994625317482869849388424397437470502449815132000588425028055964432298176942124697105509057090546600330760364385753313923003549670107599757996810939165300581847068233156887269181096893089415302163770884312255957584660964506028002922164767453287973102961910781312351686488047510932997937700597992705557881172640175117476017503918294534205898046483981707558521558992058512940087192655700351675718815723840568640509355338482631416345193176708501897458649841539192993142790402734898948352382350766125000186026261167277014748183012844440603384989647664190074853086693408529737767147592432979469020671772152652865219092597717869942730499507426269170189547020660681363276871874469322437194397171763927907099922324375991793759</span></pre></td></tr><tr><td data-num="28"></td><td><pre>    e <span class="token operator">=</span> <span class="token number">77310199867448677782081572109343472783781135641712597643597122591443011229091533516758925238949755491395489408922437493670252550920826641442189683907973926843505436730014899918587477913032286153545247063493885982941194996251799882984145155733050069564485120660716110828110738784644223519725613280140006783618393995138076030616463398284819550627612102010214315235269945251741407899692274978642663650687157736417831290404871181902463904311095448368498432147292938825418930527188720696497596867575843476810225152659244529481480993843168383016583068747733118703000287423374094051895724494193455175131120243097065270804457787026492578916584536863548445813916819417857064037664101684455000184987531252344582899589746272173970083733130106407810619258077266603898529285634495710846838011858287024329514491058790557305041389614650730267774482954666726949886313386881066593946789460028399523245777171320319444673551268379126203862576627540177888290265714418064334752499940587750374552330008143708562065940245637685833371348603338834447212248648869514585047871442060412622164276894766238383894693759347590977926306581080390685360615407766600573527565016914830132066428454738135380178959590692145577418811677639050929791996313180297924833690095</span></pre></td></tr><tr><td data-num="29"></td><td><pre>    d<span class="token operator">=</span>hack_RSA<span class="token punctuation">(</span>e<span class="token punctuation">,</span>n<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="30"></td><td><pre>    c <span class="token operator">=</span> <span class="token number">165251729917394529793163344300848992394021337429474789711805041655116845722480301677817165053253655027459227404782607373107477419083333844871948673626672704233977397989843349633720167495862807995411682262559392496273163155214888276398332204954185252030616473235814999366132031184631541209554169938146205402400412307638567132128690379079483633171535375278689326189057930259534983374296873110199636558962144635514392282351103900375366360933088605794654279480277782805401749872568584335215630740265944133347038070337891035560658434763924576508969938866566235926587685108811154229747423410476421860059769485356567301897413767088823807510568561254627099309752215808220067495561412081320541540679503218232020279947159175547517811501280846596226165148013762293861131544331444165070186672186027410082671602892508739473724143698396105392623164025712124329254933353509384748403154342322725203183050328143736631333990445537119855865348221215277608372952942702104088940952142851523651639574409075484106857403651453121036577767672430612728022444370874223001778580387635197325043524719396707713385963432915855227152371800527536048555551237729690663544828830627192867570345853910196397851763591543484023134551876591248557980182981967782409054277224</span></pre></td></tr><tr><td data-num="31"></td><td><pre>    r<span class="token operator">=</span><span class="token builtin">pow</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span>d<span class="token punctuation">,</span>n<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="32"></td><td><pre>    flag<span class="token operator">=</span>long_to_bytes<span class="token punctuation">(</span>r<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="33"></td><td><pre>    <span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="34"></td><td><pre>main<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr></table></figure><h3 id="小明文攻击"><a class="anchor" href="#小明文攻击">#</a> 小明文攻击</h3><p>在此补充一下小明文攻击，很容易被忽视的一种情况；</p><p>首先通过 RSA 最最基本的两个通式来说，当 n 过于大时我们是不是可以把 n 当作无穷大，也可以是看作 0</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>c</mi><mo>=</mo><msup><mi>m</mi><mi>e</mi></msup><mi>m</mi><mi>o</mi><mi>d</mi><mi>n</mi><mspace linebreak="newline"></mspace><mi>m</mi><mo>=</mo><msup><mi>c</mi><mi>d</mi></msup><mi>m</mi><mi>o</mi><mi>d</mi><mi>n</mi></mrow><annotation encoding="application/x-tex">c=m^e mod n\\m=c^dmodn</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.43056em;vertical-align:0"></span><span class="mord mathnormal">c</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.7143919999999999em;vertical-align:0"></span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.7143919999999999em"><span style="top:-3.113em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">e</span></span></span></span></span></span></span></span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mord mathnormal">n</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:.43056em;vertical-align:0"></span><span class="mord mathnormal">m</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.8991079999999999em;vertical-align:0"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8991079999999999em"><span style="top:-3.113em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">d</span></span></span></span></span></span></span></span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mord mathnormal">n</span></span></span></span></span></p><p>此时就变成了</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>c</mi><mo>=</mo><msup><mi>m</mi><mi>e</mi></msup></mrow><annotation encoding="application/x-tex">c=m^e</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.43056em;vertical-align:0"></span><span class="mord mathnormal">c</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.7143919999999999em;vertical-align:0"></span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.7143919999999999em"><span style="top:-3.113em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">e</span></span></span></span></span></span></span></span></span></span></span></span></p><p>这就好办啦，直接开根就好了！</p><h2 id="boneh_durfees-attack"><a class="anchor" href="#boneh_durfees-attack">#</a> Boneh_Durfee's Attack</h2><p>当维纳攻击解决不了大 e 问题时，就该考虑是不是 Boneh_Durfee's Attack 了。</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">#!/usr/bin/env python3</span></pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> getPrime<span class="token punctuation">,</span> bytes_to_long<span class="token punctuation">,</span> inverse</pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">from</span> random <span class="token keyword">import</span> getrandbits</pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token keyword">from</span> math <span class="token keyword">import</span> gcd</pre></td></tr><tr><td data-num="6"></td><td><pre></pre></td></tr><tr><td data-num="7"></td><td><pre>FLAG <span class="token operator">=</span> <span class="token string">b"crypto&#123;?????????????????????????????????????&#125;"</span></pre></td></tr><tr><td data-num="8"></td><td><pre></pre></td></tr><tr><td data-num="9"></td><td><pre>m <span class="token operator">=</span> bytes_to_long<span class="token punctuation">(</span>FLAG<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="10"></td><td><pre></pre></td></tr><tr><td data-num="11"></td><td><pre><span class="token keyword">def</span> <span class="token function">get_huge_RSA</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="12"></td><td><pre>    p <span class="token operator">=</span> getPrime<span class="token punctuation">(</span><span class="token number">1024</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="13"></td><td><pre>    q <span class="token operator">=</span> getPrime<span class="token punctuation">(</span><span class="token number">1024</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="14"></td><td><pre>    N <span class="token operator">=</span> p<span class="token operator">*</span>q</pre></td></tr><tr><td data-num="15"></td><td><pre>    phi <span class="token operator">=</span> <span class="token punctuation">(</span>p<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>q<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="16"></td><td><pre>    <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="17"></td><td><pre>        e <span class="token operator">=</span> getrandbits<span class="token punctuation">(</span><span class="token number">2046</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="18"></td><td><pre>        <span class="token keyword">if</span> gcd<span class="token punctuation">(</span>e<span class="token punctuation">,</span>phi<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="19"></td><td><pre>            d <span class="token operator">=</span> inverse<span class="token punctuation">(</span>e<span class="token punctuation">,</span> phi<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="20"></td><td><pre>            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token number">3</span><span class="token operator">*</span>d<span class="token punctuation">)</span><span class="token operator">**</span><span class="token number">4</span> <span class="token operator">></span> N<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="21"></td><td><pre>                <span class="token keyword">break</span></pre></td></tr><tr><td data-num="22"></td><td><pre>    <span class="token keyword">return</span> N<span class="token punctuation">,</span>e</pre></td></tr><tr><td data-num="23"></td><td><pre></pre></td></tr><tr><td data-num="24"></td><td><pre></pre></td></tr><tr><td data-num="25"></td><td><pre>N<span class="token punctuation">,</span> e <span class="token operator">=</span> get_huge_RSA<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="26"></td><td><pre>c <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>m<span class="token punctuation">,</span> e<span class="token punctuation">,</span> N<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="27"></td><td><pre></pre></td></tr><tr><td data-num="28"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'N = </span><span class="token interpolation"><span class="token punctuation">&#123;</span><span class="token builtin">hex</span><span class="token punctuation">(</span>N<span class="token punctuation">)</span><span class="token punctuation">&#125;</span></span><span class="token string">'</span></span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="29"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'e = </span><span class="token interpolation"><span class="token punctuation">&#123;</span><span class="token builtin">hex</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">&#125;</span></span><span class="token string">'</span></span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="30"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'c = </span><span class="token interpolation"><span class="token punctuation">&#123;</span><span class="token builtin">hex</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">&#125;</span></span><span class="token string">'</span></span><span class="token punctuation">)</span></pre></td></tr></table></figure><p>output:</p><figure class="highlight html"><figcaption data-lang="HTML"></figcaption><table><tr><td data-num="1"></td><td><pre>N = 0x665166804cd78e8197073f65f58bca14e019982245fcc7cad74535e948a4e0258b2e919bf3720968a00e5240c5e1d6b8831d8fec300d969fccec6cce11dde826d3fbe0837194f2dc64194c78379440671563c6c75267f0286d779e6d91d3e9037c642a860a894d8c45b7ed564d341501cedf260d3019234f2964ccc6c56b6de8a4f66667e9672a03f6c29d95100cdf5cb363d66f2131823a953621680300ab3a2eb51c12999b6d4249dde499055584925399f3a8c7a4a5a21f095878e80bbc772f785d2cbf70a87c6b854eb566e1e1beb7d4ac6eb46023b3dc7fdf34529a40f5fc5797f9c15c54ed4cb018c072168e9c30ca3602e00ea4047d2e5686c6eb37b9</pre></td></tr><tr><td data-num="2"></td><td><pre>e = 0x2c998e57bc651fe4807443dbb3e794711ca22b473d7792a64b7a326538dc528a17c79c72e425bf29937e47b2d6f6330ee5c13bfd8564b50e49132d47befd0ee2e85f4bfe2c9452d62ef838d487c099b3d7c80f14e362b3d97ca4774f1e4e851d38a4a834b077ded3d40cd20ddc45d57581beaa7b4d299da9dec8a1f361c808637238fa368e07c7d08f5654c7b2f8a90d47857e9b9c0a81a46769f6307d5a4442707afb017959d9a681fa1dc8d97565e55f02df34b04a3d0a0bf98b7798d7084db4b3f6696fa139f83ada3dc70d0b4c57bf49f530dec938096071f9c4498fdef9641dfbfe516c985b27d1748cc6ce1a4beb1381fb165a3d14f61032e0f76f095d</pre></td></tr><tr><td data-num="3"></td><td><pre>c = 0x503d5dd3bf3d76918b868c0789c81b4a384184ddadef81142eabdcb78656632e54c9cb22ac2c41178607aa41adebdf89cd24ec1876365994f54f2b8fc492636b59382eb5094c46b5818cf8d9b42aed7e8051d7ca1537202d20ef945876e94f502e048ad71c7ad89200341f8071dc73c2cc1c7688494cad0110fca4854ee6a1ba999005a650062a5d55063693e8b018b08c4591946a3fc961dae2ba0c046f0848fbe5206d56767aae8812d55ee9decc1587cf5905887846cd3ecc6fc069e40d36b29ee48229c0c79eceab9a95b11d15421b8585a2576a63b9f09c56a4ca1729680410da237ac5b05850604e2af1f4ede9cf3928cbb3193a159e64482928b585ac</pre></td></tr></table></figure><p>附上 sage</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">from</span> __future__ <span class="token keyword">import</span> print_function</pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">import</span> time</pre></td></tr><tr><td data-num="3"></td><td><pre></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token comment">############################################</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token comment"># Config</span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token comment">##########################################</span></pre></td></tr><tr><td data-num="7"></td><td><pre></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token triple-quoted-string string">"""</span></pre></td></tr><tr><td data-num="9"></td><td><pre>Setting debug to true will display more informations</pre></td></tr><tr><td data-num="10"></td><td><pre>about the lattice, the bounds, the vectors...</pre></td></tr><tr><td data-num="11"></td><td><pre>"""</pre></td></tr><tr><td data-num="12"></td><td><pre>debug <span class="token operator">=</span> <span class="token boolean">True</span></pre></td></tr><tr><td data-num="13"></td><td><pre></pre></td></tr><tr><td data-num="14"></td><td><pre><span class="token triple-quoted-string string">"""</span></pre></td></tr><tr><td data-num="15"></td><td><pre>Setting strict to true will stop the algorithm (and</pre></td></tr><tr><td data-num="16"></td><td><pre>return (-1, -1)) if we don't have a correct</pre></td></tr><tr><td data-num="17"></td><td><pre>upperbound on the determinant. Note that this</pre></td></tr><tr><td data-num="18"></td><td><pre>doesn't necesseraly mean that no solutions</pre></td></tr><tr><td data-num="19"></td><td><pre>will be found since the theoretical upperbound is</pre></td></tr><tr><td data-num="20"></td><td><pre>usualy far away from actual results. That is why</pre></td></tr><tr><td data-num="21"></td><td><pre>you should probably use `strict = False`</pre></td></tr><tr><td data-num="22"></td><td><pre>"""</pre></td></tr><tr><td data-num="23"></td><td><pre>strict <span class="token operator">=</span> <span class="token boolean">False</span></pre></td></tr><tr><td data-num="24"></td><td><pre></pre></td></tr><tr><td data-num="25"></td><td><pre><span class="token triple-quoted-string string">"""</span></pre></td></tr><tr><td data-num="26"></td><td><pre>This is experimental, but has provided remarkable results</pre></td></tr><tr><td data-num="27"></td><td><pre>so far. It tries to reduce the lattice as much as it can</pre></td></tr><tr><td data-num="28"></td><td><pre>while keeping its efficiency. I see no reason not to use</pre></td></tr><tr><td data-num="29"></td><td><pre>this option, but if things don't work, you should try</pre></td></tr><tr><td data-num="30"></td><td><pre>disabling it</pre></td></tr><tr><td data-num="31"></td><td><pre>"""</pre></td></tr><tr><td data-num="32"></td><td><pre>helpful_only <span class="token operator">=</span> <span class="token boolean">True</span></pre></td></tr><tr><td data-num="33"></td><td><pre>dimension_min <span class="token operator">=</span> <span class="token number">7</span> <span class="token comment"># stop removing if lattice reaches that dimension</span></pre></td></tr><tr><td data-num="34"></td><td><pre></pre></td></tr><tr><td data-num="35"></td><td><pre><span class="token comment">############################################</span></pre></td></tr><tr><td data-num="36"></td><td><pre><span class="token comment"># Functions</span></pre></td></tr><tr><td data-num="37"></td><td><pre><span class="token comment">##########################################</span></pre></td></tr><tr><td data-num="38"></td><td><pre></pre></td></tr><tr><td data-num="39"></td><td><pre><span class="token comment"># display stats on helpful vectors</span></pre></td></tr><tr><td data-num="40"></td><td><pre><span class="token keyword">def</span> <span class="token function">helpful_vectors</span><span class="token punctuation">(</span>BB<span class="token punctuation">,</span> modulus<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="41"></td><td><pre>    nothelpful <span class="token operator">=</span> <span class="token number">0</span></pre></td></tr><tr><td data-num="42"></td><td><pre>    <span class="token keyword">for</span> ii <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>BB<span class="token punctuation">.</span>dimensions<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="43"></td><td><pre>        <span class="token keyword">if</span> BB<span class="token punctuation">[</span>ii<span class="token punctuation">,</span>ii<span class="token punctuation">]</span> <span class="token operator">>=</span> modulus<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="44"></td><td><pre>            nothelpful <span class="token operator">+=</span> <span class="token number">1</span></pre></td></tr><tr><td data-num="45"></td><td><pre></pre></td></tr><tr><td data-num="46"></td><td><pre>    <span class="token keyword">print</span><span class="token punctuation">(</span>nothelpful<span class="token punctuation">,</span> <span class="token string">"/"</span><span class="token punctuation">,</span> BB<span class="token punctuation">.</span>dimensions<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">" vectors are not helpful"</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="47"></td><td><pre></pre></td></tr><tr><td data-num="48"></td><td><pre><span class="token comment"># display matrix picture with 0 and X</span></pre></td></tr><tr><td data-num="49"></td><td><pre><span class="token keyword">def</span> <span class="token function">matrix_overview</span><span class="token punctuation">(</span>BB<span class="token punctuation">,</span> bound<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="50"></td><td><pre>    <span class="token keyword">for</span> ii <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>BB<span class="token punctuation">.</span>dimensions<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="51"></td><td><pre>        a <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token string">'%02d '</span> <span class="token operator">%</span> ii<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="52"></td><td><pre>        <span class="token keyword">for</span> jj <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>BB<span class="token punctuation">.</span>dimensions<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="53"></td><td><pre>            a <span class="token operator">+=</span> <span class="token string">'0'</span> <span class="token keyword">if</span> BB<span class="token punctuation">[</span>ii<span class="token punctuation">,</span>jj<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">0</span> <span class="token keyword">else</span> <span class="token string">'X'</span></pre></td></tr><tr><td data-num="54"></td><td><pre>            <span class="token keyword">if</span> BB<span class="token punctuation">.</span>dimensions<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">&lt;</span> <span class="token number">60</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="55"></td><td><pre>                a <span class="token operator">+=</span> <span class="token string">' '</span></pre></td></tr><tr><td data-num="56"></td><td><pre>        <span class="token keyword">if</span> BB<span class="token punctuation">[</span>ii<span class="token punctuation">,</span> ii<span class="token punctuation">]</span> <span class="token operator">>=</span> bound<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="57"></td><td><pre>            a <span class="token operator">+=</span> <span class="token string">'~'</span></pre></td></tr><tr><td data-num="58"></td><td><pre>        <span class="token keyword">print</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="59"></td><td><pre></pre></td></tr><tr><td data-num="60"></td><td><pre><span class="token comment"># tries to remove unhelpful vectors</span></pre></td></tr><tr><td data-num="61"></td><td><pre><span class="token comment"># we start at current = n-1 (last vector)</span></pre></td></tr><tr><td data-num="62"></td><td><pre><span class="token keyword">def</span> <span class="token function">remove_unhelpful</span><span class="token punctuation">(</span>BB<span class="token punctuation">,</span> monomials<span class="token punctuation">,</span> bound<span class="token punctuation">,</span> current<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="63"></td><td><pre>    <span class="token comment"># end of our recursive function</span></pre></td></tr><tr><td data-num="64"></td><td><pre>    <span class="token keyword">if</span> current <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span> <span class="token keyword">or</span> BB<span class="token punctuation">.</span>dimensions<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">&lt;=</span> dimension_min<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="65"></td><td><pre>        <span class="token keyword">return</span> BB</pre></td></tr><tr><td data-num="66"></td><td><pre></pre></td></tr><tr><td data-num="67"></td><td><pre>    <span class="token comment"># we start by checking from the end</span></pre></td></tr><tr><td data-num="68"></td><td><pre>    <span class="token keyword">for</span> ii <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>current<span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="69"></td><td><pre>        <span class="token comment"># if it is unhelpful:</span></pre></td></tr><tr><td data-num="70"></td><td><pre>        <span class="token keyword">if</span> BB<span class="token punctuation">[</span>ii<span class="token punctuation">,</span> ii<span class="token punctuation">]</span> <span class="token operator">>=</span> bound<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="71"></td><td><pre>            affected_vectors <span class="token operator">=</span> <span class="token number">0</span></pre></td></tr><tr><td data-num="72"></td><td><pre>            affected_vector_index <span class="token operator">=</span> <span class="token number">0</span></pre></td></tr><tr><td data-num="73"></td><td><pre>            <span class="token comment"># let's check if it affects other vectors</span></pre></td></tr><tr><td data-num="74"></td><td><pre>            <span class="token keyword">for</span> jj <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>ii <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> BB<span class="token punctuation">.</span>dimensions<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="75"></td><td><pre>                <span class="token comment"># if another vector is affected:</span></pre></td></tr><tr><td data-num="76"></td><td><pre>                <span class="token comment"># we increase the count</span></pre></td></tr><tr><td data-num="77"></td><td><pre>                <span class="token keyword">if</span> BB<span class="token punctuation">[</span>jj<span class="token punctuation">,</span> ii<span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="78"></td><td><pre>                    affected_vectors <span class="token operator">+=</span> <span class="token number">1</span></pre></td></tr><tr><td data-num="79"></td><td><pre>                    affected_vector_index <span class="token operator">=</span> jj</pre></td></tr><tr><td data-num="80"></td><td><pre></pre></td></tr><tr><td data-num="81"></td><td><pre>            <span class="token comment"># level:0</span></pre></td></tr><tr><td data-num="82"></td><td><pre>            <span class="token comment"># if no other vectors end up affected</span></pre></td></tr><tr><td data-num="83"></td><td><pre>            <span class="token comment"># we remove it</span></pre></td></tr><tr><td data-num="84"></td><td><pre>            <span class="token keyword">if</span> affected_vectors <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="85"></td><td><pre>                <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"* removing unhelpful vector"</span><span class="token punctuation">,</span> ii<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="86"></td><td><pre>                BB <span class="token operator">=</span> BB<span class="token punctuation">.</span>delete_columns<span class="token punctuation">(</span><span class="token punctuation">[</span>ii<span class="token punctuation">]</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="87"></td><td><pre>                BB <span class="token operator">=</span> BB<span class="token punctuation">.</span>delete_rows<span class="token punctuation">(</span><span class="token punctuation">[</span>ii<span class="token punctuation">]</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="88"></td><td><pre>                monomials<span class="token punctuation">.</span>pop<span class="token punctuation">(</span>ii<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="89"></td><td><pre>                BB <span class="token operator">=</span> remove_unhelpful<span class="token punctuation">(</span>BB<span class="token punctuation">,</span> monomials<span class="token punctuation">,</span> bound<span class="token punctuation">,</span> ii<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="90"></td><td><pre>                <span class="token keyword">return</span> BB</pre></td></tr><tr><td data-num="91"></td><td><pre></pre></td></tr><tr><td data-num="92"></td><td><pre>            <span class="token comment"># level:1</span></pre></td></tr><tr><td data-num="93"></td><td><pre>            <span class="token comment"># if just one was affected we check</span></pre></td></tr><tr><td data-num="94"></td><td><pre>            <span class="token comment"># if it is affecting someone else</span></pre></td></tr><tr><td data-num="95"></td><td><pre>            <span class="token keyword">elif</span> affected_vectors <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="96"></td><td><pre>                affected_deeper <span class="token operator">=</span> <span class="token boolean">True</span></pre></td></tr><tr><td data-num="97"></td><td><pre>                <span class="token keyword">for</span> kk <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>affected_vector_index <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> BB<span class="token punctuation">.</span>dimensions<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="98"></td><td><pre>                    <span class="token comment"># if it is affecting even one vector</span></pre></td></tr><tr><td data-num="99"></td><td><pre>                    <span class="token comment"># we give up on this one</span></pre></td></tr><tr><td data-num="100"></td><td><pre>                    <span class="token keyword">if</span> BB<span class="token punctuation">[</span>kk<span class="token punctuation">,</span> affected_vector_index<span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="101"></td><td><pre>                        affected_deeper <span class="token operator">=</span> <span class="token boolean">False</span></pre></td></tr><tr><td data-num="102"></td><td><pre>                <span class="token comment"># remove both it if no other vector was affected and</span></pre></td></tr><tr><td data-num="103"></td><td><pre>                <span class="token comment"># this helpful vector is not helpful enough</span></pre></td></tr><tr><td data-num="104"></td><td><pre>                <span class="token comment"># compared to our unhelpful one</span></pre></td></tr><tr><td data-num="105"></td><td><pre>                <span class="token keyword">if</span> affected_deeper <span class="token keyword">and</span> <span class="token builtin">abs</span><span class="token punctuation">(</span>bound <span class="token operator">-</span> BB<span class="token punctuation">[</span>affected_vector_index<span class="token punctuation">,</span> affected_vector_index<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token builtin">abs</span><span class="token punctuation">(</span>bound <span class="token operator">-</span> BB<span class="token punctuation">[</span>ii<span class="token punctuation">,</span> ii<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="106"></td><td><pre>                    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"* removing unhelpful vectors"</span><span class="token punctuation">,</span> ii<span class="token punctuation">,</span> <span class="token string">"and"</span><span class="token punctuation">,</span> affected_vector_index<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="107"></td><td><pre>                    BB <span class="token operator">=</span> BB<span class="token punctuation">.</span>delete_columns<span class="token punctuation">(</span><span class="token punctuation">[</span>affected_vector_index<span class="token punctuation">,</span> ii<span class="token punctuation">]</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="108"></td><td><pre>                    BB <span class="token operator">=</span> BB<span class="token punctuation">.</span>delete_rows<span class="token punctuation">(</span><span class="token punctuation">[</span>affected_vector_index<span class="token punctuation">,</span> ii<span class="token punctuation">]</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="109"></td><td><pre>                    monomials<span class="token punctuation">.</span>pop<span class="token punctuation">(</span>affected_vector_index<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="110"></td><td><pre>                    monomials<span class="token punctuation">.</span>pop<span class="token punctuation">(</span>ii<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="111"></td><td><pre>                    BB <span class="token operator">=</span> remove_unhelpful<span class="token punctuation">(</span>BB<span class="token punctuation">,</span> monomials<span class="token punctuation">,</span> bound<span class="token punctuation">,</span> ii<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="112"></td><td><pre>                    <span class="token keyword">return</span> BB</pre></td></tr><tr><td data-num="113"></td><td><pre>    <span class="token comment"># nothing happened</span></pre></td></tr><tr><td data-num="114"></td><td><pre>    <span class="token keyword">return</span> BB</pre></td></tr><tr><td data-num="115"></td><td><pre></pre></td></tr><tr><td data-num="116"></td><td><pre><span class="token triple-quoted-string string">""" </span></pre></td></tr><tr><td data-num="117"></td><td><pre>Returns:</pre></td></tr><tr><td data-num="118"></td><td><pre>* 0,0   if it fails</pre></td></tr><tr><td data-num="119"></td><td><pre>* -1,-1 if `strict=true`, and determinant doesn't bound</pre></td></tr><tr><td data-num="120"></td><td><pre>* x0,y0 the solutions of `pol`</pre></td></tr><tr><td data-num="121"></td><td><pre>"""</pre></td></tr><tr><td data-num="122"></td><td><pre><span class="token keyword">def</span> <span class="token function">boneh_durfee</span><span class="token punctuation">(</span>pol<span class="token punctuation">,</span> modulus<span class="token punctuation">,</span> mm<span class="token punctuation">,</span> tt<span class="token punctuation">,</span> XX<span class="token punctuation">,</span> YY<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="123"></td><td><pre>    <span class="token triple-quoted-string string">"""</span></pre></td></tr><tr><td data-num="124"></td><td><pre>    Boneh and Durfee revisited by Herrmann and May</pre></td></tr><tr><td data-num="125"></td><td><pre>    </pre></td></tr><tr><td data-num="126"></td><td><pre>    finds a solution if:</pre></td></tr><tr><td data-num="127"></td><td><pre>    * d &lt; N^delta</pre></td></tr><tr><td data-num="128"></td><td><pre>    * |x| &lt; e^delta</pre></td></tr><tr><td data-num="129"></td><td><pre>    * |y| &lt; e^0.5</pre></td></tr><tr><td data-num="130"></td><td><pre>    whenever delta &lt; 1 - sqrt(2)/2 ~ 0.292</pre></td></tr><tr><td data-num="131"></td><td><pre>    """</pre></td></tr><tr><td data-num="132"></td><td><pre></pre></td></tr><tr><td data-num="133"></td><td><pre>    <span class="token comment"># substitution (Herrman and May)</span></pre></td></tr><tr><td data-num="134"></td><td><pre>    PR<span class="token punctuation">.</span><span class="token operator">&lt;</span>u<span class="token punctuation">,</span> x<span class="token punctuation">,</span> y<span class="token operator">></span> <span class="token operator">=</span> PolynomialRing<span class="token punctuation">(</span>ZZ<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="135"></td><td><pre>    Q <span class="token operator">=</span> PR<span class="token punctuation">.</span>quotient<span class="token punctuation">(</span>x<span class="token operator">*</span>y <span class="token operator">+</span> <span class="token number">1</span> <span class="token operator">-</span> u<span class="token punctuation">)</span> <span class="token comment"># u = xy + 1</span></pre></td></tr><tr><td data-num="136"></td><td><pre>    polZ <span class="token operator">=</span> Q<span class="token punctuation">(</span>pol<span class="token punctuation">)</span><span class="token punctuation">.</span>lift<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="137"></td><td><pre></pre></td></tr><tr><td data-num="138"></td><td><pre>    UU <span class="token operator">=</span> XX<span class="token operator">*</span>YY <span class="token operator">+</span> <span class="token number">1</span></pre></td></tr><tr><td data-num="139"></td><td><pre></pre></td></tr><tr><td data-num="140"></td><td><pre>    <span class="token comment"># x-shifts</span></pre></td></tr><tr><td data-num="141"></td><td><pre>    gg <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="142"></td><td><pre>    <span class="token keyword">for</span> kk <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>mm <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="143"></td><td><pre>        <span class="token keyword">for</span> ii <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>mm <span class="token operator">-</span> kk <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="144"></td><td><pre>            xshift <span class="token operator">=</span> x<span class="token operator">^</span>ii <span class="token operator">*</span> modulus<span class="token operator">^</span><span class="token punctuation">(</span>mm <span class="token operator">-</span> kk<span class="token punctuation">)</span> <span class="token operator">*</span> polZ<span class="token punctuation">(</span>u<span class="token punctuation">,</span> x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token operator">^</span>kk</pre></td></tr><tr><td data-num="145"></td><td><pre>            gg<span class="token punctuation">.</span>append<span class="token punctuation">(</span>xshift<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="146"></td><td><pre>    gg<span class="token punctuation">.</span>sort<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="147"></td><td><pre></pre></td></tr><tr><td data-num="148"></td><td><pre>    <span class="token comment"># x-shifts list of monomials</span></pre></td></tr><tr><td data-num="149"></td><td><pre>    monomials <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="150"></td><td><pre>    <span class="token keyword">for</span> polynomial <span class="token keyword">in</span> gg<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="151"></td><td><pre>        <span class="token keyword">for</span> monomial <span class="token keyword">in</span> polynomial<span class="token punctuation">.</span>monomials<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="152"></td><td><pre>            <span class="token keyword">if</span> monomial <span class="token keyword">not</span> <span class="token keyword">in</span> monomials<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="153"></td><td><pre>                monomials<span class="token punctuation">.</span>append<span class="token punctuation">(</span>monomial<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="154"></td><td><pre>    monomials<span class="token punctuation">.</span>sort<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="155"></td><td><pre>    </pre></td></tr><tr><td data-num="156"></td><td><pre>    <span class="token comment"># y-shifts (selected by Herrman and May)</span></pre></td></tr><tr><td data-num="157"></td><td><pre>    <span class="token keyword">for</span> jj <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> tt <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="158"></td><td><pre>        <span class="token keyword">for</span> kk <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>floor<span class="token punctuation">(</span>mm<span class="token operator">/</span>tt<span class="token punctuation">)</span> <span class="token operator">*</span> jj<span class="token punctuation">,</span> mm <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="159"></td><td><pre>            yshift <span class="token operator">=</span> y<span class="token operator">^</span>jj <span class="token operator">*</span> polZ<span class="token punctuation">(</span>u<span class="token punctuation">,</span> x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token operator">^</span>kk <span class="token operator">*</span> modulus<span class="token operator">^</span><span class="token punctuation">(</span>mm <span class="token operator">-</span> kk<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="160"></td><td><pre>            yshift <span class="token operator">=</span> Q<span class="token punctuation">(</span>yshift<span class="token punctuation">)</span><span class="token punctuation">.</span>lift<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="161"></td><td><pre>            gg<span class="token punctuation">.</span>append<span class="token punctuation">(</span>yshift<span class="token punctuation">)</span> <span class="token comment"># substitution</span></pre></td></tr><tr><td data-num="162"></td><td><pre>    </pre></td></tr><tr><td data-num="163"></td><td><pre>    <span class="token comment"># y-shifts list of monomials</span></pre></td></tr><tr><td data-num="164"></td><td><pre>    <span class="token keyword">for</span> jj <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> tt <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="165"></td><td><pre>        <span class="token keyword">for</span> kk <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>floor<span class="token punctuation">(</span>mm<span class="token operator">/</span>tt<span class="token punctuation">)</span> <span class="token operator">*</span> jj<span class="token punctuation">,</span> mm <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="166"></td><td><pre>            monomials<span class="token punctuation">.</span>append<span class="token punctuation">(</span>u<span class="token operator">^</span>kk <span class="token operator">*</span> y<span class="token operator">^</span>jj<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="167"></td><td><pre></pre></td></tr><tr><td data-num="168"></td><td><pre>    <span class="token comment"># construct lattice B</span></pre></td></tr><tr><td data-num="169"></td><td><pre>    nn <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>monomials<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="170"></td><td><pre>    BB <span class="token operator">=</span> Matrix<span class="token punctuation">(</span>ZZ<span class="token punctuation">,</span> nn<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="171"></td><td><pre>    <span class="token keyword">for</span> ii <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>nn<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="172"></td><td><pre>        BB<span class="token punctuation">[</span>ii<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> gg<span class="token punctuation">[</span>ii<span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="173"></td><td><pre>        <span class="token keyword">for</span> jj <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> ii <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="174"></td><td><pre>            <span class="token keyword">if</span> monomials<span class="token punctuation">[</span>jj<span class="token punctuation">]</span> <span class="token keyword">in</span> gg<span class="token punctuation">[</span>ii<span class="token punctuation">]</span><span class="token punctuation">.</span>monomials<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="175"></td><td><pre>                BB<span class="token punctuation">[</span>ii<span class="token punctuation">,</span> jj<span class="token punctuation">]</span> <span class="token operator">=</span> gg<span class="token punctuation">[</span>ii<span class="token punctuation">]</span><span class="token punctuation">.</span>monomial_coefficient<span class="token punctuation">(</span>monomials<span class="token punctuation">[</span>jj<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">*</span> monomials<span class="token punctuation">[</span>jj<span class="token punctuation">]</span><span class="token punctuation">(</span>UU<span class="token punctuation">,</span>XX<span class="token punctuation">,</span>YY<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="176"></td><td><pre></pre></td></tr><tr><td data-num="177"></td><td><pre>    <span class="token comment"># Prototype to reduce the lattice</span></pre></td></tr><tr><td data-num="178"></td><td><pre>    <span class="token keyword">if</span> helpful_only<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="179"></td><td><pre>        <span class="token comment"># automatically remove</span></pre></td></tr><tr><td data-num="180"></td><td><pre>        BB <span class="token operator">=</span> remove_unhelpful<span class="token punctuation">(</span>BB<span class="token punctuation">,</span> monomials<span class="token punctuation">,</span> modulus<span class="token operator">^</span>mm<span class="token punctuation">,</span> nn<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="181"></td><td><pre>        <span class="token comment"># reset dimension</span></pre></td></tr><tr><td data-num="182"></td><td><pre>        nn <span class="token operator">=</span> BB<span class="token punctuation">.</span>dimensions<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="183"></td><td><pre>        <span class="token keyword">if</span> nn <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="184"></td><td><pre>            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"failure"</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="185"></td><td><pre>            <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span></pre></td></tr><tr><td data-num="186"></td><td><pre></pre></td></tr><tr><td data-num="187"></td><td><pre>    <span class="token comment"># check if vectors are helpful</span></pre></td></tr><tr><td data-num="188"></td><td><pre>    <span class="token keyword">if</span> debug<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="189"></td><td><pre>        helpful_vectors<span class="token punctuation">(</span>BB<span class="token punctuation">,</span> modulus<span class="token operator">^</span>mm<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="190"></td><td><pre>    </pre></td></tr><tr><td data-num="191"></td><td><pre>    <span class="token comment"># check if determinant is correctly bounded</span></pre></td></tr><tr><td data-num="192"></td><td><pre>    det <span class="token operator">=</span> BB<span class="token punctuation">.</span>det<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="193"></td><td><pre>    bound <span class="token operator">=</span> modulus<span class="token operator">^</span><span class="token punctuation">(</span>mm<span class="token operator">*</span>nn<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="194"></td><td><pre>    <span class="token keyword">if</span> det <span class="token operator">>=</span> bound<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="195"></td><td><pre>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"We do not have det &lt; bound. Solutions might not be found."</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="196"></td><td><pre>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Try with highers m and t."</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="197"></td><td><pre>        <span class="token keyword">if</span> debug<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="198"></td><td><pre>            diff <span class="token operator">=</span> <span class="token punctuation">(</span>log<span class="token punctuation">(</span>det<span class="token punctuation">)</span> <span class="token operator">-</span> log<span class="token punctuation">(</span>bound<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">/</span> log<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="199"></td><td><pre>            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"size det(L) - size e^(m*n) = "</span><span class="token punctuation">,</span> floor<span class="token punctuation">(</span>diff<span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="200"></td><td><pre>        <span class="token keyword">if</span> strict<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="201"></td><td><pre>            <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span></pre></td></tr><tr><td data-num="202"></td><td><pre>    <span class="token keyword">else</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="203"></td><td><pre>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"det(L) &lt; e^(m*n) (good! If a solution exists &lt; N^delta, it will be found)"</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="204"></td><td><pre></pre></td></tr><tr><td data-num="205"></td><td><pre>    <span class="token comment"># display the lattice basis</span></pre></td></tr><tr><td data-num="206"></td><td><pre>    <span class="token keyword">if</span> debug<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="207"></td><td><pre>        matrix_overview<span class="token punctuation">(</span>BB<span class="token punctuation">,</span> modulus<span class="token operator">^</span>mm<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="208"></td><td><pre></pre></td></tr><tr><td data-num="209"></td><td><pre>    <span class="token comment"># LLL</span></pre></td></tr><tr><td data-num="210"></td><td><pre>    <span class="token keyword">if</span> debug<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="211"></td><td><pre>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"optimizing basis of the lattice via LLL, this can take a long time"</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="212"></td><td><pre></pre></td></tr><tr><td data-num="213"></td><td><pre>    BB <span class="token operator">=</span> BB<span class="token punctuation">.</span>LLL<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="214"></td><td><pre></pre></td></tr><tr><td data-num="215"></td><td><pre>    <span class="token keyword">if</span> debug<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="216"></td><td><pre>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"LLL is done!"</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="217"></td><td><pre></pre></td></tr><tr><td data-num="218"></td><td><pre>    <span class="token comment"># transform vector i &amp; j -> polynomials 1 &amp; 2</span></pre></td></tr><tr><td data-num="219"></td><td><pre>    <span class="token keyword">if</span> debug<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="220"></td><td><pre>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"looking for independent vectors in the lattice"</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="221"></td><td><pre>    found_polynomials <span class="token operator">=</span> <span class="token boolean">False</span></pre></td></tr><tr><td data-num="222"></td><td><pre>    </pre></td></tr><tr><td data-num="223"></td><td><pre>    <span class="token keyword">for</span> pol1_idx <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>nn <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="224"></td><td><pre>        <span class="token keyword">for</span> pol2_idx <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>pol1_idx <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> nn<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="225"></td><td><pre>            <span class="token comment"># for i and j, create the two polynomials</span></pre></td></tr><tr><td data-num="226"></td><td><pre>            PR<span class="token punctuation">.</span><span class="token operator">&lt;</span>w<span class="token punctuation">,</span>z<span class="token operator">></span> <span class="token operator">=</span> PolynomialRing<span class="token punctuation">(</span>ZZ<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="227"></td><td><pre>            pol1 <span class="token operator">=</span> pol2 <span class="token operator">=</span> <span class="token number">0</span></pre></td></tr><tr><td data-num="228"></td><td><pre>            <span class="token keyword">for</span> jj <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>nn<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="229"></td><td><pre>                pol1 <span class="token operator">+=</span> monomials<span class="token punctuation">[</span>jj<span class="token punctuation">]</span><span class="token punctuation">(</span>w<span class="token operator">*</span>z<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span>w<span class="token punctuation">,</span>z<span class="token punctuation">)</span> <span class="token operator">*</span> BB<span class="token punctuation">[</span>pol1_idx<span class="token punctuation">,</span> jj<span class="token punctuation">]</span> <span class="token operator">/</span> monomials<span class="token punctuation">[</span>jj<span class="token punctuation">]</span><span class="token punctuation">(</span>UU<span class="token punctuation">,</span>XX<span class="token punctuation">,</span>YY<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="230"></td><td><pre>                pol2 <span class="token operator">+=</span> monomials<span class="token punctuation">[</span>jj<span class="token punctuation">]</span><span class="token punctuation">(</span>w<span class="token operator">*</span>z<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span>w<span class="token punctuation">,</span>z<span class="token punctuation">)</span> <span class="token operator">*</span> BB<span class="token punctuation">[</span>pol2_idx<span class="token punctuation">,</span> jj<span class="token punctuation">]</span> <span class="token operator">/</span> monomials<span class="token punctuation">[</span>jj<span class="token punctuation">]</span><span class="token punctuation">(</span>UU<span class="token punctuation">,</span>XX<span class="token punctuation">,</span>YY<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="231"></td><td><pre></pre></td></tr><tr><td data-num="232"></td><td><pre>            <span class="token comment"># resultant</span></pre></td></tr><tr><td data-num="233"></td><td><pre>            PR<span class="token punctuation">.</span><span class="token operator">&lt;</span>q<span class="token operator">></span> <span class="token operator">=</span> PolynomialRing<span class="token punctuation">(</span>ZZ<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="234"></td><td><pre>            rr <span class="token operator">=</span> pol1<span class="token punctuation">.</span>resultant<span class="token punctuation">(</span>pol2<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="235"></td><td><pre></pre></td></tr><tr><td data-num="236"></td><td><pre>            <span class="token comment"># are these good polynomials?</span></pre></td></tr><tr><td data-num="237"></td><td><pre>            <span class="token keyword">if</span> rr<span class="token punctuation">.</span>is_zero<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">or</span> rr<span class="token punctuation">.</span>monomials<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="238"></td><td><pre>                <span class="token keyword">continue</span></pre></td></tr><tr><td data-num="239"></td><td><pre>            <span class="token keyword">else</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="240"></td><td><pre>                <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"found them, using vectors"</span><span class="token punctuation">,</span> pol1_idx<span class="token punctuation">,</span> <span class="token string">"and"</span><span class="token punctuation">,</span> pol2_idx<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="241"></td><td><pre>                found_polynomials <span class="token operator">=</span> <span class="token boolean">True</span></pre></td></tr><tr><td data-num="242"></td><td><pre>                <span class="token keyword">break</span></pre></td></tr><tr><td data-num="243"></td><td><pre>        <span class="token keyword">if</span> found_polynomials<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="244"></td><td><pre>            <span class="token keyword">break</span></pre></td></tr><tr><td data-num="245"></td><td><pre></pre></td></tr><tr><td data-num="246"></td><td><pre>    <span class="token keyword">if</span> <span class="token keyword">not</span> found_polynomials<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="247"></td><td><pre>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"no independant vectors could be found. This should very rarely happen..."</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="248"></td><td><pre>        <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span></pre></td></tr><tr><td data-num="249"></td><td><pre>    </pre></td></tr><tr><td data-num="250"></td><td><pre>    rr <span class="token operator">=</span> rr<span class="token punctuation">(</span>q<span class="token punctuation">,</span> q<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="251"></td><td><pre></pre></td></tr><tr><td data-num="252"></td><td><pre>    <span class="token comment"># solutions</span></pre></td></tr><tr><td data-num="253"></td><td><pre>    soly <span class="token operator">=</span> rr<span class="token punctuation">.</span>roots<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="254"></td><td><pre></pre></td></tr><tr><td data-num="255"></td><td><pre>    <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>soly<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="256"></td><td><pre>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Your prediction (delta) is too small"</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="257"></td><td><pre>        <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span></pre></td></tr><tr><td data-num="258"></td><td><pre></pre></td></tr><tr><td data-num="259"></td><td><pre>    soly <span class="token operator">=</span> soly<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="260"></td><td><pre>    ss <span class="token operator">=</span> pol1<span class="token punctuation">(</span>q<span class="token punctuation">,</span> soly<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="261"></td><td><pre>    solx <span class="token operator">=</span> ss<span class="token punctuation">.</span>roots<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="262"></td><td><pre></pre></td></tr><tr><td data-num="263"></td><td><pre>    <span class="token comment">#</span></pre></td></tr><tr><td data-num="264"></td><td><pre>    <span class="token keyword">return</span> solx<span class="token punctuation">,</span> soly</pre></td></tr><tr><td data-num="265"></td><td><pre></pre></td></tr><tr><td data-num="266"></td><td><pre><span class="token keyword">def</span> <span class="token function">example</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="267"></td><td><pre>    <span class="token comment">############################################</span></pre></td></tr><tr><td data-num="268"></td><td><pre>    <span class="token comment"># How To Use This Script</span></pre></td></tr><tr><td data-num="269"></td><td><pre>    <span class="token comment">##########################################</span></pre></td></tr><tr><td data-num="270"></td><td><pre></pre></td></tr><tr><td data-num="271"></td><td><pre>    <span class="token comment">#</span></pre></td></tr><tr><td data-num="272"></td><td><pre>    <span class="token comment"># The problem to solve (edit the following values)</span></pre></td></tr><tr><td data-num="273"></td><td><pre>    <span class="token comment">#</span></pre></td></tr><tr><td data-num="274"></td><td><pre></pre></td></tr><tr><td data-num="275"></td><td><pre>    <span class="token comment"># the modulus</span></pre></td></tr><tr><td data-num="276"></td><td><pre>    N <span class="token operator">=</span> <span class="token number">0x665166804cd78e8197073f65f58bca14e019982245fcc7cad74535e948a4e0258b2e919bf3720968a00e5240c5e1d6b8831d8fec300d969fccec6cce11dde826d3fbe0837194f2dc64194c78379440671563c6c75267f0286d779e6d91d3e9037c642a860a894d8c45b7ed564d341501cedf260d3019234f2964ccc6c56b6de8a4f66667e9672a03f6c29d95100cdf5cb363d66f2131823a953621680300ab3a2eb51c12999b6d4249dde499055584925399f3a8c7a4a5a21f095878e80bbc772f785d2cbf70a87c6b854eb566e1e1beb7d4ac6eb46023b3dc7fdf34529a40f5fc5797f9c15c54ed4cb018c072168e9c30ca3602e00ea4047d2e5686c6eb37b9</span></pre></td></tr><tr><td data-num="277"></td><td><pre>    <span class="token comment"># the public exponent</span></pre></td></tr><tr><td data-num="278"></td><td><pre>    e <span class="token operator">=</span> <span class="token number">0x2c998e57bc651fe4807443dbb3e794711ca22b473d7792a64b7a326538dc528a17c79c72e425bf29937e47b2d6f6330ee5c13bfd8564b50e49132d47befd0ee2e85f4bfe2c9452d62ef838d487c099b3d7c80f14e362b3d97ca4774f1e4e851d38a4a834b077ded3d40cd20ddc45d57581beaa7b4d299da9dec8a1f361c808637238fa368e07c7d08f5654c7b2f8a90d47857e9b9c0a81a46769f6307d5a4442707afb017959d9a681fa1dc8d97565e55f02df34b04a3d0a0bf98b7798d7084db4b3f6696fa139f83ada3dc70d0b4c57bf49f530dec938096071f9c4498fdef9641dfbfe516c985b27d1748cc6ce1a4beb1381fb165a3d14f61032e0f76f095d</span></pre></td></tr><tr><td data-num="279"></td><td><pre></pre></td></tr><tr><td data-num="280"></td><td><pre>    <span class="token comment"># the hypothesis on the private exponent (the theoretical maximum is 0.292)</span></pre></td></tr><tr><td data-num="281"></td><td><pre>    delta <span class="token operator">=</span> <span class="token number">.18</span> <span class="token comment"># this means that d &lt; N^delta</span></pre></td></tr><tr><td data-num="282"></td><td><pre></pre></td></tr><tr><td data-num="283"></td><td><pre>    <span class="token comment">#</span></pre></td></tr><tr><td data-num="284"></td><td><pre>    <span class="token comment"># Lattice (tweak those values)</span></pre></td></tr><tr><td data-num="285"></td><td><pre>    <span class="token comment">#</span></pre></td></tr><tr><td data-num="286"></td><td><pre></pre></td></tr><tr><td data-num="287"></td><td><pre>    <span class="token comment"># you should tweak this (after a first run), (e.g. increment it until a solution is found)</span></pre></td></tr><tr><td data-num="288"></td><td><pre>    m <span class="token operator">=</span> <span class="token number">4</span> <span class="token comment"># size of the lattice (bigger the better/slower)</span></pre></td></tr><tr><td data-num="289"></td><td><pre></pre></td></tr><tr><td data-num="290"></td><td><pre>    <span class="token comment"># you need to be a lattice master to tweak these</span></pre></td></tr><tr><td data-num="291"></td><td><pre>    t <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">-</span><span class="token number">2</span><span class="token operator">*</span>delta<span class="token punctuation">)</span> <span class="token operator">*</span> m<span class="token punctuation">)</span>  <span class="token comment"># optimization from Herrmann and May</span></pre></td></tr><tr><td data-num="292"></td><td><pre>    X <span class="token operator">=</span> <span class="token number">2</span><span class="token operator">*</span>floor<span class="token punctuation">(</span>N<span class="token operator">^</span>delta<span class="token punctuation">)</span>  <span class="token comment"># this _might_ be too much</span></pre></td></tr><tr><td data-num="293"></td><td><pre>    Y <span class="token operator">=</span> floor<span class="token punctuation">(</span>N<span class="token operator">^</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token comment"># correct if p, q are ~ same size</span></pre></td></tr><tr><td data-num="294"></td><td><pre></pre></td></tr><tr><td data-num="295"></td><td><pre>    <span class="token comment">#</span></pre></td></tr><tr><td data-num="296"></td><td><pre>    <span class="token comment"># Don't touch anything below</span></pre></td></tr><tr><td data-num="297"></td><td><pre>    <span class="token comment">#</span></pre></td></tr><tr><td data-num="298"></td><td><pre></pre></td></tr><tr><td data-num="299"></td><td><pre>    <span class="token comment"># Problem put in equation</span></pre></td></tr><tr><td data-num="300"></td><td><pre>    P<span class="token punctuation">.</span><span class="token operator">&lt;</span>x<span class="token punctuation">,</span>y<span class="token operator">></span> <span class="token operator">=</span> PolynomialRing<span class="token punctuation">(</span>ZZ<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="301"></td><td><pre>    A <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span><span class="token punctuation">(</span>N<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="302"></td><td><pre>    pol <span class="token operator">=</span> <span class="token number">1</span> <span class="token operator">+</span> x <span class="token operator">*</span> <span class="token punctuation">(</span>A <span class="token operator">+</span> y<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="303"></td><td><pre></pre></td></tr><tr><td data-num="304"></td><td><pre>    <span class="token comment">#</span></pre></td></tr><tr><td data-num="305"></td><td><pre>    <span class="token comment"># Find the solutions!</span></pre></td></tr><tr><td data-num="306"></td><td><pre>    <span class="token comment">#</span></pre></td></tr><tr><td data-num="307"></td><td><pre></pre></td></tr><tr><td data-num="308"></td><td><pre>    <span class="token comment"># Checking bounds</span></pre></td></tr><tr><td data-num="309"></td><td><pre>    <span class="token keyword">if</span> debug<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="310"></td><td><pre>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"=== checking values ==="</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="311"></td><td><pre>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"* delta:"</span><span class="token punctuation">,</span> delta<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="312"></td><td><pre>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"* delta &lt; 0.292"</span><span class="token punctuation">,</span> delta <span class="token operator">&lt;</span> <span class="token number">0.292</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="313"></td><td><pre>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"* size of e:"</span><span class="token punctuation">,</span> <span class="token builtin">int</span><span class="token punctuation">(</span>log<span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token operator">/</span>log<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="314"></td><td><pre>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"* size of N:"</span><span class="token punctuation">,</span> <span class="token builtin">int</span><span class="token punctuation">(</span>log<span class="token punctuation">(</span>N<span class="token punctuation">)</span><span class="token operator">/</span>log<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="315"></td><td><pre>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"* m:"</span><span class="token punctuation">,</span> m<span class="token punctuation">,</span> <span class="token string">", t:"</span><span class="token punctuation">,</span> t<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="316"></td><td><pre></pre></td></tr><tr><td data-num="317"></td><td><pre>    <span class="token comment"># boneh_durfee</span></pre></td></tr><tr><td data-num="318"></td><td><pre>    <span class="token keyword">if</span> debug<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="319"></td><td><pre>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"=== running algorithm ==="</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="320"></td><td><pre>        start_time <span class="token operator">=</span> time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="321"></td><td><pre></pre></td></tr><tr><td data-num="322"></td><td><pre>    solx<span class="token punctuation">,</span> soly <span class="token operator">=</span> boneh_durfee<span class="token punctuation">(</span>pol<span class="token punctuation">,</span> e<span class="token punctuation">,</span> m<span class="token punctuation">,</span> t<span class="token punctuation">,</span> X<span class="token punctuation">,</span> Y<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="323"></td><td><pre></pre></td></tr><tr><td data-num="324"></td><td><pre>    <span class="token comment"># found a solution?</span></pre></td></tr><tr><td data-num="325"></td><td><pre>    <span class="token keyword">if</span> solx <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="326"></td><td><pre>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"=== solution found ==="</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="327"></td><td><pre>        <span class="token keyword">if</span> <span class="token boolean">False</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="328"></td><td><pre>            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"x:"</span><span class="token punctuation">,</span> solx<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="329"></td><td><pre>            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"y:"</span><span class="token punctuation">,</span> soly<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="330"></td><td><pre></pre></td></tr><tr><td data-num="331"></td><td><pre>        d <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>pol<span class="token punctuation">(</span>solx<span class="token punctuation">,</span> soly<span class="token punctuation">)</span> <span class="token operator">/</span> e<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="332"></td><td><pre>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"private key found:"</span><span class="token punctuation">,</span> d<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="333"></td><td><pre>    <span class="token keyword">else</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="334"></td><td><pre>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"=== no solution was found ==="</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="335"></td><td><pre></pre></td></tr><tr><td data-num="336"></td><td><pre>    <span class="token keyword">if</span> debug<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="337"></td><td><pre>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token string">"=== %s seconds ==="</span> <span class="token operator">%</span> <span class="token punctuation">(</span>time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> start_time<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="338"></td><td><pre></pre></td></tr><tr><td data-num="339"></td><td><pre><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="340"></td><td><pre>    example<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr></table></figure><p>通过 sage 跑出来 d 的值</p><p><img data-src="https://s3.bmp.ovh/imgs/2022/03/9f2dd7c1bcdeae97.png" alt=""></p><p>最后用生成的 d 去解开明文就好啦</p><p>这边说一下 Boneh_Durfee's Attack 的推导公式：</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>e</mi><mo>∗</mo><mi>d</mi><mo>=</mo><mn>1</mn><mi>m</mi><mi>o</mi><mi>d</mi><mi>p</mi><mi>h</mi><mi>i</mi><mo stretchy="false">(</mo><mi>N</mi><mo stretchy="false">)</mo><mo>&lt;</mo><mo>=</mo><mo>=</mo><mo>=</mo><mo>=</mo><mo>&gt;</mo><mi>k</mi><mo>∗</mo><mi>p</mi><mi>h</mi><mi>i</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mo>+</mo><mn>1</mn><mo>=</mo><mn>0</mn><mi>m</mi><mi>o</mi><mi>d</mi><mi>e</mi><mspace linebreak="newline"></mspace><mtext>即</mtext><mn>2</mn><mi>k</mi><mrow><mo fence="true">(</mo><mfrac><mrow><mi>N</mi><mo>+</mo><mn>1</mn></mrow><mn>2</mn></mfrac><mo>+</mo><mfrac><mrow><mo>−</mo><mi>p</mi><mo>−</mo><mi>q</mi></mrow><mn>2</mn></mfrac><mo fence="true">)</mo></mrow><mo>+</mo><mn>1</mn><mo>=</mo><mn>0</mn><mi>m</mi><mi>o</mi><mi>d</mi><mi>e</mi></mrow><annotation encoding="application/x-tex">e*d = 1 mod phi(N) &lt;====&gt; k * phi(n) + 1 = 0 mod e \\ 即2k \left( \frac{N+1}{2} + \frac{-p-q}{2} \right)+1=0mode</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.46528em;vertical-align:0"></span><span class="mord mathnormal">e</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.69444em;vertical-align:0"></span><span class="mord mathnormal">d</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord">1</span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class="mord mathnormal">h</span><span class="mord mathnormal">i</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:.10903em">N</span><span class="mclose">)</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">&lt;</span></span><span class="base"><span class="strut" style="height:.36687em;vertical-align:0"></span><span class="mrel">=</span></span><span class="base"><span class="strut" style="height:.36687em;vertical-align:0"></span><span class="mrel">=</span></span><span class="base"><span class="strut" style="height:.36687em;vertical-align:0"></span><span class="mrel">=</span></span><span class="base"><span class="strut" style="height:.36687em;vertical-align:0"></span><span class="mrel">=</span></span><span class="base"><span class="strut" style="height:.5782em;vertical-align:-.0391em"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.69444em;vertical-align:0"></span><span class="mord mathnormal" style="margin-right:.03148em">k</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathnormal">p</span><span class="mord mathnormal">h</span><span class="mord mathnormal">i</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">1</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.69444em;vertical-align:0"></span><span class="mord">0</span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mord mathnormal">e</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:2.40003em;vertical-align:-.95003em"></span><span class="mord cjk_fallback">即</span><span class="mord">2</span><span class="mord mathnormal" style="margin-right:.03148em">k</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="minner"><span class="mopen delimcenter" style="top:0"><span class="delimsizing size3">(</span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.36033em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">2</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.10903em">N</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.2603300000000002em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">2</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">−</span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord mathnormal" style="margin-right:.03588em">q</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose delimcenter" style="top:0"><span class="delimsizing size3">)</span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">1</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.69444em;vertical-align:0"></span><span class="mord">0</span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mord mathnormal">e</span></span></span></span></span></p><p>换成二元一次方程就是</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo stretchy="false">)</mo><mo>=</mo><mn>1</mn><mo>+</mo><mi>x</mi><mo stretchy="false">(</mo><mi>A</mi><mo>+</mo><mi>y</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">f(x,y)=1+x(A+y)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathnormal" style="margin-right:.10764em">f</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord mathnormal" style="margin-right:.03588em">y</span><span class="mclose">)</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.72777em;vertical-align:-.08333em"></span><span class="mord">1</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathnormal">x</span><span class="mopen">(</span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathnormal" style="margin-right:.03588em">y</span><span class="mclose">)</span></span></span></span></span></p><p>通过这个通式可以解决未知 d 的问题；</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>e</mi><mi>d</mi><mo>=</mo><mn>1</mn><mo>+</mo><mi>x</mi><mo stretchy="false">(</mo><mfrac><mrow><mi>N</mi><mo>+</mo><mn>1</mn></mrow><mn>2</mn></mfrac><mo>+</mo><mi>y</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">ed=1+x(\frac{N+1}{2}+y)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.69444em;vertical-align:0"></span><span class="mord mathnormal">e</span><span class="mord mathnormal">d</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.72777em;vertical-align:-.08333em"></span><span class="mord">1</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:2.04633em;vertical-align:-.686em"></span><span class="mord mathnormal">x</span><span class="mopen">(</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.36033em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">2</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.10903em">N</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathnormal" style="margin-right:.03588em">y</span><span class="mclose">)</span></span></span></span></span></p><h2 id="一道蛮有意思的rsa"><a class="anchor" href="#一道蛮有意思的rsa">#</a> 一道蛮有意思的 RSA</h2><p>源码：</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> getPrime<span class="token punctuation">,</span> long_to_bytes<span class="token punctuation">,</span> bytes_to_long<span class="token punctuation">,</span> inverse</pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">import</span> math</pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">from</span> gmpy2 <span class="token keyword">import</span> next_prime</pre></td></tr><tr><td data-num="4"></td><td><pre></pre></td></tr><tr><td data-num="5"></td><td><pre>FLAG <span class="token operator">=</span> <span class="token string">b"crypto&#123;????????????????????????????????????????????????&#125;"</span></pre></td></tr><tr><td data-num="6"></td><td><pre></pre></td></tr><tr><td data-num="7"></td><td><pre>p <span class="token operator">=</span> getPrime<span class="token punctuation">(</span><span class="token number">1024</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="8"></td><td><pre>q <span class="token operator">=</span> getPrime<span class="token punctuation">(</span><span class="token number">1024</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="9"></td><td><pre>N <span class="token operator">=</span> p<span class="token operator">*</span>q</pre></td></tr><tr><td data-num="10"></td><td><pre>phi <span class="token operator">=</span> <span class="token punctuation">(</span>p<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>q<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="11"></td><td><pre>e <span class="token operator">=</span> <span class="token number">0x10001</span></pre></td></tr><tr><td data-num="12"></td><td><pre>d <span class="token operator">=</span> inverse<span class="token punctuation">(</span>e<span class="token punctuation">,</span> phi<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="13"></td><td><pre></pre></td></tr><tr><td data-num="14"></td><td><pre>my_key <span class="token operator">=</span> <span class="token punctuation">(</span>N<span class="token punctuation">,</span> d<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="15"></td><td><pre></pre></td></tr><tr><td data-num="16"></td><td><pre>friends <span class="token operator">=</span> <span class="token number">5</span></pre></td></tr><tr><td data-num="17"></td><td><pre>friend_keys <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">(</span>N<span class="token punctuation">,</span> getPrime<span class="token punctuation">(</span><span class="token number">17</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">for</span> _ <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>friends<span class="token punctuation">)</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="18"></td><td><pre></pre></td></tr><tr><td data-num="19"></td><td><pre>cipher <span class="token operator">=</span> bytes_to_long<span class="token punctuation">(</span>FLAG<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="20"></td><td><pre></pre></td></tr><tr><td data-num="21"></td><td><pre><span class="token keyword">for</span> key <span class="token keyword">in</span> friend_keys<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="22"></td><td><pre>    cipher <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>cipher<span class="token punctuation">,</span> key<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> key<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="23"></td><td><pre></pre></td></tr><tr><td data-num="24"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"My private key: </span><span class="token interpolation"><span class="token punctuation">&#123;</span>my_key<span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="25"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"My Friend's public keys: </span><span class="token interpolation"><span class="token punctuation">&#123;</span>friend_keys<span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="26"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Encrypted flag: </span><span class="token interpolation"><span class="token punctuation">&#123;</span>cipher<span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">)</span></pre></td></tr></table></figure><p>output:</p><figure class="highlight html"><figcaption data-lang="HTML"></figcaption><table><tr><td data-num="1"></td><td><pre>My private key: (21711308225346315542706844618441565741046498277716979943478360598053144971379956916575370343448988601905854572029635846626259487297950305231661109855854947494209135205589258643517961521594924368498672064293208230802441077390193682958095111922082677813175804775628884377724377647428385841831277059274172982280545237765559969228707506857561215268491024097063920337721783673060530181637161577401589126558556182546896783307370517275046522704047385786111489447064794210010802761708615907245523492585896286374996088089317826162798278528296206977900274431829829206103227171839270887476436899494428371323874689055690729986771, 2734411677251148030723138005716109733838866545375527602018255159319631026653190783670493107936401603981429171880504360560494771017246468702902647370954220312452541342858747590576273775107870450853533717116684326976263006435733382045807971890762018747729574021057430331778033982359184838159747331236538501849965329264774927607570410347019418407451937875684373454982306923178403161216817237890962651214718831954215200637651103907209347900857824722653217179548148145687181377220544864521808230122730967452981435355334932104265488075777638608041325256776275200067541533022527964743478554948792578057708522350812154888097)</pre></td></tr><tr><td data-num="2"></td><td><pre>My Friend's public keys: [(21711308225346315542706844618441565741046498277716979943478360598053144971379956916575370343448988601905854572029635846626259487297950305231661109855854947494209135205589258643517961521594924368498672064293208230802441077390193682958095111922082677813175804775628884377724377647428385841831277059274172982280545237765559969228707506857561215268491024097063920337721783673060530181637161577401589126558556182546896783307370517275046522704047385786111489447064794210010802761708615907245523492585896286374996088089317826162798278528296206977900274431829829206103227171839270887476436899494428371323874689055690729986771, 106979), (21711308225346315542706844618441565741046498277716979943478360598053144971379956916575370343448988601905854572029635846626259487297950305231661109855854947494209135205589258643517961521594924368498672064293208230802441077390193682958095111922082677813175804775628884377724377647428385841831277059274172982280545237765559969228707506857561215268491024097063920337721783673060530181637161577401589126558556182546896783307370517275046522704047385786111489447064794210010802761708615907245523492585896286374996088089317826162798278528296206977900274431829829206103227171839270887476436899494428371323874689055690729986771, 108533), (21711308225346315542706844618441565741046498277716979943478360598053144971379956916575370343448988601905854572029635846626259487297950305231661109855854947494209135205589258643517961521594924368498672064293208230802441077390193682958095111922082677813175804775628884377724377647428385841831277059274172982280545237765559969228707506857561215268491024097063920337721783673060530181637161577401589126558556182546896783307370517275046522704047385786111489447064794210010802761708615907245523492585896286374996088089317826162798278528296206977900274431829829206103227171839270887476436899494428371323874689055690729986771, 69557), (21711308225346315542706844618441565741046498277716979943478360598053144971379956916575370343448988601905854572029635846626259487297950305231661109855854947494209135205589258643517961521594924368498672064293208230802441077390193682958095111922082677813175804775628884377724377647428385841831277059274172982280545237765559969228707506857561215268491024097063920337721783673060530181637161577401589126558556182546896783307370517275046522704047385786111489447064794210010802761708615907245523492585896286374996088089317826162798278528296206977900274431829829206103227171839270887476436899494428371323874689055690729986771, 97117), (21711308225346315542706844618441565741046498277716979943478360598053144971379956916575370343448988601905854572029635846626259487297950305231661109855854947494209135205589258643517961521594924368498672064293208230802441077390193682958095111922082677813175804775628884377724377647428385841831277059274172982280545237765559969228707506857561215268491024097063920337721783673060530181637161577401589126558556182546896783307370517275046522704047385786111489447064794210010802761708615907245523492585896286374996088089317826162798278528296206977900274431829829206103227171839270887476436899494428371323874689055690729986771, 103231)]</pre></td></tr><tr><td data-num="3"></td><td><pre>Encrypted flag: 20304610279578186738172766224224793119885071262464464448863461184092225736054747976985179673905441502689126216282897704508745403799054734121583968853999791604281615154100736259131453424385364324630229671185343778172807262640709301838274824603101692485662726226902121105591137437331463201881264245562214012160875177167442010952439360623396658974413900469093836794752270399520074596329058725874834082188697377597949405779039139194196065364426213208345461407030771089787529200057105746584493554722790592530472869581310117300343461207750821737840042745530876391793484035024644475535353227851321505537398888106855012746117</pre></td></tr></table></figure><p>A 手中有一份（N,d）传给五个人不同的（N,e）</p><p>并且源码里这段是关键</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">for</span> key <span class="token keyword">in</span> friend_keys<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="2"></td><td><pre>    cipher <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>cipher<span class="token punctuation">,</span> key<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> key<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span></pre></td></tr></table></figure><p>总之就是把明文先加密了五遍，那我们只要将它倒序解密五遍就好了。</p><p>key [1] 是 e，那么我们就换成 d 即可；</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">for</span> i <span class="token keyword">in</span> e<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="2"></td><td><pre>    d<span class="token punctuation">.</span>append<span class="token punctuation">(</span>gmpy2<span class="token punctuation">.</span>invert<span class="token punctuation">(</span>i<span class="token punctuation">,</span>phi<span class="token punctuation">)</span><span class="token punctuation">)</span> </pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span>d<span class="token punctuation">)</span></pre></td></tr></table></figure><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">#payload</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">import</span> gmpy2</pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> getPrime<span class="token punctuation">,</span> long_to_bytes<span class="token punctuation">,</span> bytes_to_long<span class="token punctuation">,</span> inverse</pre></td></tr><tr><td data-num="4"></td><td><pre>n<span class="token operator">=</span><span class="token number">21711308225346315542706844618441565741046498277716979943478360598053144971379956916575370343448988601905854572029635846626259487297950305231661109855854947494209135205589258643517961521594924368498672064293208230802441077390193682958095111922082677813175804775628884377724377647428385841831277059274172982280545237765559969228707506857561215268491024097063920337721783673060530181637161577401589126558556182546896783307370517275046522704047385786111489447064794210010802761708615907245523492585896286374996088089317826162798278528296206977900274431829829206103227171839270887476436899494428371323874689055690729986771</span></pre></td></tr><tr><td data-num="5"></td><td><pre>c<span class="token operator">=</span><span class="token number">20304610279578186738172766224224793119885071262464464448863461184092225736054747976985179673905441502689126216282897704508745403799054734121583968853999791604281615154100736259131453424385364324630229671185343778172807262640709301838274824603101692485662726226902121105591137437331463201881264245562214012160875177167442010952439360623396658974413900469093836794752270399520074596329058725874834082188697377597949405779039139194196065364426213208345461407030771089787529200057105746584493554722790592530472869581310117300343461207750821737840042745530876391793484035024644475535353227851321505537398888106855012746117</span></pre></td></tr><tr><td data-num="6"></td><td><pre>p<span class="token operator">=</span><span class="token number">134460556242811604004061671529264401215233974442536870999694816691450423689575549530215841622090861571494882591368883283016107051686642467260643894947947473532769025695530343815260424314855023688439603651834585971233941772580950216838838690315383700689885536546289584980534945897919914730948196240662991266027</span></pre></td></tr><tr><td data-num="7"></td><td><pre>q<span class="token operator">=</span><span class="token number">161469718942256895682124261315253003309512855995894840701317251772156087404025170146631429756064534716206164807382734456438092732743677793224010769460318383691408352089793973150914149255603969984103815563896440419666191368964699279209687091969164697704779792586727943470780308857107052647197945528236341228473</span></pre></td></tr><tr><td data-num="8"></td><td><pre>phi<span class="token operator">=</span><span class="token punctuation">(</span>p<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>q<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="9"></td><td><pre>e <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">103231</span><span class="token punctuation">,</span><span class="token number">97117</span><span class="token punctuation">,</span><span class="token number">69557</span><span class="token punctuation">,</span><span class="token number">108533</span><span class="token punctuation">,</span><span class="token number">106979</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="10"></td><td><pre>d<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="11"></td><td><pre><span class="token keyword">for</span> i <span class="token keyword">in</span> e<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="12"></td><td><pre>    d<span class="token punctuation">.</span>append<span class="token punctuation">(</span>gmpy2<span class="token punctuation">.</span>invert<span class="token punctuation">(</span>i<span class="token punctuation">,</span>phi<span class="token punctuation">)</span><span class="token punctuation">)</span> </pre></td></tr><tr><td data-num="13"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span>d<span class="token punctuation">)</span> </pre></td></tr><tr><td data-num="14"></td><td><pre></pre></td></tr><tr><td data-num="15"></td><td><pre>m<span class="token operator">=</span>c</pre></td></tr><tr><td data-num="16"></td><td><pre><span class="token keyword">for</span> i <span class="token keyword">in</span> d<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="17"></td><td><pre>    m<span class="token operator">=</span>gmpy2<span class="token punctuation">.</span>powmod<span class="token punctuation">(</span>m<span class="token punctuation">,</span>i<span class="token punctuation">,</span>n<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="18"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span>long_to_bytes<span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr></table></figure><h2 id="欧拉函数运用"><a class="anchor" href="#欧拉函数运用">#</a> 欧拉函数运用</h2><p>output:</p><figure class="highlight html"><figcaption data-lang="HTML"></figcaption><table><tr><td data-num="1"></td><td><pre>n=535860808044009550029177135708168016201451343147313565371014459027743491739422885443084705720731409713775527993719682583669164873806842043288439828071789970694759080842162253955259590552283047728782812946845160334801782088068154453021936721710269050985805054692096738777321796153384024897615594493453068138341203673749514094546000253631902991617197847584519694152122765406982133526594928685232381934742152195861380221224370858128736975959176861651044370378539093990198336298572944512738570839396588590096813217791191895941380464803377602779240663133834952329316862399581950590588006371221334128215409197603236942597674756728212232134056562716399155080108881105952768189193728827484667349378091100068224404684701674782399200373192433062767622841264055426035349769018117299620554803902490432339600566432246795818167460916180647394169157647245603555692735630862148715428791242764799469896924753470539857080767170052783918273180304835318388177089674231640910337743789750979216202573226794240332797892868276309400253925932223895530714169648116569013581643192341931800785254715083294526325980247219218364118877864892068185905587410977152737936310734712276956663192182487672474651103240004173381041237906849437490609652395748868434296753449</pre></td></tr><tr><td data-num="2"></td><td><pre>e=65537</pre></td></tr><tr><td data-num="3"></td><td><pre>c=222502885974182429500948389840563415291534726891354573907329512556439632810921927905220486727807436668035929302442754225952786602492250448020341217733646472982286222338860566076161977786095675944552232391481278782019346283900959677167026636830252067048759720251671811058647569724495547940966885025629807079171218371644528053562232396674283745310132242492367274184667845174514466834132589971388067076980563188513333661165819462428837210575342101036356974189393390097403614434491507672459254969638032776897417674577487775755539964915035731988499983726435005007850876000232292458554577437739427313453671492956668188219600633325930981748162455965093222648173134777571527681591366164711307355510889316052064146089646772869610726671696699221157985834325663661400034831442431209123478778078255846830522226390964119818784903330200488705212765569163495571851459355520398928214206285080883954881888668509262455490889283862560453598662919522224935145694435885396500780651530829377030371611921181207362217397805303962112100190783763061909945889717878397740711340114311597934724670601992737526668932871436226135393872881664511222789565256059138002651403875484920711316522536260604255269532161594824301047729082877262812899724246757871448545439896</pre></td></tr></table></figure><p>可以分解 n；</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>n</mi><mo>=</mo><msup><mi>p</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">n=p^2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.43056em;vertical-align:0"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1.0585479999999998em;vertical-align:-.19444em"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8641079999999999em"><span style="top:-3.113em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span></p><p>那么欧拉定理中当</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>n</mi><mo>=</mo><msup><mi>p</mi><mn>2</mn></msup><mspace linebreak="newline"></mspace><mtext>则</mtext><mi>p</mi><mi>h</mi><mi>i</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mo>=</mo><msup><mi>p</mi><mi>k</mi></msup><mo>−</mo><msup><mi>p</mi><mrow><mi>k</mi><mo>−</mo><mn>1</mn></mrow></msup></mrow><annotation encoding="application/x-tex">n=p^2\\则phi(n)=p^k-p^{k-1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.43056em;vertical-align:0"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1.0585479999999998em;vertical-align:-.19444em"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8641079999999999em"><span style="top:-3.113em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord cjk_fallback">则</span><span class="mord mathnormal">p</span><span class="mord mathnormal">h</span><span class="mord mathnormal">i</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1.093548em;vertical-align:-.19444em"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8991079999999999em"><span style="top:-3.113em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:.03148em">k</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1.093548em;vertical-align:-.19444em"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8991079999999999em"><span style="top:-3.113em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:.03148em">k</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span></span></span></span></span></p><p>payload：</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">import</span> gmpy2</pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> long_to_bytes</pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">from</span> libnum <span class="token keyword">import</span> n2s</pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">import</span> math</pre></td></tr><tr><td data-num="5"></td><td><pre>n<span class="token operator">=</span><span class="token number">535860808044009550029177135708168016201451343147313565371014459027743491739422885443084705720731409713775527993719682583669164873806842043288439828071789970694759080842162253955259590552283047728782812946845160334801782088068154453021936721710269050985805054692096738777321796153384024897615594493453068138341203673749514094546000253631902991617197847584519694152122765406982133526594928685232381934742152195861380221224370858128736975959176861651044370378539093990198336298572944512738570839396588590096813217791191895941380464803377602779240663133834952329316862399581950590588006371221334128215409197603236942597674756728212232134056562716399155080108881105952768189193728827484667349378091100068224404684701674782399200373192433062767622841264055426035349769018117299620554803902490432339600566432246795818167460916180647394169157647245603555692735630862148715428791242764799469896924753470539857080767170052783918273180304835318388177089674231640910337743789750979216202573226794240332797892868276309400253925932223895530714169648116569013581643192341931800785254715083294526325980247219218364118877864892068185905587410977152737936310734712276956663192182487672474651103240004173381041237906849437490609652395748868434296753449</span></pre></td></tr><tr><td data-num="6"></td><td><pre>p<span class="token operator">=</span><span class="token number">23148667521998097720857168827790771337662483716348435477360567409355026169165934446949809664595523770853897203103759106983985113264049057416908191166720008503275951625738975666019029172377653170602440373579593292576530667773951407647222757756437867216095193174201323278896027294517792607881861855264600525772460745259440301156930943255240915685718552334192230264780355799179037816026330705422484000086542362084006958158550346395941862383925942033730030004606360308379776255436206440529441711859246811586652746028418496020145441513037535475380962562108920699929022900677901988508936509354385660735694568216631382653107</span></pre></td></tr><tr><td data-num="7"></td><td><pre>phi<span class="token operator">=</span>p<span class="token operator">**</span><span class="token number">2</span><span class="token operator">-</span>p</pre></td></tr><tr><td data-num="8"></td><td><pre>e<span class="token operator">=</span><span class="token number">65537</span></pre></td></tr><tr><td data-num="9"></td><td><pre>d<span class="token operator">=</span>gmpy2<span class="token punctuation">.</span>invert<span class="token punctuation">(</span>e<span class="token punctuation">,</span>phi<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="10"></td><td><pre>c<span class="token operator">=</span><span class="token number">222502885974182429500948389840563415291534726891354573907329512556439632810921927905220486727807436668035929302442754225952786602492250448020341217733646472982286222338860566076161977786095675944552232391481278782019346283900959677167026636830252067048759720251671811058647569724495547940966885025629807079171218371644528053562232396674283745310132242492367274184667845174514466834132589971388067076980563188513333661165819462428837210575342101036356974189393390097403614434491507672459254969638032776897417674577487775755539964915035731988499983726435005007850876000232292458554577437739427313453671492956668188219600633325930981748162455965093222648173134777571527681591366164711307355510889316052064146089646772869610726671696699221157985834325663661400034831442431209123478778078255846830522226390964119818784903330200488705212765569163495571851459355520398928214206285080883954881888668509262455490889283862560453598662919522224935145694435885396500780651530829377030371611921181207362217397805303962112100190783763061909945889717878397740711340114311597934724670601992737526668932871436226135393872881664511222789565256059138002651403875484920711316522536260604255269532161594824301047729082877262812899724246757871448545439896</span></pre></td></tr><tr><td data-num="11"></td><td><pre><span class="token comment">#print (n2s (int (gmpy2.iroot (c,e)[0])).decode (),end="") #c 开 e 次根 m=pow (c,d,n) d=invert (e,(p-1)*(q-1))</span></pre></td></tr><tr><td data-num="12"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span>n2s<span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span>gmpy2<span class="token punctuation">.</span>powmod<span class="token punctuation">(</span>c<span class="token punctuation">,</span>d<span class="token punctuation">,</span>n<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr></table></figure><h3 id="欧拉函数"><a class="anchor" href="#欧拉函数">#</a> 欧拉函数</h3><p>如何计算欧拉函数<br>通式：</p><h4 id="积性函数"><a class="anchor" href="#积性函数">#</a> 积性函数</h4><p>若当 m 与 n 互质时，f (m∗n) = f (m)∗f (n) ，那么 f 是积性函数。</p><p>若对任意正整数，都有 f (m*n)=f (m)*f (n) 成立，则 f 是完全积性函数。</p><h4 id="欧拉函数的几个性质"><a class="anchor" href="#欧拉函数的几个性质">#</a> 欧拉函数的几个性质</h4><ol><li><p>对于质数 p，phi (p)=p-1</p></li><li><p>p 为质数，</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>n</mi><mo>=</mo><msup><mi>p</mi><mi>k</mi></msup></mrow><annotation encoding="application/x-tex">n=p^k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.43056em;vertical-align:0"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1.093548em;vertical-align:-.19444em"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8991079999999999em"><span style="top:-3.113em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:.03148em">k</span></span></span></span></span></span></span></span></span></span></span></span></p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>p</mi><mi>h</mi><mi>i</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mo>=</mo><msup><mi>p</mi><mi>k</mi></msup><mo>−</mo><msup><mi>p</mi><mrow><mi>k</mi><mo>−</mo><mn>1</mn></mrow></msup></mrow><annotation encoding="application/x-tex">phi(n)=p^k - p^{k-1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathnormal">p</span><span class="mord mathnormal">h</span><span class="mord mathnormal">i</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1.093548em;vertical-align:-.19444em"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8991079999999999em"><span style="top:-3.113em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:.03148em">k</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1.093548em;vertical-align:-.19444em"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8991079999999999em"><span style="top:-3.113em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:.03148em">k</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span></span></span></span></span></p><p>欧拉函数是积性函数，但不是完全积性函数。若 m,n 互质，则</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>φ</mi><mo stretchy="false">(</mo><mi>m</mi><mtext>∗</mtext><mi>n</mi><mo stretchy="false">)</mo><mo>=</mo><mi>φ</mi><mo stretchy="false">(</mo><mi>m</mi><mo stretchy="false">)</mo><mtext>∗</mtext><mi>φ</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">φ ( m ∗ n ) = φ ( m ) ∗ φ ( n )</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathnormal">φ</span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mord">∗</span><span class="mord mathnormal">n</span><span class="mclose">)</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathnormal">φ</span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mclose">)</span><span class="mord">∗</span><span class="mord mathnormal">φ</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span></span></p><p>特殊的，当 m=2，n 为奇数时，</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>φ</mi><mo stretchy="false">(</mo><mn>2</mn><mo>∗</mo><mi>n</mi><mo stretchy="false">)</mo><mo>=</mo><mi>φ</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">φ(2*n)=φ(n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathnormal">φ</span><span class="mopen">(</span><span class="mord">2</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathnormal">n</span><span class="mclose">)</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathnormal">φ</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span></span></p><ol start="3"><li>当 n&gt;2 时，φ(n) 是偶数</li></ol></li></ol><h2 id="schmidt-samoa-密码体系"><a class="anchor" href="#schmidt-samoa-密码体系">#</a> Schmidt-Samoa 密码体系</h2><p><em>与 Rabin 类似，它的安全性基于大整数分解的困难性。但 Rabin 解密时会得到四个解，而 Schmidt-Samor 得到的是唯一解。</em></p><h3 id="稍微带一下rabin"><a class="anchor" href="#稍微带一下rabin">#</a> 稍微带一下 Rabin</h3><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msup><mi>m</mi><mn>2</mn></msup><mo>≡</mo><mi>c</mi><mi>m</mi><mi>o</mi><mi>d</mi><mi>n</mi><mi>N</mi><mo>⟺</mo><mrow><mo fence="true">{</mo><mtable rowspacing="0.3599999999999999em" columnalign="left left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msup><mi>m</mi><mn>2</mn></msup><mo>≡</mo><mi>c</mi><mi>m</mi><mi>o</mi><mi>d</mi><mi>p</mi><mspace width="1em"><mi>A</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msup><mi>m</mi><mn>2</mn></msup><mo>≡</mo><mi>c</mi><mi>m</mi><mi>o</mi><mi>d</mi><mi>q</mi><mspace width="1em"><mi>B</mi></mrow></mstyle></mtd></mtr></mtable></mrow></mrow><annotation encoding="application/x-tex">m^2\equiv cmodnN \Longleftrightarrow\begin{cases} m^2\equiv cmodp\quad A \\ m^2\equiv cmodq \quad B\end{cases}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8641079999999999em;vertical-align:0"></span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8641079999999999em"><span style="top:-3.113em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">≡</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.71844em;vertical-align:-.024em"></span><span class="mord mathnormal">c</span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mord mathnormal">n</span><span class="mord mathnormal" style="margin-right:.10903em">N</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">⟺</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:3.0000299999999998em;vertical-align:-1.25003em"></span><span class="minner"><span class="mopen delimcenter" style="top:0"><span class="delimsizing size4">{</span></span><span class="mord"><span class="mtable"><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.69em"><span style="top:-3.69em"><span class="pstrut" style="height:3.008em"></span><span class="mord"><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8141079999999999em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">≡</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mord mathnormal">c</span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:1em"></span><span class="mord mathnormal">A</span></span></span><span style="top:-2.25em"><span class="pstrut" style="height:3.008em"></span><span class="mord"><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8141079999999999em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">≡</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mord mathnormal">c</span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mord mathnormal" style="margin-right:.03588em">q</span><span class="mspace" style="margin-right:1em"></span><span class="mord mathnormal" style="margin-right:.05017em">B</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.19em"><span></span></span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p><p>运用 Legendre 符号</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mo stretchy="false">(</mo><mfrac><mi>c</mi><mi>p</mi></mfrac><mo stretchy="false">)</mo><mo>=</mo><msup><mi>c</mi><mfrac><mrow><mi>p</mi><mo>−</mo><mn>1</mn></mrow><mn>2</mn></mfrac></msup></mrow><annotation encoding="application/x-tex">(\frac cp)=c^{\frac {p-1}2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.9880000000000002em;vertical-align:-.8804400000000001em"></span><span class="mopen">(</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.10756em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord mathnormal">p</span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord mathnormal">c</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.8804400000000001em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1.0588899999999999em;vertical-align:0"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.0588899999999999em"><span style="top:-3.4130000000000003em;margin-right:.05em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mopen nulldelimiter sizing reset-size3 size6"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.9227em"><span style="top:-2.656em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span><span style="top:-3.2255000000000003em"><span class="pstrut" style="height:3em"></span><span class="frac-line mtight" style="border-bottom-width:.049em"></span></span><span style="top:-3.4623857142857144em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">p</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.344em"><span></span></span></span></span></span><span class="mclose nulldelimiter sizing reset-size3 size6"></span></span></span></span></span></span></span></span></span></span></span></span></span></span></p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msup><mi>c</mi><mfrac><mrow><mi>p</mi><mo>−</mo><mn>1</mn></mrow><mn>2</mn></mfrac></msup><mo>≡</mo><mn>1</mn><mi>m</mi><mi>o</mi><mi>d</mi><mi>p</mi></mrow><annotation encoding="application/x-tex">c^{\frac {p-1}2} \equiv 1 mod p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0588899999999999em;vertical-align:0"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.0588899999999999em"><span style="top:-3.4130000000000003em;margin-right:.05em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mopen nulldelimiter sizing reset-size3 size6"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.9227em"><span style="top:-2.656em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span><span style="top:-3.2255000000000003em"><span class="pstrut" style="height:3em"></span><span class="frac-line mtight" style="border-bottom-width:.049em"></span></span><span style="top:-3.4623857142857144em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">p</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.344em"><span></span></span></span></span></span><span class="mclose nulldelimiter sizing reset-size3 size6"></span></span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">≡</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.8888799999999999em;vertical-align:-.19444em"></span><span class="mord">1</span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span></span></span></span></span></p><p>代入 A 式</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msup><mi>m</mi><mn>2</mn></msup><mo>≡</mo><msup><mi>c</mi><mfrac><mrow><mi>p</mi><mo>+</mo><mn>1</mn></mrow><mn>2</mn></mfrac></msup><mi>m</mi><mi>o</mi><mi>d</mi><mi>p</mi></mrow><annotation encoding="application/x-tex">m^2\equiv c^{\frac {p+1}2}modp</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8641079999999999em;vertical-align:0"></span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8641079999999999em"><span style="top:-3.113em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">≡</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1.2533299999999998em;vertical-align:-.19444em"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.0588899999999999em"><span style="top:-3.4130000000000003em;margin-right:.05em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mopen nulldelimiter sizing reset-size3 size6"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.9227em"><span style="top:-2.656em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span><span style="top:-3.2255000000000003em"><span class="pstrut" style="height:3em"></span><span class="frac-line mtight" style="border-bottom-width:.049em"></span></span><span style="top:-3.4623857142857144em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">p</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.344em"><span></span></span></span></span></span><span class="mclose nulldelimiter sizing reset-size3 size6"></span></span></span></span></span></span></span></span></span></span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span></span></span></span></span></p><p>继续开根</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mo fence="true">{</mo><mtable rowspacing="0.3599999999999999em" columnalign="left left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi>m</mi><mn>1</mn></msub><mo>≡</mo><msup><mi>c</mi><mfrac><mrow><mi>p</mi><mo>+</mo><mn>1</mn></mrow><mn>4</mn></mfrac></msup><mi>m</mi><mi>o</mi><mi>d</mi><mi>p</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi>m</mi><mn>2</mn></msub><mo>≡</mo><mi>p</mi><mo>−</mo><msup><mi>c</mi><mfrac><mrow><mi>p</mi><mo>+</mo><mn>1</mn></mrow><mn>4</mn></mfrac></msup><mi>m</mi><mi>o</mi><mi>d</mi><mi>p</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi>m</mi><mn>3</mn></msub><mo>≡</mo><msup><mi>c</mi><mfrac><mrow><mi>p</mi><mo>+</mo><mn>1</mn></mrow><mn>4</mn></mfrac></msup><mi>m</mi><mi>o</mi><mi>d</mi><mi>p</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi>m</mi><mn>4</mn></msub><mo>≡</mo><mi>q</mi><mo>−</mo><msup><mi>c</mi><mfrac><mrow><mi>p</mi><mo>+</mo><mn>1</mn></mrow><mn>4</mn></mfrac></msup><mi>m</mi><mi>o</mi><mi>d</mi><mi>p</mi></mrow></mstyle></mtd></mtr></mtable></mrow><annotation encoding="application/x-tex">\begin{cases} m_1\equiv c^{\frac {p+1}4}modp \\ m_2\equiv p-c^{\frac {p+1}4}modp \\ m_3\equiv c^{\frac {p+1}4}modp \\ m_4\equiv q-c^{\frac {p+1}4}modp\end{cases}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:5.76356em;vertical-align:-2.63178em"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.9500200000000008em"><span style="top:-1.59999em"><span class="pstrut" style="height:3.15em"></span><span class="delimsizinginner delim-size4"><span>⎩</span></span></span><span style="top:-1.5949900000000001em"><span class="pstrut" style="height:3.15em"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-1.8899900000000003em"><span class="pstrut" style="height:3.15em"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-2.1849900000000004em"><span class="pstrut" style="height:3.15em"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-2.2049900000000004em"><span class="pstrut" style="height:3.15em"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-3.1500100000000004em"><span class="pstrut" style="height:3.15em"></span><span class="delimsizinginner delim-size4"><span>⎨</span></span></span><span style="top:-4.29501em"><span class="pstrut" style="height:3.15em"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-4.59001em"><span class="pstrut" style="height:3.15em"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-4.885010000000001em"><span class="pstrut" style="height:3.15em"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-4.905010000000001em"><span class="pstrut" style="height:3.15em"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-5.20002em"><span class="pstrut" style="height:3.15em"></span><span class="delimsizinginner delim-size4"><span>⎧</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.45002em"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.1317800000000005em"><span style="top:-5.131780000000001em"><span class="pstrut" style="height:3.00889em"></span><span class="mord"><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">≡</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.00889em"><span style="top:-3.363em;margin-right:.05em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mopen nulldelimiter sizing reset-size3 size6"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.9227em"><span style="top:-2.656em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">4</span></span></span><span style="top:-3.2255000000000003em"><span class="pstrut" style="height:3em"></span><span class="frac-line mtight" style="border-bottom-width:.049em"></span></span><span style="top:-3.4623857142857144em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">p</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.344em"><span></span></span></span></span></span><span class="mclose nulldelimiter sizing reset-size3 size6"></span></span></span></span></span></span></span></span></span></span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span></span></span><span style="top:-3.6908900000000004em"><span class="pstrut" style="height:3.00889em"></span><span class="mord"><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">≡</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.00889em"><span style="top:-3.363em;margin-right:.05em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mopen nulldelimiter sizing reset-size3 size6"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.9227em"><span style="top:-2.656em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">4</span></span></span><span style="top:-3.2255000000000003em"><span class="pstrut" style="height:3em"></span><span class="frac-line mtight" style="border-bottom-width:.049em"></span></span><span style="top:-3.4623857142857144em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">p</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.344em"><span></span></span></span></span></span><span class="mclose nulldelimiter sizing reset-size3 size6"></span></span></span></span></span></span></span></span></span></span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span></span></span><span style="top:-2.2500000000000004em"><span class="pstrut" style="height:3.00889em"></span><span class="mord"><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">≡</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.00889em"><span style="top:-3.363em;margin-right:.05em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mopen nulldelimiter sizing reset-size3 size6"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.9227em"><span style="top:-2.656em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">4</span></span></span><span style="top:-3.2255000000000003em"><span class="pstrut" style="height:3em"></span><span class="frac-line mtight" style="border-bottom-width:.049em"></span></span><span style="top:-3.4623857142857144em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">p</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.344em"><span></span></span></span></span></span><span class="mclose nulldelimiter sizing reset-size3 size6"></span></span></span></span></span></span></span></span></span></span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span></span></span><span style="top:-.8091100000000001em"><span class="pstrut" style="height:3.00889em"></span><span class="mord"><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">≡</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mord mathnormal" style="margin-right:.03588em">q</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.00889em"><span style="top:-3.363em;margin-right:.05em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mopen nulldelimiter sizing reset-size3 size6"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.9227em"><span style="top:-2.656em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">4</span></span></span><span style="top:-3.2255000000000003em"><span class="pstrut" style="height:3em"></span><span class="frac-line mtight" style="border-bottom-width:.049em"></span></span><span style="top:-3.4623857142857144em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">p</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.344em"><span></span></span></span></span></span><span class="mclose nulldelimiter sizing reset-size3 size6"></span></span></span></span></span></span></span></span></span></span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.63178em"><span></span></span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p><p><img data-src="https://s3.bmp.ovh/imgs/2022/03/110f7b259a9b75b5.png" alt=""></p><p>利用中国剩余定理解出 a、c</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">import</span> gmpy2</pre></td></tr><tr><td data-num="2"></td><td><pre>n<span class="token operator">=</span><span class="token number">523798549</span></pre></td></tr><tr><td data-num="3"></td><td><pre>p<span class="token operator">=</span><span class="token number">10663</span></pre></td></tr><tr><td data-num="4"></td><td><pre>q<span class="token operator">=</span><span class="token number">49123</span></pre></td></tr><tr><td data-num="5"></td><td><pre>e<span class="token operator">=</span><span class="token number">2</span></pre></td></tr><tr><td data-num="6"></td><td><pre>c<span class="token operator">=</span><span class="token number">162853095</span></pre></td></tr><tr><td data-num="7"></td><td><pre>a<span class="token punctuation">,</span>inv_q <span class="token punctuation">,</span>inv_p<span class="token operator">=</span> gmpy2<span class="token punctuation">.</span>gcdext<span class="token punctuation">(</span>q<span class="token punctuation">,</span>p<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="8"></td><td><pre>mp <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> <span class="token punctuation">(</span>p <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">//</span> <span class="token number">4</span><span class="token punctuation">,</span> p<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="9"></td><td><pre>mq <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> <span class="token punctuation">(</span>q <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">//</span> <span class="token number">4</span><span class="token punctuation">,</span> q<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="10"></td><td><pre>a <span class="token operator">=</span> <span class="token punctuation">(</span>inv_p <span class="token operator">*</span> p <span class="token operator">*</span> mq <span class="token operator">+</span> inv_q <span class="token operator">*</span> q <span class="token operator">*</span> mp<span class="token punctuation">)</span> <span class="token operator">%</span> n</pre></td></tr><tr><td data-num="11"></td><td><pre>b <span class="token operator">=</span> n <span class="token operator">-</span> <span class="token builtin">int</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="12"></td><td><pre>c <span class="token operator">=</span> <span class="token punctuation">(</span>inv_p <span class="token operator">*</span> p <span class="token operator">*</span> mq <span class="token operator">-</span> inv_q <span class="token operator">*</span> q <span class="token operator">*</span> mp<span class="token punctuation">)</span> <span class="token operator">%</span> n</pre></td></tr><tr><td data-num="13"></td><td><pre>d <span class="token operator">=</span> n <span class="token operator">-</span> <span class="token builtin">int</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="14"></td><td><pre><span class="token keyword">for</span> i <span class="token keyword">in</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span>b<span class="token punctuation">,</span>c<span class="token punctuation">,</span>d<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="15"></td><td><pre>    <span class="token keyword">print</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span></pre></td></tr></table></figure><p>好啦，说完 Rabin 就回来讲一下 samoa 吧。</p><p>下面先贴一份相关题目的源码</p><p><strong><span class="exturl" data-url="aHR0cDovL2VuYy5weQ==">enc.py</span></strong></p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> <span class="token operator">*</span></pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">def</span> <span class="token function">generkey</span><span class="token punctuation">(</span>k<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="4"></td><td><pre>	p<span class="token punctuation">,</span> q <span class="token operator">=</span> getPrime<span class="token punctuation">(</span>k<span class="token punctuation">)</span><span class="token punctuation">,</span> getPrime<span class="token punctuation">(</span>k<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="5"></td><td><pre>	pubkey <span class="token operator">=</span> p<span class="token operator">**</span><span class="token number">2</span> <span class="token operator">*</span> q</pre></td></tr><tr><td data-num="6"></td><td><pre>	n <span class="token operator">=</span> pubkey</pre></td></tr><tr><td data-num="7"></td><td><pre>	l <span class="token operator">=</span> <span class="token punctuation">(</span>p<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>q<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">/</span> gcd<span class="token punctuation">(</span>p<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> q<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="8"></td><td><pre>	privkey <span class="token operator">=</span> inverse<span class="token punctuation">(</span>n<span class="token punctuation">,</span> l<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="9"></td><td><pre>	<span class="token keyword">return</span> pubkey<span class="token punctuation">,</span> privkey</pre></td></tr><tr><td data-num="10"></td><td><pre></pre></td></tr><tr><td data-num="11"></td><td><pre><span class="token keyword">def</span> <span class="token function">encrypt</span><span class="token punctuation">(</span>m<span class="token punctuation">,</span> pubkey<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="12"></td><td><pre>	<span class="token keyword">return</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>bytes_to_long<span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">,</span> pubkey<span class="token punctuation">,</span> pubkey<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="13"></td><td><pre></pre></td></tr><tr><td data-num="14"></td><td><pre></pre></td></tr><tr><td data-num="15"></td><td><pre><span class="token comment"># pubkey =  2188967977749378274223515689363599801320698247938997135947965550196681836543275429767581633044354412195352229175764784503562989045268075431206876726265968368605210824232207290410773979606662689866265612797103853982014198455433380266671856355564273196151136025319624636805659505233975208570409914054916955097594873702395812044506205943671404203774360656553350987491558491176962018842708476009578127303566834534914605109859995649555122751891647040448980718882755855420324482466559223748065037520788159654436293431470164057490350841209872489538460060216015196875136927502162027562546316560342464968237957692873588796640619530455268367136243313422579857823529592167101260779382665832380054690727358197646512896661216090677033395209196007249594394515130315041760988292009930675192749010228592156047159029095406021812884258810889225617544404799863903982758961208187042972047819358256866346758337277473016068375206319837317222523597</span></pre></td></tr><tr><td data-num="16"></td><td><pre><span class="token comment"># privkey = 1430375790065574721602196196929651174572674429040725535698217207301881161695296519567051246290199551982286327831985649037584885137134580625982555634409225551121712376849579015320947279716204424716566222721338735256648873164510429206991141648646869378141312253135997851908862030990576004173514556541317395106924370019574216894560447817319669690140544728277302043783163888037836675290468320723215759693903569878293475447370766682477726453262771004872749335257953507469109966448126634101604029506006038527612917418016783711729800719387298398848370079742790126047329182349899824258355003200173612567191747851669220766603</span></pre></td></tr><tr><td data-num="17"></td><td><pre><span class="token comment"># enc = 1491421391364871767357931639710394622399451019824572362288458431186299231664459957755422474433520889084351841298056066100216440853409346006657723086501921816381226292526490195810903459483318275931326433052468863850690793659405367902593999395060606972100169925074005992478583035226026829214443008941631771292291305226470216430735050944285543542354459162474346521327649934512511202470099020668235115245819634762067338432916012664452035696422865651002305445711778476072004708256200872226475346448360491248823843688268126341094612981308791499434770936360676087490303951728563482686307164877000300082742316368597958297217061375140696272398140310043942637287763946305961019518639745426370821124559939597559475362769382796386720030343305889701616194279058139516811941262747298761646317383112470923295543635754747288259324745583689440061956478083777663996487389553238481759103908588004219390662578446313004404784835263543083088327198</span></pre></td></tr></table></figure><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mtext>首先计算</mtext><mi>ϕ</mi><mo stretchy="false">(</mo><mi>N</mi><mo stretchy="false">)</mo><mo>=</mo><mi>ϕ</mi><mo stretchy="false">)</mo><mo stretchy="false">(</mo><msup><mi>p</mi><mn>2</mn></msup><mi>q</mi><mo stretchy="false">)</mo><mo>=</mo><mi>p</mi><mo stretchy="false">(</mo><mi>p</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo><mo stretchy="false">(</mo><mi>q</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">首先计算\phi(N)=\phi)(p^2q)=p(p-1)(q-1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord cjk_fallback">首</span><span class="mord cjk_fallback">先</span><span class="mord cjk_fallback">计</span><span class="mord cjk_fallback">算</span><span class="mord mathnormal">ϕ</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:.10903em">N</span><span class="mclose">)</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1.1141079999999999em;vertical-align:-.25em"></span><span class="mord mathnormal">ϕ</span><span class="mclose">)</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8641079999999999em"><span style="top:-3.113em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:.03588em">q</span><span class="mclose">)</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathnormal">p</span><span class="mopen">(</span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord">1</span><span class="mclose">)</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:.03588em">q</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord">1</span><span class="mclose">)</span></span></span></span></span></p><p><img data-src="https://s3.bmp.ovh/imgs/2022/03/820eba7b828b8d26.png" alt=""></p><p>如图我们得到</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msup><mi>x</mi><mrow><mi>p</mi><mo stretchy="false">(</mo><mi>p</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo><mo stretchy="false">(</mo><mi>q</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></msup><mo>≡</mo><mn>1</mn><mi>m</mi><mi>o</mi><mi>d</mi><mi>N</mi></mrow><annotation encoding="application/x-tex">x^{p(p-1)(q-1)}\equiv1modN</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.938em;vertical-align:0"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.938em"><span style="top:-3.113em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">p</span><span class="mopen mtight">(</span><span class="mord mathnormal mtight">p</span><span class="mbin mtight">−</span><span class="mord mtight">1</span><span class="mclose mtight">)</span><span class="mopen mtight">(</span><span class="mord mathnormal mtight" style="margin-right:.03588em">q</span><span class="mbin mtight">−</span><span class="mord mtight">1</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">≡</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.69444em;vertical-align:0"></span><span class="mord">1</span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mord mathnormal" style="margin-right:.10903em">N</span></span></span></span></span></p><p><img data-src="https://s3.bmp.ovh/imgs/2022/03/f6fca818daa2783a.png" alt=""></p><p>通过 paper 知道模 pq 时</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>N</mi><mo separator="true">⋅</mo><mi>d</mi><mo>≡</mo><mn>1</mn><mi>m</mi><mi>o</mi><mi>d</mi><mo stretchy="false">(</mo><mi>p</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo><mo stretchy="false">(</mo><mi>q</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo><mspace width="1em"><mspace width="1em"><mspace width="1em"><mspace width="1em"><msup><mn>2</mn><mrow><mi>N</mi><mo separator="true">⋅</mo><mi>d</mi></mrow></msup><mo>≡</mo><msup><mn>2</mn><mrow><mi>N</mi><mo separator="true">⋅</mo><mi>d</mi><mi>m</mi><mi>o</mi><mi>d</mi><mo stretchy="false">(</mo><mi>p</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo><mo stretchy="false">(</mo><mi>q</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></msup><mo>≡</mo><mn>2</mn><mi>m</mi><mi>o</mi><mi>d</mi><mi>p</mi><mi>q</mi></mrow><annotation encoding="application/x-tex">N·d\equiv1mod(p-1)(q-1) \quad \quad\quad\quad2^{N·d}\equiv2^{N·dmod(p-1)(q-1)}\equiv2modpq</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.69444em;vertical-align:0"></span><span class="mord mathnormal" style="margin-right:.10903em">N</span><span class="mpunct">⋅</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord mathnormal">d</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">≡</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord">1</span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mopen">(</span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord">1</span><span class="mclose">)</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:.03588em">q</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1.149108em;vertical-align:-.25em"></span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right:1em"></span><span class="mspace" style="margin-right:1em"></span><span class="mspace" style="margin-right:1em"></span><span class="mspace" style="margin-right:1em"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8991079999999999em"><span style="top:-3.113em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:.10903em">N</span><span class="mpunct mtight">⋅</span><span class="mord mathnormal mtight">d</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">≡</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.938em;vertical-align:0"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.938em"><span style="top:-3.113em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:.10903em">N</span><span class="mpunct mtight">⋅</span><span class="mord mathnormal mtight">d</span><span class="mord mathnormal mtight">m</span><span class="mord mathnormal mtight">o</span><span class="mord mathnormal mtight">d</span><span class="mopen mtight">(</span><span class="mord mathnormal mtight">p</span><span class="mbin mtight">−</span><span class="mord mtight">1</span><span class="mclose mtight">)</span><span class="mopen mtight">(</span><span class="mord mathnormal mtight" style="margin-right:.03588em">q</span><span class="mbin mtight">−</span><span class="mord mtight">1</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">≡</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.8888799999999999em;vertical-align:-.19444em"></span><span class="mord">2</span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class="mord mathnormal" style="margin-right:.03588em">q</span></span></span></span></span></p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>p</mi><mi>q</mi><mi mathvariant="normal">∣</mi><msup><mn>2</mn><mrow><mi>N</mi><mo separator="true">⋅</mo><mi>d</mi></mrow></msup><mo>−</mo><mn>2</mn><mspace width="1em"><mspace width="1em"><mspace width="1em"><mi>g</mi><mi>c</mi><mi>d</mi><mo stretchy="false">(</mo><msup><mn>2</mn><mrow><mi>N</mi><mo separator="true">⋅</mo><mi>d</mi></mrow></msup><mo>−</mo><mn>2</mn><mo separator="true">,</mo><mi>N</mi><mo stretchy="false">)</mo><mo>=</mo><msup><mn>2</mn><mrow><mi>N</mi><mo separator="true">⋅</mo><mi>d</mi></mrow></msup><mo>−</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">pq|2^{N·d}-2 \quad\quad\quad gcd(2^{N·d}-2,N)=2^{N·d}-2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.149108em;vertical-align:-.25em"></span><span class="mord mathnormal">p</span><span class="mord mathnormal" style="margin-right:.03588em">q</span><span class="mord">∣</span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8991079999999999em"><span style="top:-3.113em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:.10903em">N</span><span class="mpunct mtight">⋅</span><span class="mord mathnormal mtight">d</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1.149108em;vertical-align:-.25em"></span><span class="mord">2</span><span class="mspace" style="margin-right:1em"></span><span class="mspace" style="margin-right:1em"></span><span class="mspace" style="margin-right:1em"></span><span class="mord mathnormal" style="margin-right:.03588em">g</span><span class="mord mathnormal">c</span><span class="mord mathnormal">d</span><span class="mopen">(</span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8991079999999999em"><span style="top:-3.113em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:.10903em">N</span><span class="mpunct mtight">⋅</span><span class="mord mathnormal mtight">d</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord mathnormal" style="margin-right:.10903em">N</span><span class="mclose">)</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.9824379999999999em;vertical-align:-.08333em"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8991079999999999em"><span style="top:-3.113em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:.10903em">N</span><span class="mpunct mtight">⋅</span><span class="mord mathnormal mtight">d</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">2</span></span></span></span></span></p><p>自此可以得到 pq，最后在模 pq 下计算 c^d，即</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msup><mi>c</mi><mi>d</mi></msup><mo>≡</mo><msup><mi>m</mi><mrow><mi>N</mi><mo separator="true">⋅</mo><mi>d</mi></mrow></msup><mo>≡</mo><msup><mn>2</mn><mrow><mi>N</mi><mo separator="true">⋅</mo><mi>d</mi><mi>m</mi><mi>o</mi><mi>d</mi><mo stretchy="false">(</mo><mi>p</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo><mo stretchy="false">(</mo><mi>q</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></msup><mo>≡</mo><mi>m</mi><mi>m</mi><mi>o</mi><mi>d</mi><mi>p</mi><mi>q</mi></mrow><annotation encoding="application/x-tex">c^d\equiv m^{N·d}\equiv2^{N·dmod(p-1)(q-1)}\equiv mmodpq</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8991079999999999em;vertical-align:0"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8991079999999999em"><span style="top:-3.113em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">d</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">≡</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.8991079999999999em;vertical-align:0"></span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8991079999999999em"><span style="top:-3.113em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:.10903em">N</span><span class="mpunct mtight">⋅</span><span class="mord mathnormal mtight">d</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">≡</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.938em;vertical-align:0"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.938em"><span style="top:-3.113em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:.10903em">N</span><span class="mpunct mtight">⋅</span><span class="mord mathnormal mtight">d</span><span class="mord mathnormal mtight">m</span><span class="mord mathnormal mtight">o</span><span class="mord mathnormal mtight">d</span><span class="mopen mtight">(</span><span class="mord mathnormal mtight">p</span><span class="mbin mtight">−</span><span class="mord mtight">1</span><span class="mclose mtight">)</span><span class="mopen mtight">(</span><span class="mord mathnormal mtight" style="margin-right:.03588em">q</span><span class="mbin mtight">−</span><span class="mord mtight">1</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">≡</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.8888799999999999em;vertical-align:-.19444em"></span><span class="mord mathnormal">m</span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class="mord mathnormal" style="margin-right:.03588em">q</span></span></span></span></span></p><p><strong><span class="exturl" data-url="aHR0cDovL2RlYy5weQ==">dec.py</span></strong></p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">import</span> gmpy2</pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> long_to_bytes</pre></td></tr><tr><td data-num="3"></td><td><pre></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">def</span> <span class="token function">getPQ</span><span class="token punctuation">(</span>pub<span class="token punctuation">,</span> priv<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="5"></td><td><pre>    <span class="token keyword">return</span> gmpy2<span class="token punctuation">.</span>gcd<span class="token punctuation">(</span>pub<span class="token punctuation">,</span> gmpy2<span class="token punctuation">.</span>powmod<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> pub<span class="token operator">*</span>priv<span class="token punctuation">,</span> pub<span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="6"></td><td><pre></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token keyword">def</span> <span class="token function">decrypt</span><span class="token punctuation">(</span>pub<span class="token punctuation">,</span> priv<span class="token punctuation">,</span> enc<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="8"></td><td><pre>    <span class="token keyword">return</span> gmpy2<span class="token punctuation">.</span>powmod<span class="token punctuation">(</span>enc<span class="token punctuation">,</span> priv<span class="token punctuation">,</span> getPQ<span class="token punctuation">(</span>pub<span class="token punctuation">,</span> priv<span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="9"></td><td><pre></pre></td></tr><tr><td data-num="10"></td><td><pre>pubkey <span class="token operator">=</span>  <span class="token number">2188967977749378274223515689363599801320698247938997135947965550196681836543275429767581633044354412195352229175764784503562989045268075431206876726265968368605210824232207290410773979606662689866265612797103853982014198455433380266671856355564273196151136025319624636805659505233975208570409914054916955097594873702395812044506205943671404203774360656553350987491558491176962018842708476009578127303566834534914605109859995649555122751891647040448980718882755855420324482466559223748065037520788159654436293431470164057490350841209872489538460060216015196875136927502162027562546316560342464968237957692873588796640619530455268367136243313422579857823529592167101260779382665832380054690727358197646512896661216090677033395209196007249594394515130315041760988292009930675192749010228592156047159029095406021812884258810889225617544404799863903982758961208187042972047819358256866346758337277473016068375206319837317222523597</span></pre></td></tr><tr><td data-num="11"></td><td><pre>privkey <span class="token operator">=</span> <span class="token number">1430375790065574721602196196929651174572674429040725535698217207301881161695296519567051246290199551982286327831985649037584885137134580625982555634409225551121712376849579015320947279716204424716566222721338735256648873164510429206991141648646869378141312253135997851908862030990576004173514556541317395106924370019574216894560447817319669690140544728277302043783163888037836675290468320723215759693903569878293475447370766682477726453262771004872749335257953507469109966448126634101604029506006038527612917418016783711729800719387298398848370079742790126047329182349899824258355003200173612567191747851669220766603</span></pre></td></tr><tr><td data-num="12"></td><td><pre>enc <span class="token operator">=</span> <span class="token number">1491421391364871767357931639710394622399451019824572362288458431186299231664459957755422474433520889084351841298056066100216440853409346006657723086501921816381226292526490195810903459483318275931326433052468863850690793659405367902593999395060606972100169925074005992478583035226026829214443008941631771292291305226470216430735050944285543542354459162474346521327649934512511202470099020668235115245819634762067338432916012664452035696422865651002305445711778476072004708256200872226475346448360491248823843688268126341094612981308791499434770936360676087490303951728563482686307164877000300082742316368597958297217061375140696272398140310043942637287763946305961019518639745426370821124559939597559475362769382796386720030343305889701616194279058139516811941262747298761646317383112470923295543635754747288259324745583689440061956478083777663996487389553238481759103908588004219390662578446313004404784835263543083088327198</span></pre></td></tr><tr><td data-num="13"></td><td><pre></pre></td></tr><tr><td data-num="14"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span>long_to_bytes<span class="token punctuation">(</span>decrypt<span class="token punctuation">(</span>pubkey<span class="token punctuation">,</span> privkey<span class="token punctuation">,</span> enc<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr></table></figure><h2 id="扩展欧几里得"><a class="anchor" href="#扩展欧几里得">#</a> 扩展欧几里得</h2><p><img data-src="https://s3.bmp.ovh/imgs/2022/03/30/9a2cce6cbd430fad.png" alt=""></p><h2 id="handicraft_rsa"><a class="anchor" href="#handicraft_rsa">#</a> Handicraft_RSA</h2><p>​ -----from Xctf</p><p>发下来的文件在 windows 打不开，我们去 linux</p><p><img data-src="https://s3.bmp.ovh/imgs/2022/04/01/55c2fff0428ee4a3.png" alt=""></p><p>xz 压缩百度一下用这个命令</p><figure class="highlight html"><figcaption data-lang="HTML"></figcaption><table><tr><td data-num="1"></td><td><pre>xz -d f5346507773f4b909479387d59a01710.xz</pre></td></tr></table></figure><p>一定要在文件名加后缀哦，不然会变成这个样子</p><p><img data-src="https://s3.bmp.ovh/imgs/2022/04/01/a3da0574d81a9c36.png" alt=""></p><p>解压完成</p><p><img data-src="https://s3.bmp.ovh/imgs/2022/04/01/b494aee2e4b2dfee.png" alt=""></p><p>里面有一份公钥我们 openssl 解一下</p><p><img data-src="https://s3.bmp.ovh/imgs/2022/04/01/c41bac63c4e4927b.png" alt=""></p><p><img data-src="https://s3.bmp.ovh/imgs/2022/04/01/f7cd3de0702ba576.png" alt=""></p><p>开局前先得到 n，e</p><h3 id="handicraft_rsapy"><a class="anchor" href="#handicraft_rsapy">#</a> handicraft_rsa.py</h3><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">#!/usr/bin/python</span></pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> <span class="token operator">*</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>PublicKey <span class="token keyword">import</span> RSA</pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token keyword">from</span> secret <span class="token keyword">import</span> s<span class="token punctuation">,</span> FLAG</pre></td></tr><tr><td data-num="6"></td><td><pre></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token keyword">def</span> <span class="token function">gen_prime</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="8"></td><td><pre>    <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="9"></td><td><pre>        r <span class="token operator">=</span> getPrime<span class="token punctuation">(</span>s<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="10"></td><td><pre>        R <span class="token operator">=</span> <span class="token punctuation">[</span>r<span class="token punctuation">]</span></pre></td></tr><tr><td data-num="11"></td><td><pre>        t <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span><span class="token number">5</span> <span class="token operator">*</span> s <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span></pre></td></tr><tr><td data-num="12"></td><td><pre>        <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> t<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="13"></td><td><pre>            R<span class="token punctuation">.</span>append<span class="token punctuation">(</span>r <span class="token operator">+</span> getRandomRange<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">4</span> <span class="token operator">*</span> s <span class="token operator">**</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="14"></td><td><pre>		<span class="token triple-quoted-string string">'''</span></pre></td></tr><tr><td data-num="15"></td><td><pre>		lambda作为一个表达式，定义了一个匿名函数，a,b为函数传参，a*b为函数体</pre></td></tr><tr><td data-num="16"></td><td><pre>		reduce(function,iterable[,initializer]) 函数会对参数序列中元素进行累积。</pre></td></tr><tr><td data-num="17"></td><td><pre>		也就是对iterable可迭代对象（如列表、元组）中的第1、2个元素进行函数操作，</pre></td></tr><tr><td data-num="18"></td><td><pre>		将得到的结果与第三个元素用function运算，最后得到一个结果，如果有init参数，</pre></td></tr><tr><td data-num="19"></td><td><pre>		则先将init与第一个元素进行运算</pre></td></tr><tr><td data-num="20"></td><td><pre>		'''</pre></td></tr><tr><td data-num="21"></td><td><pre>        p <span class="token operator">=</span> <span class="token builtin">reduce</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> a<span class="token punctuation">,</span> b<span class="token punctuation">:</span> a <span class="token operator">*</span> b<span class="token punctuation">,</span> R<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span></pre></td></tr><tr><td data-num="22"></td><td><pre>        <span class="token keyword">if</span> isPrime<span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="23"></td><td><pre>            <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span><span class="token builtin">bin</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">1024</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="24"></td><td><pre>                <span class="token keyword">return</span> p</pre></td></tr><tr><td data-num="25"></td><td><pre></pre></td></tr><tr><td data-num="26"></td><td><pre><span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="27"></td><td><pre>    p <span class="token operator">=</span> gen_prime<span class="token punctuation">(</span>s<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="28"></td><td><pre>    q <span class="token operator">=</span> gen_prime<span class="token punctuation">(</span>s<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="29"></td><td><pre>    n <span class="token operator">=</span> p <span class="token operator">*</span> q</pre></td></tr><tr><td data-num="30"></td><td><pre>    e <span class="token operator">=</span> <span class="token number">65537</span></pre></td></tr><tr><td data-num="31"></td><td><pre>    d <span class="token operator">=</span> inverse<span class="token punctuation">(</span>e<span class="token punctuation">,</span> <span class="token punctuation">(</span>p<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>q<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="32"></td><td><pre>    <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span><span class="token builtin">bin</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">2048</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="33"></td><td><pre>        <span class="token keyword">break</span></pre></td></tr><tr><td data-num="34"></td><td><pre></pre></td></tr><tr><td data-num="35"></td><td><pre>msg <span class="token operator">=</span> FLAG</pre></td></tr><tr><td data-num="36"></td><td><pre>key <span class="token operator">=</span> RSA<span class="token punctuation">.</span>construct<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token builtin">long</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token builtin">long</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token builtin">long</span><span class="token punctuation">(</span>d<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token builtin">long</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token builtin">long</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="37"></td><td><pre><span class="token comment">#循环，加密 s 次</span></pre></td></tr><tr><td data-num="38"></td><td><pre><span class="token keyword">for</span> _ <span class="token keyword">in</span> <span class="token builtin">xrange</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="39"></td><td><pre>    enc <span class="token operator">=</span> key<span class="token punctuation">.</span>encrypt<span class="token punctuation">(</span>msg<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="40"></td><td><pre>    msg <span class="token operator">=</span> enc</pre></td></tr><tr><td data-num="41"></td><td><pre></pre></td></tr><tr><td data-num="42"></td><td><pre><span class="token keyword">print</span> key<span class="token punctuation">.</span>publickey<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>exportKey<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="43"></td><td><pre><span class="token keyword">print</span> <span class="token string">'-'</span> <span class="token operator">*</span> <span class="token number">76</span></pre></td></tr><tr><td data-num="44"></td><td><pre><span class="token comment">#密文 base64 加密</span></pre></td></tr><tr><td data-num="45"></td><td><pre><span class="token keyword">print</span> enc<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">'base64'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="46"></td><td><pre><span class="token keyword">print</span> <span class="token string">'-'</span> <span class="token operator">*</span> <span class="token number">76</span></pre></td></tr></table></figure><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">for</span> _ <span class="token keyword">in</span> <span class="token builtin">xrange</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="2"></td><td><pre>    enc <span class="token operator">=</span> key<span class="token punctuation">.</span>encrypt<span class="token punctuation">(</span>msg<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="3"></td><td><pre>    msg <span class="token operator">=</span> enc</pre></td></tr></table></figure><p>简而言之就是将 m 和 c 循环加密，问题是我们不知道循环了多少次</p><p>先分解 n 吧，可以分成 p、q</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre>p<span class="token operator">=</span><span class="token number">139457081371053313087662621808811891689477698775602541222732432884929677435971504758581219546068100871560676389156360422970589688848020499752936702307974617390996217688749392344211044595211963580524376876607487048719085184308509979502505202804812382023512342185380439620200563119485952705668730322944000000001</span></pre></td></tr><tr><td data-num="2"></td><td><pre>q <span class="token operator">=</span> <span class="token number">155617827023249833340719354421664777126919280716316528121008762838820577123085292134385394346751341309377546683859340593439660968379640585296350265350950535158375685103003837903550191128377455111656903429282868722284520586387794090131818535032744071918282383650099890243578253423157468632973312000000000000001</span></pre></td></tr></table></figure><p>密文 c 是 base64 加密，解密的话也很好解</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre>enc<span class="token operator">=</span><span class="token string">'eER0JNIcZYx/t+7lnRvv8s8zyMw8dYspZlne0MQUatQNcnDL/wnHtkAoNdCalQkpcbnZeAz4qeMX5GBmsO+BXyAKDueMA4uy3fw2k/dqFSsZFiB7I9M0oEkqUja52IMpkGDJ2eXGj9WHe4mqkniIayS42o4p9b0Qlz754qqRgkuaKzPWkZPKynULAtFXF39zm6dPI/jUA2BEo5WBoPzsCzwRmdr6QmJXTsau5BAQC5qdIkmCNq7+NLY1fjOmSEF/W+mdQvcwYPbe2zezroCiLiPNZnoABfmPbWAcASVU6M0YxvnXsh2YjkyLFf4cJSgroM3Aw4fVz3PPSsAQyCFKBA=='</span></pre></td></tr></table></figure><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="2"></td><td><pre>    m<span class="token operator">=</span>gmpy2<span class="token punctuation">.</span>powmod<span class="token punctuation">(</span>c<span class="token punctuation">,</span>d<span class="token punctuation">,</span>n<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="3"></td><td><pre>    c<span class="token operator">=</span>m</pre></td></tr><tr><td data-num="4"></td><td><pre>    hex_data<span class="token operator">=</span><span class="token builtin">hex</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="5"></td><td><pre>    <span class="token keyword">if</span> <span class="token string">'666c'</span> <span class="token keyword">in</span> hex_data<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="6"></td><td><pre>        <span class="token keyword">print</span><span class="token punctuation">(</span>hex_data<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="7"></td><td><pre>        flag<span class="token operator">=</span>base64<span class="token punctuation">.</span>b16decode<span class="token punctuation">(</span>hex_data<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">.</span>upper<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="8"></td><td><pre>        <span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="9"></td><td><pre>        <span class="token keyword">break</span></pre></td></tr></table></figure><p>'666c' 对应的 ascii 是 'fl'，字符里面搜索一下匹配上结束循环就解决了循环加密的问题了</p><h3 id="payload"><a class="anchor" href="#payload">#</a> payload</h3><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">import</span> gmpy2</pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">import</span> base64</pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> <span class="token operator">*</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>PublicKey <span class="token keyword">import</span> RSA</pre></td></tr><tr><td data-num="5"></td><td><pre></pre></td></tr><tr><td data-num="6"></td><td><pre>p<span class="token operator">=</span><span class="token number">139457081371053313087662621808811891689477698775602541222732432884929677435971504758581219546068100871560676389156360422970589688848020499752936702307974617390996217688749392344211044595211963580524376876607487048719085184308509979502505202804812382023512342185380439620200563119485952705668730322944000000001</span></pre></td></tr><tr><td data-num="7"></td><td><pre>q <span class="token operator">=</span> <span class="token number">155617827023249833340719354421664777126919280716316528121008762838820577123085292134385394346751341309377546683859340593439660968379640585296350265350950535158375685103003837903550191128377455111656903429282868722284520586387794090131818535032744071918282383650099890243578253423157468632973312000000000000001</span> </pre></td></tr><tr><td data-num="8"></td><td><pre>n <span class="token operator">=</span> p<span class="token operator">*</span>q</pre></td></tr><tr><td data-num="9"></td><td><pre>e <span class="token operator">=</span> <span class="token number">65537</span></pre></td></tr><tr><td data-num="10"></td><td><pre>phi<span class="token operator">=</span><span class="token punctuation">(</span>p<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>q<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="11"></td><td><pre>d<span class="token operator">=</span>gmpy2<span class="token punctuation">.</span>invert<span class="token punctuation">(</span>e<span class="token punctuation">,</span>phi<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="12"></td><td><pre></pre></td></tr><tr><td data-num="13"></td><td><pre>enc<span class="token operator">=</span><span class="token string">'eER0JNIcZYx/t+7lnRvv8s8zyMw8dYspZlne0MQUatQNcnDL/wnHtkAoNdCalQkpcbnZeAz4qeMX5GBmsO+BXyAKDueMA4uy3fw2k/dqFSsZFiB7I9M0oEkqUja52IMpkGDJ2eXGj9WHe4mqkniIayS42o4p9b0Qlz754qqRgkuaKzPWkZPKynULAtFXF39zm6dPI/jUA2BEo5WBoPzsCzwRmdr6QmJXTsau5BAQC5qdIkmCNq7+NLY1fjOmSEF/W+mdQvcwYPbe2zezroCiLiPNZnoABfmPbWAcASVU6M0YxvnXsh2YjkyLFf4cJSgroM3Aw4fVz3PPSsAQyCFKBA=='</span></pre></td></tr><tr><td data-num="14"></td><td><pre>c<span class="token operator">=</span>base64<span class="token punctuation">.</span>b64decode<span class="token punctuation">(</span>enc<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="15"></td><td><pre>c<span class="token operator">=</span>bytes_to_long<span class="token punctuation">(</span>c<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="16"></td><td><pre></pre></td></tr><tr><td data-num="17"></td><td><pre><span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="18"></td><td><pre>    m<span class="token operator">=</span>gmpy2<span class="token punctuation">.</span>powmod<span class="token punctuation">(</span>c<span class="token punctuation">,</span>d<span class="token punctuation">,</span>n<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="19"></td><td><pre>    c<span class="token operator">=</span>m</pre></td></tr><tr><td data-num="20"></td><td><pre>    hex_data<span class="token operator">=</span><span class="token builtin">hex</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="21"></td><td><pre>    <span class="token keyword">if</span> <span class="token string">'666c'</span> <span class="token keyword">in</span> hex_data<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="22"></td><td><pre>        <span class="token keyword">print</span><span class="token punctuation">(</span>hex_data<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="23"></td><td><pre>        flag<span class="token operator">=</span>base64<span class="token punctuation">.</span>b16decode<span class="token punctuation">(</span>hex_data<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">.</span>upper<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="24"></td><td><pre>        <span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="25"></td><td><pre>        <span class="token keyword">break</span></pre></td></tr></table></figure><p><img data-src="https://s3.bmp.ovh/imgs/2022/04/01/5554a3d8ef34b656.png" alt=""></p><h2 id="iscc-2017说我作弊需要证据"><a class="anchor" href="#iscc-2017说我作弊需要证据">#</a> ISCC-2017 说我作弊需要证据</h2><p>​ 题目描述：X 老师怀疑一些调皮的学生在一次自动化计算机测试中作弊，他使用抓包工具捕获到了 Alice 和 Bob 的通信流量。狡猾的 Alice 和 Bob 同学好像使用某些加密方式隐藏通信内容，使得 X 老师无法破解它，也许你有办法帮助 X 老师。X 老师知道 Alice 的 RSA 密钥为 (n, e) = (0x53a121a11e36d7a84dde3f5d73cf, 0x10001) (192.168.0.13)?,Bob 的 RSA 密钥为 (n, e) =(0x99122e61dc7bede74711185598c7, 0x10001) (192.168.0.37)</p><p><img data-src="https://s3.bmp.ovh/imgs/2022/04/02/7ed2231b7048e094.png" alt=""></p><p>看看流量包，好像有 base64 欸，加上题目里给我们的 N1、N2，和 e，N 可以分解一下吧，分以下好了。</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">#Alice's</span></pre></td></tr><tr><td data-num="2"></td><td><pre>n1 <span class="token operator">=</span> <span class="token number">1696206139052948924304948333474767</span></pre></td></tr><tr><td data-num="3"></td><td><pre>p1 <span class="token operator">=</span> <span class="token number">38456719616722997</span></pre></td></tr><tr><td data-num="4"></td><td><pre>q1 <span class="token operator">=</span> <span class="token number">44106885765559411</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token comment">#Bob's</span></pre></td></tr><tr><td data-num="6"></td><td><pre>n2 <span class="token operator">=</span> <span class="token number">3104649130901425335933838103517383</span></pre></td></tr><tr><td data-num="7"></td><td><pre>n2 <span class="token operator">=</span> <span class="token number">49662237675630289</span></pre></td></tr><tr><td data-num="8"></td><td><pre>q2 <span class="token operator">=</span> <span class="token number">62515288803124247</span></pre></td></tr></table></figure><p>也就是说少个 C 呗，不知道他们俩传的啥？其实都在流量包里。</p><p><img data-src="https://s3.bmp.ovh/imgs/2022/04/02/9c66f081520f38d8.png" alt=""></p><figure class="highlight html"><figcaption data-lang="HTML"></figcaption><table><tr><td data-num="1"></td><td><pre>SEQ = 13; DATA = 0x3b04b26a0adada2f67326bb0c5d6L; SIG = 0x2e5ab24f9dc21df406a87de0b3b4L;</pre></td></tr><tr><td data-num="2"></td><td><pre>SEQ = 0; DATA = 0x7492f4ec9001202dcb569df468b4L; SIG = 0xc9107666b1cc040a4fc2e89e3e7L;</pre></td></tr><tr><td data-num="3"></td><td><pre>SEQ = 5; DATA = 0x94d97e04f52c2d6f42f9aacbf0b5L; SIG = 0x1e3b6d4eaf11582e85ead4bf90a9L;</pre></td></tr><tr><td data-num="4"></td><td><pre>SEQ = 4; DATA = 0x2c29150f1e311ef09bc9f06735acL; SIG = 0x1665fb2da761c4de89f27ac80cbL;</pre></td></tr><tr><td data-num="5"></td><td><pre>SEQ = 18; DATA = 0x181901c059de3b0f2d4840ab3aebL; SIG = 0x1b8bdf9468f81ce33a0da2a8bfbeL;</pre></td></tr><tr><td data-num="6"></td><td><pre>SEQ = 2; DATA = 0x8a03676745df01e16745145dd212L; SIG = 0x1378c25048c19853b6817eb9363aL;</pre></td></tr><tr><td data-num="7"></td><td><pre>SEQ = 20; DATA = 0x674880905956979ce49af33433L; SIG = 0x198901d5373ea225cc5c0db66987L;</pre></td></tr><tr><td data-num="8"></td><td><pre>SEQ = 0; DATA = 0x633282273f9cf7e5a44fcbe1787bL; SIG = 0x2b15275412244442d9ee60fc91aeL;</pre></td></tr><tr><td data-num="9"></td><td><pre>SEQ = 28; DATA = 0x19688f112a61169c9090a4f9918dL; SIG = 0x1448ac6eee2b2e91a0a6241e590eL;</pre></td></tr><tr><td data-num="10"></td><td><pre>SEQ = 24; DATA = 0x59d0264d4a134fa5a91521b25e46L; SIG = 0x2bc3bf947c0e85444aa13efa1c15L;</pre></td></tr></table></figure><p>DATA 是密文，SIG 用来签名校验</p><p>然后就是，Alice 是加密方，所以我们要用 Bob 的私钥来解密。</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">import</span> gmpy2</pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> <span class="token operator">*</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">import</span> base64</pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token comment">#Alice's</span></pre></td></tr><tr><td data-num="5"></td><td><pre>n1 <span class="token operator">=</span> <span class="token number">1696206139052948924304948333474767</span></pre></td></tr><tr><td data-num="6"></td><td><pre>p1 <span class="token operator">=</span> <span class="token number">38456719616722997</span></pre></td></tr><tr><td data-num="7"></td><td><pre>q1 <span class="token operator">=</span> <span class="token number">44106885765559411</span></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token comment">#Bob's</span></pre></td></tr><tr><td data-num="9"></td><td><pre>n2 <span class="token operator">=</span> <span class="token number">3104649130901425335933838103517383</span></pre></td></tr><tr><td data-num="10"></td><td><pre>p2 <span class="token operator">=</span> <span class="token number">49662237675630289</span></pre></td></tr><tr><td data-num="11"></td><td><pre>q2 <span class="token operator">=</span> <span class="token number">62515288803124247</span></pre></td></tr><tr><td data-num="12"></td><td><pre></pre></td></tr><tr><td data-num="13"></td><td><pre>e<span class="token operator">=</span><span class="token number">65537</span></pre></td></tr><tr><td data-num="14"></td><td><pre></pre></td></tr><tr><td data-num="15"></td><td><pre>d1<span class="token operator">=</span>gmpy2<span class="token punctuation">.</span>invert<span class="token punctuation">(</span>e<span class="token punctuation">,</span><span class="token punctuation">(</span>p1<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>q1<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="16"></td><td><pre>d2<span class="token operator">=</span>gmpy2<span class="token punctuation">.</span>invert<span class="token punctuation">(</span>e<span class="token punctuation">,</span><span class="token punctuation">(</span>p2<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>q2<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="17"></td><td><pre></pre></td></tr><tr><td data-num="18"></td><td><pre>c<span class="token operator">=</span><span class="token number">0x19688f112a61169c9090a4f9918d</span></pre></td></tr><tr><td data-num="19"></td><td><pre>m <span class="token operator">=</span> gmpy2<span class="token punctuation">.</span>powmod<span class="token punctuation">(</span>c<span class="token punctuation">,</span> d2<span class="token punctuation">,</span> n2<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="20"></td><td><pre><span class="token comment">#print( long_to_bytes(m))</span></pre></td></tr><tr><td data-num="21"></td><td><pre></pre></td></tr><tr><td data-num="22"></td><td><pre><span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">r'C:\Users\lenovo\Desktop\data.txt'</span><span class="token punctuation">,</span><span class="token string">'r'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="23"></td><td><pre>    data <span class="token operator">=</span> f<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="24"></td><td><pre>cips<span class="token operator">=</span>data<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">'\n'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="25"></td><td><pre>flag<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">''</span><span class="token punctuation">]</span><span class="token operator">*</span><span class="token builtin">len</span><span class="token punctuation">(</span>cips<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="26"></td><td><pre></pre></td></tr><tr><td data-num="27"></td><td><pre><span class="token keyword">for</span> cip <span class="token keyword">in</span> cips<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="28"></td><td><pre>    data<span class="token operator">=</span><span class="token builtin">str</span><span class="token punctuation">(</span>base64<span class="token punctuation">.</span>b64decode<span class="token punctuation">(</span>cip<span class="token punctuation">)</span><span class="token punctuation">,</span>encoding<span class="token operator">=</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="29"></td><td><pre>    <span class="token keyword">print</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="30"></td><td><pre>    seq<span class="token operator">=</span><span class="token punctuation">(</span>data<span class="token punctuation">[</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token string">'= '</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">:</span>data<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token string">';'</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="31"></td><td><pre></pre></td></tr><tr><td data-num="32"></td><td><pre>    cipher<span class="token operator">=</span>data<span class="token punctuation">[</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token string">'x'</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>data<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token string">'L'</span><span class="token punctuation">)</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="33"></td><td><pre>    sig<span class="token operator">=</span>data<span class="token punctuation">[</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span>rfind<span class="token punctuation">(</span><span class="token string">'x'</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>data<span class="token punctuation">.</span>rfind<span class="token punctuation">(</span><span class="token string">'L'</span><span class="token punctuation">)</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="34"></td><td><pre>    <span class="token comment"># print(cipher)</span></pre></td></tr><tr><td data-num="35"></td><td><pre>    m<span class="token operator">=</span>gmpy2<span class="token punctuation">.</span>powmod<span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span>cipher<span class="token punctuation">,</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">,</span>d2<span class="token punctuation">,</span>n2<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="36"></td><td><pre>    <span class="token keyword">print</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="37"></td><td><pre>    <span class="token keyword">if</span> m<span class="token operator">==</span>gmpy2<span class="token punctuation">.</span>powmod<span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span>sig<span class="token punctuation">,</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">,</span>e<span class="token punctuation">,</span>n1<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="38"></td><td><pre>        flag<span class="token punctuation">[</span>seq<span class="token punctuation">]</span><span class="token operator">+=</span><span class="token builtin">chr</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="39"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span></pre></td></tr></table></figure><h2 id="卷王杯签到"><a class="anchor" href="#卷王杯签到">#</a> 卷王杯 — 签到</h2><h3 id="encryptpy"><a class="anchor" href="#encryptpy">#</a> <span class="exturl" data-url="aHR0cDovL2VuY3J5cHQucHk=">encrypt.py</span></h3><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> bytes_to_long</pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">from</span> secrets <span class="token keyword">import</span> p<span class="token punctuation">,</span>q<span class="token punctuation">,</span>r<span class="token punctuation">,</span>s<span class="token punctuation">,</span>t<span class="token punctuation">,</span>flag</pre></td></tr><tr><td data-num="3"></td><td><pre></pre></td></tr><tr><td data-num="4"></td><td><pre>n <span class="token operator">=</span> p <span class="token operator">*</span> q <span class="token operator">*</span> r <span class="token operator">*</span> s <span class="token operator">*</span> t</pre></td></tr><tr><td data-num="5"></td><td><pre>e <span class="token operator">=</span> <span class="token number">2</span></pre></td></tr><tr><td data-num="6"></td><td><pre>m <span class="token operator">=</span> bytes_to_long<span class="token punctuation">(</span>os<span class="token punctuation">.</span>urandom<span class="token punctuation">(</span><span class="token number">500</span><span class="token punctuation">)</span> <span class="token operator">+</span> flag<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="7"></td><td><pre>c <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>m<span class="token punctuation">,</span>e<span class="token punctuation">,</span>n<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="8"></td><td><pre></pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span>p<span class="token punctuation">,</span>q<span class="token punctuation">,</span>r<span class="token punctuation">,</span>s<span class="token punctuation">,</span>t<span class="token punctuation">,</span>sep<span class="token operator">=</span><span class="token string">'\n'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="11"></td><td><pre></pre></td></tr><tr><td data-num="12"></td><td><pre><span class="token triple-quoted-string string">'''</span></pre></td></tr><tr><td data-num="13"></td><td><pre>145332367700944303747548912160113939198078051436029477960348968315913956664143693347226702600438608693933768134575289286283267810723137895903153829001826223446477799895493265422562348917012216790077395795861238257357035152687833639085415763850743538206986781418939737511715957738982536382066693822159860701263</pre></td></tr><tr><td data-num="14"></td><td><pre>116660458253067608044065523310547233337730583902133756095473339390057738510707447906971188577217274861047379404014140178165569604404468897712846876108444468370709141219302291601408652742006268186059762087155933131837323952675627966299810891805398890428420575425160696531236660480933905879208166090591482794763</pre></td></tr><tr><td data-num="15"></td><td><pre>157931722402853245421436270609912823260313730941283152856444641969403238646482562190531038393124087232554754746464603598717356255570166081501573727336977292059427220330169044611674973569766966838498453232642731737958791706086957762244686953294662693939604300864961637325536379321027705854708492453330690705531</pre></td></tr><tr><td data-num="16"></td><td><pre>100973451687449518854742673778783266158999451072058606348222018797891147675959983616210003484476577612134482311993701677242007759556951494382833070563369964294544839433671087037596159753825249018950693369209927951667775267086896180395776150188902057785214767230658487267587289809918132337927575673868568976679</pre></td></tr><tr><td data-num="17"></td><td><pre>93960345071948255233882121683650797512129333868351496468898834736770441398743300745703393838320587998953678254272245400344928586394089488734271897540051673996675973642347859306921527430850673334243441180183460927865980713929789963587608547554858491264614271309608925634272282292964002897650355047792764365447</pre></td></tr><tr><td data-num="18"></td><td><pre>9144597920381774885442906257311149465702295057238600973973598305004391534618770363098565074541384771979931799878381439264848137810353858418200992191234142740194489573540381681161219332611454834544291634628456257670178843484698324641739324687497388018406214041657278323855749902661752448796122517061920880552011343608609622885787617238758769398972009949575526258430282648817039091284796330585349957724522615105102735930258969562103112238020133587096826386028128471852377225525357348919204333121695432662339443004327748973224423132988376298843862056631045488285859621661802413201793962883794915513510467912312842687601478117040419013468059983777273699192408773551806581458197324620065210523913467414181480875280203580147077789063808832356486197271376615883221558265591069223727607585313240243619515521180600435114131162272519949101464089935441251751426683447701142156416866113627126765919641034042927519834229168536331952275698122511502745177547569813354280565828372968703810158857859460406828090199683324760956105682902577189283246483314689365570862217407333103243336691401424548702387876409228977278498691200028282744239512091373110111792177228979867318546462714521296256938374618636206565791541769138267080789842400796973226733816939794717596194090232425688504890234304977612220790858557639246367437740975495450011676714198668471438814299689325208882261918460708833888406187912527346628912894921059735420931656953236560178909180587372589456926690219114173193202048332172538564489660440225377822914097420807957784201785024166011709377791129</pre></td></tr><tr><td data-num="19"></td><td><pre>'''</pre></td></tr></table></figure><p>没做出来但是我先讲一下我的思路叭。</p><p>首先看到 e=2 第一个秒想到的是 c 开方，不对。</p><p>再次就是 rabin 攻击，但这也不是普通的 rabin 啊</p><p>这个情况<strong> e | phi (n)</strong>，太怪了是不是？e 成了 phi 的因数，无法互素。之前遇到过 AMM 算法，解决的就是 e、phi 不互素问题，还能开根。好，问题来了，我不会用。。</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">import</span> random</pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> long_to_bytes</pre></td></tr><tr><td data-num="3"></td><td><pre></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">def</span> <span class="token function">AMM</span><span class="token punctuation">(</span>o<span class="token punctuation">,</span> r<span class="token punctuation">,</span> q<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="5"></td><td><pre></pre></td></tr><tr><td data-num="6"></td><td><pre>    g <span class="token operator">=</span> GF<span class="token punctuation">(</span>q<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="7"></td><td><pre>    o <span class="token operator">=</span> g<span class="token punctuation">(</span>o<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="8"></td><td><pre>    p <span class="token operator">=</span> g<span class="token punctuation">(</span>random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> q<span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="9"></td><td><pre>    <span class="token keyword">while</span> p <span class="token operator">^</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>q<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">//</span> r<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="10"></td><td><pre>        p <span class="token operator">=</span> g<span class="token punctuation">(</span>random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> q<span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="11"></td><td><pre></pre></td></tr><tr><td data-num="12"></td><td><pre>    t <span class="token operator">=</span> <span class="token number">0</span></pre></td></tr><tr><td data-num="13"></td><td><pre>    s <span class="token operator">=</span> q <span class="token operator">-</span> <span class="token number">1</span></pre></td></tr><tr><td data-num="14"></td><td><pre>    <span class="token keyword">while</span> s <span class="token operator">%</span> r <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="15"></td><td><pre>        t <span class="token operator">+=</span> <span class="token number">1</span></pre></td></tr><tr><td data-num="16"></td><td><pre>        s <span class="token operator">=</span> s <span class="token operator">//</span> r</pre></td></tr><tr><td data-num="17"></td><td><pre>    k <span class="token operator">=</span> <span class="token number">1</span></pre></td></tr><tr><td data-num="18"></td><td><pre>    <span class="token keyword">while</span> <span class="token punctuation">(</span>k <span class="token operator">*</span> s <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">%</span> r <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="19"></td><td><pre>        k <span class="token operator">+=</span> <span class="token number">1</span></pre></td></tr><tr><td data-num="20"></td><td><pre>    alp <span class="token operator">=</span> <span class="token punctuation">(</span>k <span class="token operator">*</span> s <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">//</span> r</pre></td></tr><tr><td data-num="21"></td><td><pre>    a <span class="token operator">=</span> p <span class="token operator">^</span> <span class="token punctuation">(</span>r<span class="token operator">**</span><span class="token punctuation">(</span>t<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> s<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="22"></td><td><pre>    b <span class="token operator">=</span> o <span class="token operator">^</span> <span class="token punctuation">(</span>r<span class="token operator">*</span>alp <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="23"></td><td><pre>    c <span class="token operator">=</span> p <span class="token operator">^</span> s</pre></td></tr><tr><td data-num="24"></td><td><pre>    h <span class="token operator">=</span> <span class="token number">1</span></pre></td></tr><tr><td data-num="25"></td><td><pre>    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> t<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="26"></td><td><pre>        d <span class="token operator">=</span> b <span class="token operator">^</span> <span class="token punctuation">(</span>r<span class="token operator">^</span><span class="token punctuation">(</span>t<span class="token operator">-</span><span class="token number">1</span><span class="token operator">-</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="27"></td><td><pre>        <span class="token keyword">if</span> d <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="28"></td><td><pre>            j <span class="token operator">=</span> <span class="token number">0</span></pre></td></tr><tr><td data-num="29"></td><td><pre>        <span class="token keyword">else</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="30"></td><td><pre>            j <span class="token operator">=</span> <span class="token operator">-</span> discrete_log<span class="token punctuation">(</span>d<span class="token punctuation">,</span> a<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="31"></td><td><pre>        b <span class="token operator">=</span> b <span class="token operator">*</span> <span class="token punctuation">(</span>c<span class="token operator">^</span>r<span class="token punctuation">)</span><span class="token operator">^</span>j</pre></td></tr><tr><td data-num="32"></td><td><pre>        h <span class="token operator">=</span> h <span class="token operator">*</span> c<span class="token operator">^</span>j</pre></td></tr><tr><td data-num="33"></td><td><pre>        c <span class="token operator">=</span> c<span class="token operator">^</span>r</pre></td></tr><tr><td data-num="34"></td><td><pre>    result <span class="token operator">=</span> o<span class="token operator">^</span>alp <span class="token operator">*</span> h</pre></td></tr><tr><td data-num="35"></td><td><pre>    <span class="token keyword">return</span> result</pre></td></tr><tr><td data-num="36"></td><td><pre></pre></td></tr><tr><td data-num="37"></td><td><pre><span class="token keyword">def</span> <span class="token function">findAllPRoot</span><span class="token punctuation">(</span>p<span class="token punctuation">,</span> e<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="38"></td><td><pre>    proot <span class="token operator">=</span> <span class="token builtin">set</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="39"></td><td><pre>    <span class="token keyword">while</span> <span class="token builtin">len</span><span class="token punctuation">(</span>proot<span class="token punctuation">)</span> <span class="token operator">&lt;</span> e<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="40"></td><td><pre>        proot<span class="token punctuation">.</span>add<span class="token punctuation">(</span><span class="token builtin">pow</span><span class="token punctuation">(</span>random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> p<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>p<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">//</span>e<span class="token punctuation">,</span> p<span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="41"></td><td><pre>    <span class="token keyword">return</span> proot</pre></td></tr><tr><td data-num="42"></td><td><pre></pre></td></tr><tr><td data-num="43"></td><td><pre><span class="token keyword">def</span> <span class="token function">findAllSolutions</span><span class="token punctuation">(</span>mp<span class="token punctuation">,</span> proot<span class="token punctuation">,</span> cp<span class="token punctuation">,</span> p<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="44"></td><td><pre>    all_mp <span class="token operator">=</span> <span class="token builtin">set</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="45"></td><td><pre>    <span class="token keyword">for</span> root <span class="token keyword">in</span> proot<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="46"></td><td><pre>        mp2 <span class="token operator">=</span> mp <span class="token operator">*</span> root <span class="token operator">%</span> p</pre></td></tr><tr><td data-num="47"></td><td><pre>        <span class="token keyword">assert</span><span class="token punctuation">(</span><span class="token builtin">pow</span><span class="token punctuation">(</span>mp2<span class="token punctuation">,</span> e<span class="token punctuation">,</span> p<span class="token punctuation">)</span> <span class="token operator">==</span> cp<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="48"></td><td><pre>        all_mp<span class="token punctuation">.</span>add<span class="token punctuation">(</span>mp2<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="49"></td><td><pre>    <span class="token keyword">return</span> all_mp</pre></td></tr><tr><td data-num="50"></td><td><pre></pre></td></tr><tr><td data-num="51"></td><td><pre></pre></td></tr><tr><td data-num="52"></td><td><pre>c <span class="token operator">=</span> <span class="token number">15433214846771804225704093824935372144929516863829752998270111032551363583267576397009018518790803908369965458162930857063271509296349091229352855725285388975497906340053281554202527432848881160125418406408621879995822551367228501163128699032015069585502994319524445505522625561831240862136447585120010288772692097621553249775117843166714346924868089146429002417223863834435968726551668931140147337199939823985783939085842479154589529244209712172799274024573845157268545992888944742377166586536479490962335287124809557709167220756920767331929168230518135523463578566851417486746667008938122693256033127001185017237773</span></pre></td></tr><tr><td data-num="53"></td><td><pre>p <span class="token operator">=</span> <span class="token number">0xa892eb59b175bcf896be2176598f278437fe10ef032279f06e1092143acfb3c16b31811cca5286699595c2720c652ee64f8adc92c8b16a5601dd981d6f839ce9c0513db30de88c2ec6cae1a726acbd235ea946631bde633707d766287a2f075e9aace1606bd8b4f52d4f5b87dfb81f14fbc5338004575e9430257e180a169eff</span></pre></td></tr><tr><td data-num="54"></td><td><pre>q <span class="token operator">=</span> <span class="token number">0xe3d47225b77e56129dc3fed716181845f89fa15b2eb35453ffdc0f05cdf57c0d90410911d209818e886b202bc4893ebe85a07ef670122f0e70092de1b7963c3b24a58c6a9ec9ed677db3473b1882d10d550e45c18fd57b85a70a5401a074d36760e85c7e6258f0ab08fa69cd433709910fad6e145f7b85f589e83d61d3baf6ad</span></pre></td></tr><tr><td data-num="55"></td><td><pre>n <span class="token operator">=</span> p <span class="token operator">*</span> q</pre></td></tr><tr><td data-num="56"></td><td><pre>e <span class="token operator">=</span> <span class="token number">0x3</span></pre></td></tr><tr><td data-num="57"></td><td><pre>cp <span class="token operator">=</span> c <span class="token operator">%</span> p</pre></td></tr><tr><td data-num="58"></td><td><pre>cq <span class="token operator">=</span> c <span class="token operator">%</span> q</pre></td></tr><tr><td data-num="59"></td><td><pre>mp <span class="token operator">=</span> AMM<span class="token punctuation">(</span>cp<span class="token punctuation">,</span> e<span class="token punctuation">,</span> p<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="60"></td><td><pre>mq <span class="token operator">=</span> AMM<span class="token punctuation">(</span>cq<span class="token punctuation">,</span> e<span class="token punctuation">,</span> q<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="61"></td><td><pre>p_proot <span class="token operator">=</span> findAllPRoot<span class="token punctuation">(</span>p<span class="token punctuation">,</span> e<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="62"></td><td><pre>q_proot <span class="token operator">=</span> findAllPRoot<span class="token punctuation">(</span>q<span class="token punctuation">,</span> e<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="63"></td><td><pre>mps <span class="token operator">=</span> findAllSolutions<span class="token punctuation">(</span>mp<span class="token punctuation">,</span> p_proot<span class="token punctuation">,</span> cp<span class="token punctuation">,</span> p<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="64"></td><td><pre>mqs <span class="token operator">=</span> findAllSolutions<span class="token punctuation">(</span>mq<span class="token punctuation">,</span> q_proot<span class="token punctuation">,</span> cq<span class="token punctuation">,</span> q<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="65"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"mps="</span><span class="token punctuation">,</span>mps<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="66"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"mqs="</span><span class="token punctuation">,</span>mqs<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="67"></td><td><pre></pre></td></tr><tr><td data-num="68"></td><td><pre></pre></td></tr><tr><td data-num="69"></td><td><pre>flag <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="70"></td><td><pre><span class="token keyword">for</span> mpp <span class="token keyword">in</span> mps<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="71"></td><td><pre>    <span class="token keyword">for</span> mqq <span class="token keyword">in</span> mqs<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="72"></td><td><pre>        solution <span class="token operator">=</span> CRT_list<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token builtin">int</span><span class="token punctuation">(</span>mpp<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token builtin">int</span><span class="token punctuation">(</span>mqq<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>p<span class="token punctuation">,</span> q<span class="token punctuation">]</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="73"></td><td><pre>        flag<span class="token punctuation">.</span>append<span class="token punctuation">(</span>solution<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="74"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"flag="</span><span class="token punctuation">,</span>flag<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="75"></td><td><pre></pre></td></tr><tr><td data-num="76"></td><td><pre>flag<span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">16399975821954318279221498470275521146084468474951947690849471303696067145089454840116636668718094830771604329504802271219147143674615173355400952708408746368044309638665492578797050592110356801725854406347821079081157487918992622400462465388082464774696448382685479944891218685238696458096657412926524712567669614565532058043579724279426556454939680807472739837985809673799969798738593585980694664789237839687687796230523379344762186979226349278188873930789783857039091180416888435596976167786057695368710150520870289607521049807301430045313742380064830918865207342030577149859823652984530212731974224763950142974621</span><span class="token punctuation">,</span> <span class="token number">118376620831769511477866973072371934475020796752620925673118534551164773446938312398569573679592158603383872824973732698728390995878086711747236172795750569226610200641434547443746623460729162322168208115247321277147882591962895515811370349077174567949437554802765321577395084044034054316894295810117788487548</span><span class="token punctuation">,</span> <span class="token number">2636318234956593740025392750115188144201643355150271367205885378997179090543819773476577550528375163758510881992249744774524837065489772391156037111732467139693340916788711638687169314077851149378307041485634962316435620167189448246015443556715342171784808908063399612060691731983276962947560584384335316122282037142086941835032738329850136894931990705161961038218917946748067094287897131597506323689531027690334541348560039800989704389300502732058283731159165628739251642679570408402108118104583164460322951459558839451931706278697205870900622234858961063581108199081076817814272087232781399673277754759478621882611</span><span class="token punctuation">,</span> <span class="token number">6499923879915138342858869356582590861130291995517603812052133716178234746533241737483268105124561484329319690969270714817941158351001302244375332727987416718695298178049259665052620644321602664094820510278569361228681031817116243817011512080214536206408407155105866448471154438346652800633930600912186263889013394664316661787502455744483605331139029724777749672860598784630335665820774628981390708884654060406739800168399577656663475628461891448512238948421204060693304430762642930211936422386082993349344387307942221577378260788732589892542175026796700340977171479382730295803171335098970494264976431029903834527839</span><span class="token punctuation">,</span> <span class="token number">9038736347580887208116294651480505977356892520242549511647711958794851966958323505447060125433998050906882218022887300278018435418965579910075201650274907495269211152612176575799922287905990204213405299522446763227582381644794647411659403174315339338373641745624661179320713968225376165502623845152726404589025779394696194970808455124099506923873095191936477520729599452091871779445992192681266604024563857734525193290538837872322511703407147432634320575991291892781790092162090370420611963311513027732755758650739228065261169314032678111718633554934739976611621640149523099062104079362706499829930561360922499291537</span><span class="token punctuation">,</span> <span class="token number">11675054582537480948141687401595694121558535875392820878853597337792031057502143278923637675962373214665393100015137045052543272484455352301231238762007374634962552069400888214487091601983841353591712341008081725544018001811984095657674846731030681510158450653688060791381405700208653128450184429537061720711189439915951367294363326480877271884330065100345817633275398864288774100286951011880203354034502726821475861814125144974583825096829563452945368134354706952294431534200226231378973457955367029870910501995050746240044993000766988466807885440716526472243292284427834595298981082551453845186314020310283332686600</span><span class="token punctuation">,</span> <span class="token number">7263733707082586196337236363577742140752533124284072511591452208520653308012393329156791013065158182683773756543281811626681148258124098719869582868688862509655670543827521275057260633710902988252726854583616755536040835934686930337435509751152586396503232319516213884359372514908766694515166227630003132556255806138296684909566663232020442294393639580780408201233174407870402265182983513003228058535460592987229581888590029188380615965585868385871115078413663598379924906333240549539185003834662375236874603638121907301063200147908738766059574769331994946357490108764004714664985146608744264476825743164449898076623</span><span class="token punctuation">,</span> <span class="token number">9802546174748335061594661658475657256979133649009018211187030451137270528437475097120583033374594749261336283596898397086758425326088376385569451790976353286229583518390438185804562277295290528371311643827494157534942185762365333932083400845253389528468466910035008615208932044787490059383859471870543273256268190868676218092872662611636343887127705047939136049102175075331938378808201076703103953675370390315014975010729289404039652040531124369993196705983751430468410567732687989747860544760092409620285974980918913788946108673208826985236033297470034581991940269530797517923917890872480270041779873495468562840321</span><span class="token punctuation">,</span> <span class="token number">12438864409704928801620054408590845401180777004159289578392915830134449618981294870597160583902969913019847165589148141861283262391578148776725488902708820425922924435179149824491731591373141677749618685313129119851377805929554782178098844401968731700253275818098408227269623776770767022331420056254878589378431851389931390416427533968414108847584674956348476161647974487528840699649159895902040703685309259401965643534315596506300965433953540390304244264347166489981052009770823850706222039403946411758440718325230431963729932359943137340325285183251821077623610913809109014160794894061227615398163332444829396235384</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="77"></td><td><pre></pre></td></tr><tr><td data-num="78"></td><td><pre><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="79"></td><td><pre>    <span class="token keyword">assert</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>flag<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">**</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">%</span> n <span class="token operator">==</span> c<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="80"></td><td><pre>    f <span class="token operator">=</span> long_to_bytes<span class="token punctuation">(</span>flag<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">-</span> p<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="81"></td><td><pre>    <span class="token keyword">if</span> <span class="token string">b"DAS"</span> <span class="token keyword">in</span> f<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="82"></td><td><pre>        <span class="token keyword">print</span><span class="token punctuation">(</span>f<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="83"></td><td><pre>        <span class="token keyword">break</span></pre></td></tr><tr><td data-num="84"></td><td><pre>    <span class="token keyword">else</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="85"></td><td><pre>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"No flag."</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="86"></td><td><pre>        <span class="token keyword">continue</span></pre></td></tr></table></figure><p>看看官方解释吧</p><h3 id="payload-2"><a class="anchor" href="#payload-2">#</a> payload</h3><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre>p<span class="token operator">=</span><span class="token number">145332367700944303747548912160113939198078051436029477960348968315913956664143693347226702600438608693933768134575289286283267810723137895903153829001826223446477799895493265422562348917012216790077395795861238257357035152687833639085415763850743538206986781418939737511715957738982536382066693822159860701263</span></pre></td></tr><tr><td data-num="2"></td><td><pre>q<span class="token operator">=</span><span class="token number">116660458253067608044065523310547233337730583902133756095473339390057738510707447906971188577217274861047379404014140178165569604404468897712846876108444468370709141219302291601408652742006268186059762087155933131837323952675627966299810891805398890428420575425160696531236660480933905879208166090591482794763</span></pre></td></tr><tr><td data-num="3"></td><td><pre>r<span class="token operator">=</span><span class="token number">157931722402853245421436270609912823260313730941283152856444641969403238646482562190531038393124087232554754746464603598717356255570166081501573727336977292059427220330169044611674973569766966838498453232642731737958791706086957762244686953294662693939604300864961637325536379321027705854708492453330690705531</span></pre></td></tr><tr><td data-num="4"></td><td><pre>s<span class="token operator">=</span><span class="token number">100973451687449518854742673778783266158999451072058606348222018797891147675959983616210003484476577612134482311993701677242007759556951494382833070563369964294544839433671087037596159753825249018950693369209927951667775267086896180395776150188902057785214767230658487267587289809918132337927575673868568976679</span></pre></td></tr><tr><td data-num="5"></td><td><pre>t<span class="token operator">=</span><span class="token number">93960345071948255233882121683650797512129333868351496468898834736770441398743300745703393838320587998953678254272245400344928586394089488734271897540051673996675973642347859306921527430850673334243441180183460927865980713929789963587608547554858491264614271309608925634272282292964002897650355047792764365447</span></pre></td></tr><tr><td data-num="6"></td><td><pre>c<span class="token operator">=</span><span class="token number">9144597920381774885442906257311149465702295057238600973973598305004391534618770363098565074541384771979931799878381439264848137810353858418200992191234142740194489573540381681161219332611454834544291634628456257670178843484698324641739324687497388018406214041657278323855749902661752448796122517061920880552011343608609622885787617238758769398972009949575526258430282648817039091284796330585349957724522615105102735930258969562103112238020133587096826386028128471852377225525357348919204333121695432662339443004327748973224423132988376298843862056631045488285859621661802413201793962883794915513510467912312842687601478117040419013468059983777273699192408773551806581458197324620065210523913467414181480875280203580147077789063808832356486197271376615883221558265591069223727607585313240243619515521180600435114131162272519949101464089935441251751426683447701142156416866113627126765919641034042927519834229168536331952275698122511502745177547569813354280565828372968703810158857859460406828090199683324760956105682902577189283246483314689365570862217407333103243336691401424548702387876409228977278498691200028282744239512091373110111792177228979867318546462714521296256938374618636206565791541769138267080789842400796973226733816939794717596194090232425688504890234304977612220790858557639246367437740975495450011676714198668471438814299689325208882261918460708833888406187912527346628912894921059735420931656953236560178909180587372589456926690219114173193202048332172538564489660440225377822914097420807957784201785024166011709377791129</span></pre></td></tr><tr><td data-num="7"></td><td><pre>PR<span class="token punctuation">.</span><span class="token operator">&lt;</span>x<span class="token operator">>=</span>PolynomialRing<span class="token punctuation">(</span>Zmod<span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="8"></td><td><pre>f<span class="token operator">=</span>x<span class="token operator">^</span><span class="token number">2</span><span class="token operator">-</span>c</pre></td></tr><tr><td data-num="9"></td><td><pre>aes1<span class="token operator">=</span>f<span class="token punctuation">.</span>roots<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="10"></td><td><pre>PR<span class="token punctuation">.</span><span class="token operator">&lt;</span>x<span class="token operator">>=</span>PolynomialRing<span class="token punctuation">(</span>Zmod<span class="token punctuation">(</span>q<span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="11"></td><td><pre>f<span class="token operator">=</span>x<span class="token operator">^</span><span class="token number">2</span><span class="token operator">-</span>c</pre></td></tr><tr><td data-num="12"></td><td><pre>aes2<span class="token operator">=</span>f<span class="token punctuation">.</span>roots<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="13"></td><td><pre>PR<span class="token punctuation">.</span><span class="token operator">&lt;</span>x<span class="token operator">>=</span>PolynomialRing<span class="token punctuation">(</span>Zmod<span class="token punctuation">(</span>r<span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="14"></td><td><pre>f<span class="token operator">=</span>x<span class="token operator">^</span><span class="token number">2</span><span class="token operator">-</span>c</pre></td></tr><tr><td data-num="15"></td><td><pre>aes3<span class="token operator">=</span>f<span class="token punctuation">.</span>roots<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="16"></td><td><pre>PR<span class="token punctuation">.</span><span class="token operator">&lt;</span>x<span class="token operator">>=</span>PolynomialRing<span class="token punctuation">(</span>Zmod<span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="17"></td><td><pre>f<span class="token operator">=</span>x<span class="token operator">^</span><span class="token number">2</span><span class="token operator">-</span>c</pre></td></tr><tr><td data-num="18"></td><td><pre>aes4<span class="token operator">=</span>f<span class="token punctuation">.</span>roots<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="19"></td><td><pre>PR<span class="token punctuation">.</span><span class="token operator">&lt;</span>x<span class="token operator">>=</span>PolynomialRing<span class="token punctuation">(</span>Zmod<span class="token punctuation">(</span>t<span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="20"></td><td><pre>f<span class="token operator">=</span>x<span class="token operator">^</span><span class="token number">2</span><span class="token operator">-</span>c</pre></td></tr><tr><td data-num="21"></td><td><pre>aes5<span class="token operator">=</span>f<span class="token punctuation">.</span>roots<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="22"></td><td><pre><span class="token keyword">for</span> i1 <span class="token keyword">in</span> aes1<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="23"></td><td><pre>    <span class="token keyword">for</span> i2 <span class="token keyword">in</span> aes2<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="24"></td><td><pre>        <span class="token keyword">for</span> i3 <span class="token keyword">in</span> aes3<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="25"></td><td><pre>            <span class="token keyword">for</span> i4 <span class="token keyword">in</span> aes4<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="26"></td><td><pre>                <span class="token keyword">for</span> i5 <span class="token keyword">in</span> aes5<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="27"></td><td><pre>                    m<span class="token operator">=</span><span class="token builtin">int</span><span class="token punctuation">(</span>crt<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token builtin">int</span><span class="token punctuation">(</span>i1<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token builtin">int</span><span class="token punctuation">(</span>i2<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token builtin">int</span><span class="token punctuation">(</span>i3<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token builtin">int</span><span class="token punctuation">(</span>i4<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token builtin">int</span><span class="token punctuation">(</span>i5<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span>p<span class="token punctuation">,</span>q<span class="token punctuation">,</span>r<span class="token punctuation">,</span>s<span class="token punctuation">,</span>t<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="28"></td><td><pre>                    m<span class="token operator">=</span>m<span class="token punctuation">.</span>to_bytes<span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">,</span><span class="token string">'big'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="29"></td><td><pre>                    <span class="token keyword">if</span> <span class="token string">b'ctfshow'</span><span class="token keyword">in</span> m<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="30"></td><td><pre>                        <span class="token keyword">print</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span></pre></td></tr></table></figure><p>整个有限域开方用 AMM 算法 + CRT 解的</p><p><img data-src="https://s3.bmp.ovh/imgs/2022/04/29/a2c71791f9ada903.png" alt=""></p><h1 id="背包加密"><a class="anchor" href="#背包加密">#</a> 背包加密</h1><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mtext>假定一个背包可以称重</mtext><mi>W</mi><mtext>，现在有</mtext><mi>n</mi><mtext>个物品，其重量分别为</mtext><msub><mi>a</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>a</mi><mn>2</mn></msub><mo separator="true">,</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo separator="true">,</mo><msub><mi>a</mi><mi>n</mi></msub><mspace linebreak="newline"></mspace><mtext>我们想问一下装哪些物品可以恰好使得背包装满，并且每个物品只能被装一次</mtext></mrow><annotation encoding="application/x-tex">假定一个背包可以称重 W，现在有 n 个物品，其重量分别为 a_1,a_2,...,a_n \\我们想问一下装哪些物品可以恰好使得背包装满，并且每个物品只能被装一次</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8777699999999999em;vertical-align:-.19444em"></span><span class="mord cjk_fallback">假</span><span class="mord cjk_fallback">定</span><span class="mord cjk_fallback">一</span><span class="mord cjk_fallback">个</span><span class="mord cjk_fallback">背</span><span class="mord cjk_fallback">包</span><span class="mord cjk_fallback">可</span><span class="mord cjk_fallback">以</span><span class="mord cjk_fallback">称</span><span class="mord cjk_fallback">重</span><span class="mord mathnormal" style="margin-right:.13889em">W</span><span class="mord cjk_fallback">，</span><span class="mord cjk_fallback">现</span><span class="mord cjk_fallback">在</span><span class="mord cjk_fallback">有</span><span class="mord mathnormal">n</span><span class="mord cjk_fallback">个</span><span class="mord cjk_fallback">物</span><span class="mord cjk_fallback">品</span><span class="mord cjk_fallback">，</span><span class="mord cjk_fallback">其</span><span class="mord cjk_fallback">重</span><span class="mord cjk_fallback">量</span><span class="mord cjk_fallback">分</span><span class="mord cjk_fallback">别</span><span class="mord cjk_fallback">为</span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.151392em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:.68333em;vertical-align:0"></span><span class="mord cjk_fallback">我</span><span class="mord cjk_fallback">们</span><span class="mord cjk_fallback">想</span><span class="mord cjk_fallback">问</span><span class="mord cjk_fallback">一</span><span class="mord cjk_fallback">下</span><span class="mord cjk_fallback">装</span><span class="mord cjk_fallback">哪</span><span class="mord cjk_fallback">些</span><span class="mord cjk_fallback">物</span><span class="mord cjk_fallback">品</span><span class="mord cjk_fallback">可</span><span class="mord cjk_fallback">以</span><span class="mord cjk_fallback">恰</span><span class="mord cjk_fallback">好</span><span class="mord cjk_fallback">使</span><span class="mord cjk_fallback">得</span><span class="mord cjk_fallback">背</span><span class="mord cjk_fallback">包</span><span class="mord cjk_fallback">装</span><span class="mord cjk_fallback">满</span><span class="mord cjk_fallback">，</span><span class="mord cjk_fallback">并</span><span class="mord cjk_fallback">且</span><span class="mord cjk_fallback">每</span><span class="mord cjk_fallback">个</span><span class="mord cjk_fallback">物</span><span class="mord cjk_fallback">品</span><span class="mord cjk_fallback">只</span><span class="mord cjk_fallback">能</span><span class="mord cjk_fallback">被</span><span class="mord cjk_fallback">装</span><span class="mord cjk_fallback">一</span><span class="mord cjk_fallback">次</span></span></span></span></span></p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>x</mi><mn>1</mn></msub><msub><mi>a</mi><mn>1</mn></msub><mo>+</mo><msub><mi>x</mi><mn>2</mn></msub><msub><mi>a</mi><mn>2</mn></msub><mo>+</mo><mo separator="true">,</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo separator="true">,</mo><mo>+</mo><msub><mi>x</mi><mi>n</mi></msub><msub><mi>a</mi><mi>n</mi></msub><mo>=</mo><mi>W</mi><mspace width="1em"><mo stretchy="false">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>∈</mo><mo stretchy="false">{</mo><mn>0</mn><mo separator="true">,</mo><mn>1</mn><mo stretchy="false">}</mo><mo stretchy="false">)</mo><mspace width="1em"><mtext>复杂度为</mtext><mi>O</mi><mo stretchy="false">(</mo><msup><mn>2</mn><mi>n</mi></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">x_1a_1+x_2a_2+,...,+x_na_n=W \quad (x_i \in \lbrace 0 ,1 \rbrace) \quad 复杂度为O(2^n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.73333em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.7777700000000001em;vertical-align:-.19444em"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord">+</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord">+</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.151392em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.151392em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathnormal" style="margin-right:.13889em">W</span><span class="mspace" style="margin-right:1em"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mopen">{</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord">1</span><span class="mclose">}</span><span class="mclose">)</span><span class="mspace" style="margin-right:1em"></span><span class="mord cjk_fallback">复</span><span class="mord cjk_fallback">杂</span><span class="mord cjk_fallback">度</span><span class="mord cjk_fallback">为</span><span class="mord mathnormal" style="margin-right:.02778em">O</span><span class="mopen">(</span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.7143919999999999em"><span style="top:-3.113em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></p><p>在加密时，如果我们想要加密的明文为 x，那么我们可以将其表示为 n 位二进制数，然后分别乘上 a_i 即可得到加密结果。</p><p>解密的时候当 a_i 是超递增的话就可解</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mtext>超递增是指序列满足</mtext><mspace width="1em"><msub><mi>a</mi><mi>i</mi></msub><mo>&gt;</mo><munderover><mo>∑</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mrow><mi>i</mi><mo>−</mo><mn>1</mn></mrow></munderover><msub><mi>a</mi><mi>k</mi></msub><mspace width="1em"><mtext>即第</mtext><mi>i</mi><mtext>个数大于前面所有数的和</mtext><mspace width="1em"><mtext>“后一个数比前一个数至少大一倍”</mtext></mrow><annotation encoding="application/x-tex">超递增是指序列满足 \quad a_i&gt;\sum_{k=1}^{i-1} {a_k} \quad 即第 i 个数大于前面所有数的和 \quad “后一个数比前一个数至少大一倍”</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.83333em;vertical-align:-.15em"></span><span class="mord cjk_fallback">超</span><span class="mord cjk_fallback">递</span><span class="mord cjk_fallback">增</span><span class="mord cjk_fallback">是</span><span class="mord cjk_fallback">指</span><span class="mord cjk_fallback">序</span><span class="mord cjk_fallback">列</span><span class="mord cjk_fallback">满</span><span class="mord cjk_fallback">足</span><span class="mspace" style="margin-right:1em"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:3.1137820000000005em;vertical-align:-1.302113em"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8116690000000002em"><span style="top:-1.8478869999999998em;margin-left:0"><span class="pstrut" style="height:3.05em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:.03148em">k</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.0500049999999996em"><span class="pstrut" style="height:3.05em"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.300005em;margin-left:0"><span class="pstrut" style="height:3.05em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.302113em"><span></span></span></span></span></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord"><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.33610799999999996em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:.03148em">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:1em"></span><span class="mord cjk_fallback">即</span><span class="mord cjk_fallback">第</span><span class="mord mathnormal">i</span><span class="mord cjk_fallback">个</span><span class="mord cjk_fallback">数</span><span class="mord cjk_fallback">大</span><span class="mord cjk_fallback">于</span><span class="mord cjk_fallback">前</span><span class="mord cjk_fallback">面</span><span class="mord cjk_fallback">所</span><span class="mord cjk_fallback">有</span><span class="mord cjk_fallback">数</span><span class="mord cjk_fallback">的</span><span class="mord cjk_fallback">和</span><span class="mspace" style="margin-right:1em"></span><span class="mord">“</span><span class="mord cjk_fallback">后</span><span class="mord cjk_fallback">一</span><span class="mord cjk_fallback">个</span><span class="mord cjk_fallback">数</span><span class="mord cjk_fallback">比</span><span class="mord cjk_fallback">前</span><span class="mord cjk_fallback">一</span><span class="mord cjk_fallback">个</span><span class="mord cjk_fallback">数</span><span class="mord cjk_fallback">至</span><span class="mord cjk_fallback">少</span><span class="mord cjk_fallback">大</span><span class="mord cjk_fallback">一</span><span class="mord cjk_fallback">倍</span><span class="mord">”</span></span></span></span></span></p><p>如果加密后的结果大于 an 的话，其前面的系数为必须 1 的。反之，无论如何也无法使得等式成立。因此，我们可以立马得到对应的明文。</p><p>举个例子</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mtext>有</mtext><mi>M</mi><mo>=</mo><mtext>（</mtext><mn>3</mn><mtext>，</mtext><mn>11</mn><mtext>，</mtext><mn>24</mn><mtext>，</mtext><mn>50</mn><mtext>，</mtext><mn>115</mn><mtext>）是超递增序列，</mtext><mi>S</mi><mo>=</mo><mn>142</mn><mtext>；</mtext><mspace linebreak="newline"></mspace><mtext>那么先看</mtext><mn>142</mn><mo>&gt;</mo><mn>115</mn><mtext>，输出</mtext><mn>115</mn><mtext>，此时</mtext><mi>S</mi><mtext>变为</mtext><mn>142</mn><mo>−</mo><mn>115</mn><mo>=</mo><mn>27.</mn><mspace linebreak="newline"></mspace><mtext>略过</mtext><mn>50</mn><mtext>输出</mtext><mn>24</mn><mtext>，</mtext><mi>S</mi><mtext>变为</mtext><mn>3</mn><mtext>，</mtext><mn>3</mn><mo>=</mo><mn>3</mn><mtext>输出</mtext><mn>3.</mn><mspace linebreak="newline"></mspace><mtext>则生成了二进制向量</mtext><mi>x</mi><mo>=</mo><mtext>（</mtext><mn>1</mn><mtext>，</mtext><mn>0</mn><mtext>，</mtext><mn>1</mn><mtext>，</mtext><mn>0</mn><mtext>，</mtext><mn>1</mn><mtext>）完成解密</mtext></mrow><annotation encoding="application/x-tex">有M=（3，11，24，50，115）是超递增序列，S=142；\\那么先看142&gt;115，输出115，此时S变为142-115=27.\\略过50输出24，S变为3，3=3输出3.\\则生成了二进制向量x=（1，0，1，0，1）完成解密</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.68333em;vertical-align:0"></span><span class="mord cjk_fallback">有</span><span class="mord mathnormal" style="margin-right:.10903em">M</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.68333em;vertical-align:0"></span><span class="mord cjk_fallback">（</span><span class="mord">3</span><span class="mord cjk_fallback">，</span><span class="mord">1</span><span class="mord">1</span><span class="mord cjk_fallback">，</span><span class="mord">2</span><span class="mord">4</span><span class="mord cjk_fallback">，</span><span class="mord">5</span><span class="mord">0</span><span class="mord cjk_fallback">，</span><span class="mord">1</span><span class="mord">1</span><span class="mord">5</span><span class="mord cjk_fallback">）</span><span class="mord cjk_fallback">是</span><span class="mord cjk_fallback">超</span><span class="mord cjk_fallback">递</span><span class="mord cjk_fallback">增</span><span class="mord cjk_fallback">序</span><span class="mord cjk_fallback">列</span><span class="mord cjk_fallback">，</span><span class="mord mathnormal" style="margin-right:.05764em">S</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.68333em;vertical-align:0"></span><span class="mord">1</span><span class="mord">4</span><span class="mord">2</span><span class="mord cjk_fallback">；</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:.72243em;vertical-align:-.0391em"></span><span class="mord cjk_fallback">那</span><span class="mord cjk_fallback">么</span><span class="mord cjk_fallback">先</span><span class="mord cjk_fallback">看</span><span class="mord">1</span><span class="mord">4</span><span class="mord">2</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.76666em;vertical-align:-.08333em"></span><span class="mord">1</span><span class="mord">1</span><span class="mord">5</span><span class="mord cjk_fallback">，</span><span class="mord cjk_fallback">输</span><span class="mord cjk_fallback">出</span><span class="mord">1</span><span class="mord">1</span><span class="mord">5</span><span class="mord cjk_fallback">，</span><span class="mord cjk_fallback">此</span><span class="mord cjk_fallback">时</span><span class="mord mathnormal" style="margin-right:.05764em">S</span><span class="mord cjk_fallback">变</span><span class="mord cjk_fallback">为</span><span class="mord">1</span><span class="mord">4</span><span class="mord">2</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">1</span><span class="mord">1</span><span class="mord">5</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">2</span><span class="mord">7</span><span class="mord">.</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:.68333em;vertical-align:0"></span><span class="mord cjk_fallback">略</span><span class="mord cjk_fallback">过</span><span class="mord">5</span><span class="mord">0</span><span class="mord cjk_fallback">输</span><span class="mord cjk_fallback">出</span><span class="mord">2</span><span class="mord">4</span><span class="mord cjk_fallback">，</span><span class="mord mathnormal" style="margin-right:.05764em">S</span><span class="mord cjk_fallback">变</span><span class="mord cjk_fallback">为</span><span class="mord">3</span><span class="mord cjk_fallback">，</span><span class="mord">3</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.68333em;vertical-align:0"></span><span class="mord">3</span><span class="mord cjk_fallback">输</span><span class="mord cjk_fallback">出</span><span class="mord">3</span><span class="mord">.</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:.68333em;vertical-align:0"></span><span class="mord cjk_fallback">则</span><span class="mord cjk_fallback">生</span><span class="mord cjk_fallback">成</span><span class="mord cjk_fallback">了</span><span class="mord cjk_fallback">二</span><span class="mord cjk_fallback">进</span><span class="mord cjk_fallback">制</span><span class="mord cjk_fallback">向</span><span class="mord cjk_fallback">量</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.68333em;vertical-align:0"></span><span class="mord cjk_fallback">（</span><span class="mord">1</span><span class="mord cjk_fallback">，</span><span class="mord">0</span><span class="mord cjk_fallback">，</span><span class="mord">1</span><span class="mord cjk_fallback">，</span><span class="mord">0</span><span class="mord cjk_fallback">，</span><span class="mord">1</span><span class="mord cjk_fallback">）</span><span class="mord cjk_fallback">完</span><span class="mord cjk_fallback">成</span><span class="mord cjk_fallback">解</span><span class="mord cjk_fallback">密</span></span></span></span></span></p><p>想要解密就必须要找到一个合法的 x，它的和等于 S</p><p>为了起到添加陷门信息的作用，下面两个人出场了</p><h2 id="merklehellman"><a class="anchor" href="#merklehellman">#</a> Merkle–Hellman</h2><p>我们可以使用初始的背包集作为私钥，变换后的背包集作为公钥保证传递的安全性</p><h3 id="生成私钥"><a class="anchor" href="#生成私钥">#</a> 生成私钥</h3><p>使用超递增序列：假设 a1=1，那么 a2 大于 1 以此依次生成后面的值。</p><h3 id="生成公钥"><a class="anchor" href="#生成公钥">#</a> 生成公钥</h3><p>主要使用模乘</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mtext>首先生成模乘的模数</mtext><mi>m</mi><mspace width="1em"><mi>m</mi><mo>&gt;</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mrow><mi>i</mi><mo>=</mo><mi>n</mi></mrow></munderover><msub><mi>a</mi><mi>i</mi></msub><mspace linebreak="newline"></mspace><mtext>其次，选择模乘的乘数</mtext><mi>w</mi><mtext>作为私钥使得</mtext><mi>g</mi><mi>c</mi><mi>d</mi><mo stretchy="false">(</mo><mi>w</mi><mo separator="true">,</mo><mi>m</mi><mo stretchy="false">)</mo><mo>=</mo><mn>1</mn><mspace linebreak="newline"></mspace><mtext>通过</mtext><mspace width="1em"><msub><mi>b</mi><mi>i</mi></msub><mo>≡</mo><mi>w</mi><msub><mi>a</mi><mi>i</mi></msub><mi>m</mi><mi>o</mi><mi>d</mi><mi>m</mi><mspace width="1em"><mtext>生成公钥，并将新的背包集</mtext><msub><mi>b</mi><mi>i</mi></msub><mtext>和</mtext><mi>m</mi><mtext>作为公钥</mtext></mrow><annotation encoding="application/x-tex">首先生成模乘的模数m \quad m&gt; \sum _{i=1}^{i=n}a_i \\ 其次，选择模乘的乘数w作为私钥使得gcd(w,m)=1\\通过 \quad b_i \equiv wa_imodm \quad 生成公钥，并将新的背包集b_i和m作为公钥</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.72243em;vertical-align:-.0391em"></span><span class="mord cjk_fallback">首</span><span class="mord cjk_fallback">先</span><span class="mord cjk_fallback">生</span><span class="mord cjk_fallback">成</span><span class="mord cjk_fallback">模</span><span class="mord cjk_fallback">乘</span><span class="mord cjk_fallback">的</span><span class="mord cjk_fallback">模</span><span class="mord cjk_fallback">数</span><span class="mord mathnormal">m</span><span class="mspace" style="margin-right:1em"></span><span class="mord mathnormal">m</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:3.089338em;vertical-align:-1.277669em"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8116690000000002em"><span style="top:-1.872331em;margin-left:0"><span class="pstrut" style="height:3.05em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.050005em"><span class="pstrut" style="height:3.05em"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3000050000000005em;margin-left:0"><span class="pstrut" style="height:3.05em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.277669em"><span></span></span></span></span></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord cjk_fallback">其</span><span class="mord cjk_fallback">次</span><span class="mord cjk_fallback">，</span><span class="mord cjk_fallback">选</span><span class="mord cjk_fallback">择</span><span class="mord cjk_fallback">模</span><span class="mord cjk_fallback">乘</span><span class="mord cjk_fallback">的</span><span class="mord cjk_fallback">乘</span><span class="mord cjk_fallback">数</span><span class="mord mathnormal" style="margin-right:.02691em">w</span><span class="mord cjk_fallback">作</span><span class="mord cjk_fallback">为</span><span class="mord cjk_fallback">私</span><span class="mord cjk_fallback">钥</span><span class="mord cjk_fallback">使</span><span class="mord cjk_fallback">得</span><span class="mord mathnormal" style="margin-right:.03588em">g</span><span class="mord mathnormal">c</span><span class="mord mathnormal">d</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:.02691em">w</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord mathnormal">m</span><span class="mclose">)</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">1</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:.84444em;vertical-align:-.15em"></span><span class="mord cjk_fallback">通</span><span class="mord cjk_fallback">过</span><span class="mspace" style="margin-right:1em"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">≡</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.84444em;vertical-align:-.15em"></span><span class="mord mathnormal" style="margin-right:.02691em">w</span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mord mathnormal">m</span><span class="mspace" style="margin-right:1em"></span><span class="mord cjk_fallback">生</span><span class="mord cjk_fallback">成</span><span class="mord cjk_fallback">公</span><span class="mord cjk_fallback">钥</span><span class="mord cjk_fallback">，</span><span class="mord cjk_fallback">并</span><span class="mord cjk_fallback">将</span><span class="mord cjk_fallback">新</span><span class="mord cjk_fallback">的</span><span class="mord cjk_fallback">背</span><span class="mord cjk_fallback">包</span><span class="mord cjk_fallback">集</span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord cjk_fallback">和</span><span class="mord mathnormal">m</span><span class="mord cjk_fallback">作</span><span class="mord cjk_fallback">为</span><span class="mord cjk_fallback">公</span><span class="mord cjk_fallback">钥</span></span></span></span></span></p><h3 id="加密"><a class="anchor" href="#加密">#</a> 加密</h3><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mtext>假设加密明文为</mtext><mi>v</mi><mo separator="true">,</mo><mtext>其每一个比特位为</mtext><msub><mi>v</mi><mi>i</mi></msub><mtext>，那么我们加密的结果为</mtext><mspace width="1em"><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mrow><mi>i</mi><mo>=</mo><mi>n</mi></mrow></munderover><msub><mi>b</mi><mi>i</mi></msub><msub><mi>v</mi><mi>i</mi></msub><mi>m</mi><mi>o</mi><mi>d</mi><mi>m</mi></mrow><annotation encoding="application/x-tex">假设加密明文为v,其每一个比特位为 v_i，那么我们加密的结果为 \quad \sum _{i=1}^{i=n}b_iv_imodm</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:3.089338em;vertical-align:-1.277669em"></span><span class="mord cjk_fallback">假</span><span class="mord cjk_fallback">设</span><span class="mord cjk_fallback">加</span><span class="mord cjk_fallback">密</span><span class="mord cjk_fallback">明</span><span class="mord cjk_fallback">文</span><span class="mord cjk_fallback">为</span><span class="mord mathnormal" style="margin-right:.03588em">v</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord cjk_fallback">其</span><span class="mord cjk_fallback">每</span><span class="mord cjk_fallback">一</span><span class="mord cjk_fallback">个</span><span class="mord cjk_fallback">比</span><span class="mord cjk_fallback">特</span><span class="mord cjk_fallback">位</span><span class="mord cjk_fallback">为</span><span class="mord"><span class="mord mathnormal" style="margin-right:.03588em">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord cjk_fallback">，</span><span class="mord cjk_fallback">那</span><span class="mord cjk_fallback">么</span><span class="mord cjk_fallback">我</span><span class="mord cjk_fallback">们</span><span class="mord cjk_fallback">加</span><span class="mord cjk_fallback">密</span><span class="mord cjk_fallback">的</span><span class="mord cjk_fallback">结</span><span class="mord cjk_fallback">果</span><span class="mord cjk_fallback">为</span><span class="mspace" style="margin-right:1em"></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8116690000000002em"><span style="top:-1.872331em;margin-left:0"><span class="pstrut" style="height:3.05em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.050005em"><span class="pstrut" style="height:3.05em"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3000050000000005em;margin-left:0"><span class="pstrut" style="height:3.05em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.277669em"><span></span></span></span></span></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:.03588em">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mord mathnormal">m</span></span></span></span></span></p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">def</span> <span class="token function">encrypt</span><span class="token punctuation">(</span>msg<span class="token punctuation">,</span> pubKey<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="2"></td><td><pre>    msg_bit <span class="token operator">=</span> msg</pre></td></tr><tr><td data-num="3"></td><td><pre>    n <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>pubKey<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="4"></td><td><pre>    cipher <span class="token operator">=</span> <span class="token number">0</span></pre></td></tr><tr><td data-num="5"></td><td><pre>    i <span class="token operator">=</span> <span class="token number">0</span></pre></td></tr><tr><td data-num="6"></td><td><pre>    <span class="token keyword">for</span> bit <span class="token keyword">in</span> msg_bit<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="7"></td><td><pre>        cipher <span class="token operator">+=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>bit<span class="token punctuation">)</span><span class="token operator">*</span>pubKey<span class="token punctuation">[</span>i<span class="token punctuation">]</span></pre></td></tr><tr><td data-num="8"></td><td><pre>        i <span class="token operator">+=</span> <span class="token number">1</span></pre></td></tr><tr><td data-num="9"></td><td><pre>    <span class="token keyword">return</span> <span class="token builtin">bin</span><span class="token punctuation">(</span>cipher<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token punctuation">]</span></pre></td></tr></table></figure><h3 id="解密"><a class="anchor" href="#解密">#</a> 解密</h3><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mtext>首先可以求</mtext><mi>w</mi><mtext>关于</mtext><mi>m</mi><mtext>的逆元</mtext><msup><mi>w</mi><mrow><mtext>−</mtext><mn>1</mn></mrow></msup><mspace width="1em"><mtext>然后将得到的密文乘以</mtext><msup><mi>w</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mtext>即可得到明文</mtext><mspace linebreak="newline"></mspace><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mrow><mi>i</mi><mo>=</mo><mi>n</mi></mrow></munderover><msup><mi>w</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><msub><mi>b</mi><mi>i</mi></msub><msub><mi>v</mi><mi>i</mi></msub><mi>m</mi><mi>o</mi><mi>d</mi><mi>m</mi><mo>=</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mrow><mi>i</mi><mo>=</mo><mi>n</mi></mrow></munderover><msub><mi>a</mi><mi>i</mi></msub><msub><mi>v</mi><mi>i</mi></msub><mi>m</mi><mi>o</mi><mi>d</mi><mi>m</mi><mspace linebreak="newline"></mspace><mtext>且</mtext><msub><mi>b</mi><mi>i</mi></msub><mo>≡</mo><mi>w</mi><msub><mi>a</mi><mi>i</mi></msub><mi>m</mi><mi>o</mi><mi>d</mi><mi>m</mi><mspace width="1em"><mtext>每一块的加密的消息都是小于</mtext><mi>m</mi><mtext>的</mtext></mrow><annotation encoding="application/x-tex">首先可以求w 关于 m 的逆元 w^{−1} \quad 然后将得到的密文乘以 w^{-1} 即可得到明文\\\sum_{i=1}^{i=n}w^{-1}b_iv_imodm=\sum_{i=1}^{i=n}a_iv_imodm\\且b_i \equiv wa_imodm \quad 每一块的加密的消息都是小于 m 的</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.864108em;vertical-align:0"></span><span class="mord cjk_fallback">首</span><span class="mord cjk_fallback">先</span><span class="mord cjk_fallback">可</span><span class="mord cjk_fallback">以</span><span class="mord cjk_fallback">求</span><span class="mord mathnormal" style="margin-right:.02691em">w</span><span class="mord cjk_fallback">关</span><span class="mord cjk_fallback">于</span><span class="mord mathnormal">m</span><span class="mord cjk_fallback">的</span><span class="mord cjk_fallback">逆</span><span class="mord cjk_fallback">元</span><span class="mord"><span class="mord mathnormal" style="margin-right:.02691em">w</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.864108em"><span style="top:-3.113em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:1em"></span><span class="mord cjk_fallback">然</span><span class="mord cjk_fallback">后</span><span class="mord cjk_fallback">将</span><span class="mord cjk_fallback">得</span><span class="mord cjk_fallback">到</span><span class="mord cjk_fallback">的</span><span class="mord cjk_fallback">密</span><span class="mord cjk_fallback">文</span><span class="mord cjk_fallback">乘</span><span class="mord cjk_fallback">以</span><span class="mord"><span class="mord mathnormal" style="margin-right:.02691em">w</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.864108em"><span style="top:-3.113em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mord cjk_fallback">即</span><span class="mord cjk_fallback">可</span><span class="mord cjk_fallback">得</span><span class="mord cjk_fallback">到</span><span class="mord cjk_fallback">明</span><span class="mord cjk_fallback">文</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:3.089338em;vertical-align:-1.277669em"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8116690000000002em"><span style="top:-1.872331em;margin-left:0"><span class="pstrut" style="height:3.05em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.050005em"><span class="pstrut" style="height:3.05em"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3000050000000005em;margin-left:0"><span class="pstrut" style="height:3.05em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.277669em"><span></span></span></span></span></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.02691em">w</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.864108em"><span style="top:-3.113em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:.03588em">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mord mathnormal">m</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:3.089338em;vertical-align:-1.277669em"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8116690000000002em"><span style="top:-1.872331em;margin-left:0"><span class="pstrut" style="height:3.05em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.050005em"><span class="pstrut" style="height:3.05em"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3000050000000005em;margin-left:0"><span class="pstrut" style="height:3.05em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.277669em"><span></span></span></span></span></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:.03588em">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mord mathnormal">m</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:.84444em;vertical-align:-.15em"></span><span class="mord cjk_fallback">且</span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">≡</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.84444em;vertical-align:-.15em"></span><span class="mord mathnormal" style="margin-right:.02691em">w</span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mord mathnormal">m</span><span class="mspace" style="margin-right:1em"></span><span class="mord cjk_fallback">每</span><span class="mord cjk_fallback">一</span><span class="mord cjk_fallback">块</span><span class="mord cjk_fallback">的</span><span class="mord cjk_fallback">加</span><span class="mord cjk_fallback">密</span><span class="mord cjk_fallback">的</span><span class="mord cjk_fallback">消</span><span class="mord cjk_fallback">息</span><span class="mord cjk_fallback">都</span><span class="mord cjk_fallback">是</span><span class="mord cjk_fallback">小</span><span class="mord cjk_fallback">于</span><span class="mord mathnormal">m</span><span class="mord cjk_fallback">的</span></span></span></span></span></p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">import</span> binascii</pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token comment"># open the public key and strip the spaces so we have a decent array</span></pre></td></tr><tr><td data-num="3"></td><td><pre>fileKey <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"pub.Key"</span><span class="token punctuation">,</span> <span class="token string">'rb'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="4"></td><td><pre>pubKey <span class="token operator">=</span> fileKey<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">' '</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">'L'</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token string">'[]'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">','</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="5"></td><td><pre>nbit <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>pubKey<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token comment"># open the encoded message</span></pre></td></tr><tr><td data-num="7"></td><td><pre>fileEnc <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"enc.txt"</span><span class="token punctuation">,</span> <span class="token string">'rb'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="8"></td><td><pre>encoded <span class="token operator">=</span> fileEnc<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">'L'</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token keyword">print</span> <span class="token string">"start"</span></pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token comment"># create a large matrix of 0's (dimensions are public key length +1)</span></pre></td></tr><tr><td data-num="11"></td><td><pre>A <span class="token operator">=</span> Matrix<span class="token punctuation">(</span>ZZ<span class="token punctuation">,</span> nbit <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> nbit <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="12"></td><td><pre><span class="token comment"># fill in the identity matrix</span></pre></td></tr><tr><td data-num="13"></td><td><pre><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">xrange</span><span class="token punctuation">(</span>nbit<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="14"></td><td><pre>    A<span class="token punctuation">[</span>i<span class="token punctuation">,</span> i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span></pre></td></tr><tr><td data-num="15"></td><td><pre><span class="token comment"># replace the bottom row with your public key</span></pre></td></tr><tr><td data-num="16"></td><td><pre><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">xrange</span><span class="token punctuation">(</span>nbit<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="17"></td><td><pre>    A<span class="token punctuation">[</span>i<span class="token punctuation">,</span> nbit<span class="token punctuation">]</span> <span class="token operator">=</span> pubKey<span class="token punctuation">[</span>i<span class="token punctuation">]</span></pre></td></tr><tr><td data-num="18"></td><td><pre><span class="token comment"># last element is the encoded message</span></pre></td></tr><tr><td data-num="19"></td><td><pre>A<span class="token punctuation">[</span>nbit<span class="token punctuation">,</span> nbit<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token operator">-</span><span class="token builtin">int</span><span class="token punctuation">(</span>encoded<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="20"></td><td><pre></pre></td></tr><tr><td data-num="21"></td><td><pre>res <span class="token operator">=</span> A<span class="token punctuation">.</span>LLL<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="22"></td><td><pre><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> nbit <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="23"></td><td><pre>    <span class="token comment"># print solution</span></pre></td></tr><tr><td data-num="24"></td><td><pre>    M <span class="token operator">=</span> res<span class="token punctuation">.</span>row<span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">list</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="25"></td><td><pre>    flag <span class="token operator">=</span> <span class="token boolean">True</span></pre></td></tr><tr><td data-num="26"></td><td><pre>    <span class="token keyword">for</span> m <span class="token keyword">in</span> M<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="27"></td><td><pre>        <span class="token keyword">if</span> m <span class="token operator">!=</span> <span class="token number">0</span> <span class="token keyword">and</span> m <span class="token operator">!=</span> <span class="token number">1</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="28"></td><td><pre>            flag <span class="token operator">=</span> <span class="token boolean">False</span></pre></td></tr><tr><td data-num="29"></td><td><pre>            <span class="token keyword">break</span></pre></td></tr><tr><td data-num="30"></td><td><pre>    <span class="token keyword">if</span> flag<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="31"></td><td><pre>        <span class="token keyword">print</span> i<span class="token punctuation">,</span> M</pre></td></tr><tr><td data-num="32"></td><td><pre>        M <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>j<span class="token punctuation">)</span> <span class="token keyword">for</span> j <span class="token keyword">in</span> M<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="33"></td><td><pre>        <span class="token comment"># remove the last bit</span></pre></td></tr><tr><td data-num="34"></td><td><pre>        M <span class="token operator">=</span> M<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="35"></td><td><pre>        M <span class="token operator">=</span> <span class="token builtin">hex</span><span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span>M<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="36"></td><td><pre>        <span class="token keyword">print</span> M</pre></td></tr></table></figure><p>这套公钥加密体系，被称为子集和密码系统，或称背包密码。其核心思想是生成一个超级递增序列，然后用模线性运算进行混淆，将混淆之后的序列作为公钥。背包密码体制是 Merkle 和 Hellman1978 年提出，但随即两年后改体制就被破解，破解思想是不比找出正确的模数 m 和乘数 w，只需要找出任意模数 m' 和乘数 w' 再去乘公开的背包向量，能够产生超递增的背包向量即可</p><h1 id="国密"><a class="anchor" href="#国密">#</a> 国密</h1><h2 id="sm1"><a class="anchor" href="#sm1">#</a> SM1</h2><p>SM1 为对称加密，密钥长度和分组长度均为 128 位。其加密强度与 AES 相当。该算法不公开，调用该算法时，需要通过加密芯片的接口进行调用。</p><p>继续刷攻防世界的题，我发现这里的密码题比 buu 里的要难不少，才第 2 页就已经 5 星往上了，很巴适。</p><h3 id="smpy"><a class="anchor" href="#smpy">#</a> <span class="exturl" data-url="aHR0cDovL3NtLnB5">sm.py</span></h3><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> getPrime<span class="token punctuation">,</span>long_to_bytes<span class="token punctuation">,</span>bytes_to_long</pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Cipher <span class="token keyword">import</span> AES</pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">import</span> hashlib</pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">from</span> random <span class="token keyword">import</span> randint</pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token keyword">def</span> <span class="token function">gen512num</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="6"></td><td><pre>    order<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="7"></td><td><pre>    <span class="token keyword">while</span> <span class="token builtin">len</span><span class="token punctuation">(</span>order<span class="token punctuation">)</span><span class="token operator">!=</span><span class="token number">512</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="8"></td><td><pre>        tmp<span class="token operator">=</span>randint<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">512</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="9"></td><td><pre>        <span class="token keyword">if</span> tmp <span class="token keyword">not</span> <span class="token keyword">in</span> order<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="10"></td><td><pre>            order<span class="token punctuation">.</span>append<span class="token punctuation">(</span>tmp<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="11"></td><td><pre>    ps<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="12"></td><td><pre>    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">512</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="13"></td><td><pre>        p<span class="token operator">=</span>getPrime<span class="token punctuation">(</span><span class="token number">512</span><span class="token operator">-</span>order<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">+</span><span class="token number">10</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="14"></td><td><pre>        pre<span class="token operator">=</span><span class="token builtin">bin</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">:</span><span class="token punctuation">(</span><span class="token number">512</span><span class="token operator">-</span>order<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token operator">+</span><span class="token string">"1"</span></pre></td></tr><tr><td data-num="15"></td><td><pre>        ps<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span>pre<span class="token operator">+</span><span class="token string">"0"</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token number">512</span><span class="token operator">-</span><span class="token builtin">len</span><span class="token punctuation">(</span>pre<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="16"></td><td><pre>    <span class="token keyword">return</span> ps</pre></td></tr><tr><td data-num="17"></td><td><pre></pre></td></tr><tr><td data-num="18"></td><td><pre><span class="token keyword">def</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="19"></td><td><pre>    choose<span class="token operator">=</span>getPrime<span class="token punctuation">(</span><span class="token number">512</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="20"></td><td><pre>    ps<span class="token operator">=</span>gen512num<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="21"></td><td><pre>    <span class="token keyword">print</span> <span class="token string">"gen over"</span></pre></td></tr><tr><td data-num="22"></td><td><pre>    bchoose<span class="token operator">=</span><span class="token builtin">bin</span><span class="token punctuation">(</span>choose<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="23"></td><td><pre>    r<span class="token operator">=</span><span class="token number">0</span></pre></td></tr><tr><td data-num="24"></td><td><pre>    bchoose <span class="token operator">=</span> <span class="token string">"0"</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token number">512</span><span class="token operator">-</span><span class="token builtin">len</span><span class="token punctuation">(</span>bchoose<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">+</span>bchoose</pre></td></tr><tr><td data-num="25"></td><td><pre>    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">512</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="26"></td><td><pre>        <span class="token keyword">if</span> bchoose<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">==</span><span class="token string">'1'</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="27"></td><td><pre>            r<span class="token operator">=</span>r<span class="token operator">^</span>ps<span class="token punctuation">[</span>i<span class="token punctuation">]</span></pre></td></tr><tr><td data-num="28"></td><td><pre>    flag<span class="token operator">=</span><span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"flag"</span><span class="token punctuation">,</span><span class="token string">"r"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="29"></td><td><pre></pre></td></tr><tr><td data-num="30"></td><td><pre>    key<span class="token operator">=</span>long_to_bytes<span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span>hashlib<span class="token punctuation">.</span>md5<span class="token punctuation">(</span>long_to_bytes<span class="token punctuation">(</span>choose<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>hexdigest<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="31"></td><td><pre>    aes_obj <span class="token operator">=</span> AES<span class="token punctuation">.</span>new<span class="token punctuation">(</span>key<span class="token punctuation">,</span> AES<span class="token punctuation">.</span>MODE_ECB<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="32"></td><td><pre>    ef<span class="token operator">=</span>aes_obj<span class="token punctuation">.</span>encrypt<span class="token punctuation">(</span>flag<span class="token punctuation">)</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">"base64"</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="33"></td><td><pre></pre></td></tr><tr><td data-num="34"></td><td><pre>    <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"r"</span><span class="token punctuation">,</span> <span class="token string">"w"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>r<span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="35"></td><td><pre>    <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"ef"</span><span class="token punctuation">,</span><span class="token string">"w"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>write<span class="token punctuation">(</span>ef<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="36"></td><td><pre>    gg<span class="token operator">=</span><span class="token string">""</span></pre></td></tr><tr><td data-num="37"></td><td><pre>    <span class="token keyword">for</span> p <span class="token keyword">in</span> ps<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="38"></td><td><pre>        gg<span class="token operator">+=</span><span class="token builtin">str</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">"\n"</span></pre></td></tr><tr><td data-num="39"></td><td><pre>    <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"ps"</span><span class="token punctuation">,</span><span class="token string">"w"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>write<span class="token punctuation">(</span>gg<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="40"></td><td><pre></pre></td></tr><tr><td data-num="41"></td><td><pre>run<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr></table></figure><p>并且附带了三个 txt</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">#ef</span></pre></td></tr><tr><td data-num="2"></td><td><pre>5eFo3ANg2fu9LRrFktWCJmVvx6RgBFzd0R8GXQ8JD78<span class="token operator">=</span></pre></td></tr><tr><td data-num="3"></td><td><pre></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token comment">#ps</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token number">12269477678599067519781256001818656329041551919143463830255138003182266704954352654920586885461104156925850407559021549528473021568243699272802197032665088</span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token number">12014727898312193267046055214060352802848921408918989730190683994036519370635023422596726701736804151479296679824304931954850976170838814845998112601800704</span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token number">9976331664429440060604845605243289732145662105018529082352225988075436122690201079192471745138682281749114251004821906977023803364650166488174264414371840</span></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token number">10403095102483566595716972508973051993255031477875636711702665373897460658213382301738287363537278081617423984664147130692144766769696306426472874358341632</span></pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token number">9935007444417122587828364319155259331422002760411169639614085926257125957289535387056039742077708823587484732619886478426046889352924701091181760853573632</span></pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token number">7816144451280221903045360686214708219123150580962711278805529207058066513313564034005865141540085194928850852259717606430081426247608273668550963327139840</span></pre></td></tr><tr><td data-num="11"></td><td><pre><span class="token number">12517448852230644543843194839452290981564805133542790216654745790268956278736772213561347159059078752045194109348946202792424835520299443538300142111162368</span></pre></td></tr><tr><td data-num="12"></td><td><pre><span class="token number">6789768146601458580589760600312758450701175172925541910997361627318269175816973906065173149393133804600948959104778828100004827313659377930320385195114496</span></pre></td></tr><tr><td data-num="13"></td><td><pre><span class="token number">8624404263723758129304199617536652852633986553875479275646179962368437825733711233129564473452692686422337758131596971267505467316197182315914355117564944</span></pre></td></tr><tr><td data-num="14"></td><td><pre><span class="token number">8559840094531596332946739089086545151599481121791025432208006961271455171540222994745321623482262271559943420731595676441376359208549675343226242909339648</span></pre></td></tr><tr><td data-num="15"></td><td><pre><span class="token number">6926126029730957418456137043360565121684145914641861486207124482231117881086559037064552963245530467008947891458682886428809882319459128341743705694142464</span></pre></td></tr><tr><td data-num="16"></td><td><pre><span class="token number">10997925984049192307339458336239986926295720310891432202069443289762945918727532734418050714064653027376329869372832544953496155101931061855255596598158016</span></pre></td></tr><tr><td data-num="17"></td><td><pre><span class="token number">12511941558854323325222072645706387918957199910524177276675347649438259153418331785744702413228028807937738592540253173338549970827817815597301399029809152</span></pre></td></tr><tr><td data-num="18"></td><td><pre><span class="token number">8124775960528718848833072854507558589293197110878856227449619954619501764995170037041995372597725216427602460805063384996150356624477459859583478177726464</span></pre></td></tr><tr><td data-num="19"></td><td><pre><span class="token number">7133494434906424803598366820528083453875037448763236640891176300757659237397412334675671120425494123377975279108545831814714207728133901568060841089040384</span></pre></td></tr><tr><td data-num="20"></td><td><pre><span class="token number">12886267646319573718833710925971341144530912979850023434953976446069299395642673444496033346019456835340496082788825446022310838978207194500322622057742336</span></pre></td></tr><tr><td data-num="21"></td><td><pre><span class="token number">13247053777060823638501536868414978922627294773882381071342105304292901325917600611701971635776630804195035683992920602320903899546059535084565462308093952</span></pre></td></tr><tr><td data-num="22"></td><td><pre><span class="token number">8039346969181209121545296348525604261962892631469173126458058793733782243091491694067276670887848146082468206916532031345992862828007076307708728422957056</span></pre></td></tr><tr><td data-num="23"></td><td><pre><span class="token number">7497693206105230439770126263364391614417834917569846932277971265409692068412929734786347003366855217087174226963131926690678571741118381810299410380226560</span></pre></td></tr><tr><td data-num="24"></td><td><pre><span class="token number">12546933311156552869703832118462665998177407938181409691735083101909018447031324030568658004231184098223678075937764742237430961697624521858718967546249216</span></pre></td></tr><tr><td data-num="25"></td><td><pre><span class="token number">8112064310331576963405160611632806992347550876641031309955302774748802683934962987894561482775815905542658127319085631490955167032011584382359881664954368</span></pre></td></tr><tr><td data-num="26"></td><td><pre><span class="token number">9397616884187166855269904307161954002744228832732212153178563290015283802477288654530810934676576244903011236937002033622912454704413614211733152501596160</span></pre></td></tr><tr><td data-num="27"></td><td><pre><span class="token number">7735951984042241855941767883847649747678856368220664859893795390166676191278561774856787423374615206955484619204027412670599244002776336946318843075100672</span></pre></td></tr><tr><td data-num="28"></td><td><pre><span class="token number">8005630214146619055663297226846917321520895320401904746592607177479724309153470184655824281365809531138120304269859347786199616766400315161333532381413376</span></pre></td></tr><tr><td data-num="29"></td><td><pre><span class="token number">7656052656794532137568115902700987207716560072900659942851655028472117429208730906342606463386292661937197018712388611701826202755780359524305317581029376</span></pre></td></tr><tr><td data-num="30"></td><td><pre><span class="token number">12245963042950438210111759352728138923374588698420633834241639378503761543884219793213593763988139100913754039865616138681288824739278749905766387420233728</span></pre></td></tr><tr><td data-num="31"></td><td><pre><span class="token number">10285141464717338743933615711584183433033727754279597020638992436765795250979525104509150691191227650047401432451553424365400857559804094345331915412733952</span></pre></td></tr><tr><td data-num="32"></td><td><pre><span class="token number">12685424337152851050120169001382095775137028728632722137145913366767301087682336621333117468063896241502438202783329164074393893888762160386229584355393536</span></pre></td></tr><tr><td data-num="33"></td><td><pre><span class="token number">11312837940889066302765583592236182670060714911124831912454254968140238400374555261676581439078324767113464380344847605407854838622579918392303391348883456</span></pre></td></tr><tr><td data-num="34"></td><td><pre><span class="token number">11862408230648646824379135327053646841887178264175531603686799216636057893475396521532587109687115324752211381274444360146541619677102512784127633129472000</span></pre></td></tr><tr><td data-num="35"></td><td><pre><span class="token number">11586559788323785798132863254053156938609770716760857925843839816360341130066860520519581722934525936451553514593323041552847881749539610299565289636888576</span></pre></td></tr><tr><td data-num="36"></td><td><pre><span class="token number">10275579469154513209334526170019007941887389637154766329795022807287377909230890084032685997043147348540771585421005876846815430545316901296945336680448000</span></pre></td></tr><tr><td data-num="37"></td><td><pre><span class="token number">11060169256739487758359281857455577951697173221779953479202322477422299899699183564084773431971239890143158491109177050084864154636183725624573489648261120</span></pre></td></tr><tr><td data-num="38"></td><td><pre><span class="token number">7484535899840363082723205781061868227326121379099409743060561334440530351457497817563978845648369349638983838067294416694027174558812356876448625980342272</span></pre></td></tr><tr><td data-num="39"></td><td><pre><span class="token number">13080259813261561203905280485860084814745391247113407567923526532119479281798561044832205623167889332749509826714509840490560724311018426218809011923320832</span></pre></td></tr><tr><td data-num="40"></td><td><pre><span class="token number">8017032239401337186908657242271906525548098497408853888966102778376382128532914166154441849038627610449540122214818651322112179508878618269303460118921216</span></pre></td></tr><tr><td data-num="41"></td><td><pre><span class="token number">8133031594124338230947609411576145106266723931346561614308989446260491235948112604728707144386004872218060597196614389784879656421717161899091227419082752</span></pre></td></tr><tr><td data-num="42"></td><td><pre><span class="token number">7113324503331575609588955842219492992286125160090656751966926632833509862645633934867010072188072235583762270324022108653700267520623388697937200059252736</span></pre></td></tr><tr><td data-num="43"></td><td><pre><span class="token number">11528934867922800398510957391398858480396321323765481691549343851866739151025955782241380423893137793493528149982548338089797671301174760797186870191587328</span></pre></td></tr><tr><td data-num="44"></td><td><pre><span class="token number">11035291335758645644319598596722215843847128182979661692408122913440606574943737298702214276059847445015122663721022317188279728883248790216530810376290304</span></pre></td></tr><tr><td data-num="45"></td><td><pre><span class="token number">6744724264767810731276221927492638455951176358183419231637194759015207470188114274774040795158569911395923975933128058146398869555974993721465306192281600</span></pre></td></tr><tr><td data-num="46"></td><td><pre><span class="token number">12196816509268020014036111694129611044102546216659995568068203737987504033396231275246809262527886886490201034475903071889177680812231390626015328769933312</span></pre></td></tr><tr><td data-num="47"></td><td><pre><span class="token number">7147180627590221191329551175374243775135385821794780746671747085468551364000970029897471139131090568023232661215879440510380681900083893809025155740991488</span></pre></td></tr><tr><td data-num="48"></td><td><pre><span class="token number">7259570700721773911449764787711325294045712386608685191007791327293448539811782374249228711472359997868841968952213694651014734586449886888770974190141440</span></pre></td></tr><tr><td data-num="49"></td><td><pre><span class="token number">10983476083473689964041374191280649726552640444660701856918720187317848675977097688367559487398585803274767149557494113137528100175676787590403018668900352</span></pre></td></tr><tr><td data-num="50"></td><td><pre><span class="token number">8473167340158138453207882645257050945376739496587311856478385717942233181878873656653527132133946865516769594755305136405340050225362638297392371220873216</span></pre></td></tr><tr><td data-num="51"></td><td><pre><span class="token number">7020891434764732959161134297720118498346770791208051290652325833643326586403413702043875419458112774100793094569233319716148659466835205340621626444611584</span></pre></td></tr><tr><td data-num="52"></td><td><pre><span class="token number">12267031303090791657874428388861427822931866067546385298588634401940261402026517894425054670991325828922947848768031366107041668905705510467348657141186560</span></pre></td></tr><tr><td data-num="53"></td><td><pre><span class="token number">8756628678991673161272425988730385346361939465326962119983077723945714031899751667758236101810537197221601994127198357973628536585860289680171046239469568</span></pre></td></tr><tr><td data-num="54"></td><td><pre><span class="token number">8794029695992999708040926039293018879550507411380751321243794671455218782615434051766340936705145234549457325576894124880750014248324592888848700263104512</span></pre></td></tr><tr><td data-num="55"></td><td><pre><span class="token number">11208089441436389762925161521937699497189782365651453839190789644361162118889605675920316796123895834084636006452765683135559886413111585814596878466023424</span></pre></td></tr><tr><td data-num="56"></td><td><pre><span class="token number">9112839643066755951636087956943305435169083917425922328183796736732881471395009016622610996143306771833616880251563446563681017182395773850614883978051584</span></pre></td></tr><tr><td data-num="57"></td><td><pre><span class="token number">10340349297034620868066310578432000274213307826211457212218480849254475426587439286422057290163056241109549262433841093294046724396912778589796056743018496</span></pre></td></tr><tr><td data-num="58"></td><td><pre><span class="token number">8003692696295517246900223426880619563184296020092634287346589313723587949135901307158098489973009938304405633144137397833880989304541002097015269982470144</span></pre></td></tr><tr><td data-num="59"></td><td><pre><span class="token number">9394831047632963274965474961044801392642306981058123724811545169543659031023890557590233826097596421918105404597590570182143600423373093274416611527229440</span></pre></td></tr><tr><td data-num="60"></td><td><pre><span class="token number">7521060591838734671865608692057702970568959138196469197891685004825194794558492211410587376082424989492082994630611580622367868389798376062862241550041088</span></pre></td></tr><tr><td data-num="61"></td><td><pre><span class="token number">12659981509744233609440995482344345640812619050031306842355953524340754352370120040675004219135213972616432058333058816921005971638282394622437084670984192</span></pre></td></tr><tr><td data-num="62"></td><td><pre><span class="token number">12771346311546917175547722064993142477635625878393791624978925489905677963420618138358962111629501097295039627362675588297160323306628946209079369383542784</span></pre></td></tr><tr><td data-num="63"></td><td><pre><span class="token number">12245110957094807635564128908586831532236632235330259858875037270649848508417424287275968028265737166324904376189422996436418465201157396846307045873287168</span></pre></td></tr><tr><td data-num="64"></td><td><pre><span class="token number">9235818726765267281515922791025137569322412683461346431156747050886895759530737544863803672010449601616272582392631231877795296633670583614968239566618624</span></pre></td></tr><tr><td data-num="65"></td><td><pre><span class="token number">8376606565606227045363752434181826230522386995824202796287742610958006384999562185946288166261988738149119024682426221712586959500920720823467702101213184</span></pre></td></tr><tr><td data-num="66"></td><td><pre><span class="token number">13294923409904028240263740349208140873577846487138072359230071292814890980282035961162367939662975152133350126159807604861091902804010528289035966985797632</span></pre></td></tr><tr><td data-num="67"></td><td><pre><span class="token number">11488030452735867488709564610707090531270907907015189588124709970230610682894969168505644948476380774957932156423564301456586508900212124256728275669221376</span></pre></td></tr><tr><td data-num="68"></td><td><pre><span class="token number">7793933723981876609576551483318552860016581233910711198327356301645731964930303675188673405995617684820058956745833199746520295357905265794413716100349952</span></pre></td></tr><tr><td data-num="69"></td><td><pre><span class="token number">8065910437662674812796498450982439657651782023286963928506691512014241759447185129959957334918500787607318784900170663400690820364673649443432995808608256</span></pre></td></tr><tr><td data-num="70"></td><td><pre><span class="token number">10568806370854982276412458276329156647762320497119499451626767366395218987539721710796244116844391310666787751581706655127842163203508086047978136425988096</span></pre></td></tr><tr><td data-num="71"></td><td><pre><span class="token number">9685348248858074385874389606155819889517428922216671115200416421120760214379440993560556839251676909726063290164481965522864172648990750635800575627755520</span></pre></td></tr><tr><td data-num="72"></td><td><pre><span class="token number">9146986697327307297144101422783478950361493418576511317424066642724956669787173907078118961896989656878557071348922755697270975142025377857413303588880384</span></pre></td></tr><tr><td data-num="73"></td><td><pre><span class="token number">8646338326243820545283131814593058293786469757154585394247708958128198022422318176967085495362854603232088900066809548212169555976901847833455667863093248</span></pre></td></tr><tr><td data-num="74"></td><td><pre><span class="token number">7134087452649672555088073667402095739082473565155447279086916078173102550750432301836660196490024570512820226526139078368196874277988436059520101102125056</span></pre></td></tr><tr><td data-num="75"></td><td><pre><span class="token number">10106726034836999008152244328205454502794067124188078159864877223948319753082541887583511319772501948419778239909400840337563013655407410528659233071693824</span></pre></td></tr><tr><td data-num="76"></td><td><pre><span class="token number">9330081926535794713872638445563013289590144062605115979980947778921698097454534822968593430712801257599549784867978334485739606215995183729834631052132352</span></pre></td></tr><tr><td data-num="77"></td><td><pre><span class="token number">7235727989596948727564466843311886611922789749325487609540430437087524973058251699820461551074520631158178133558988340699238336263551724723245151015665664</span></pre></td></tr><tr><td data-num="78"></td><td><pre><span class="token number">10330300489734643864823329091259727088549074666795449949009029790179883361262234379749255189108171868472461543348787459218019428115351679077993345500315648</span></pre></td></tr><tr><td data-num="79"></td><td><pre><span class="token number">13071984117470949048963086256992960743898315093215969208892783146083640543364647306853001974529688997485025233739369232370484763918590206619921614062485504</span></pre></td></tr><tr><td data-num="80"></td><td><pre><span class="token number">7846275540507534436654095866809223926453522832033003225883762171336125018861425391753445432878147051096510188358438628499000508514854947780115180025806848</span></pre></td></tr><tr><td data-num="81"></td><td><pre><span class="token number">12936439682405552670292125681862671849560169365962192048037967486715920763391273840898683404871973229060304175672117400628426597869339073346754341033213952</span></pre></td></tr><tr><td data-num="82"></td><td><pre><span class="token number">8945352127225924585580135865208651455545105630328034583333915567209421078671500103607190355989390397386597406713756358906002602133150824803155336966963200</span></pre></td></tr><tr><td data-num="83"></td><td><pre><span class="token number">13325346406947153623441517247666146653259297510878902149013202933463193535858900632048763050844496127816126395494105430409553516116258124933702120632221696</span></pre></td></tr><tr><td data-num="84"></td><td><pre><span class="token number">7484192405666891981687131460567481086110155095342002234765360999554746301610371168425584516760647878839580243841829455115555479733662172687015525524439040</span></pre></td></tr><tr><td data-num="85"></td><td><pre><span class="token number">8207724334287376620401438750145768081115148602790832814749443756526522584875636425890449496600684176053208038544125429304019884463075174299953652362641408</span></pre></td></tr><tr><td data-num="86"></td><td><pre><span class="token number">7272313346234992777151517814154764960877532466882807803943602945689406318153875835890446152595296318112257852530329181139568273145066173572925877771042816</span></pre></td></tr><tr><td data-num="87"></td><td><pre><span class="token number">7204636167706694779221487371101812189116367499631876539170776101501950706069528339143777076965447808154036625718443895389305832765601225014816803385245696</span></pre></td></tr><tr><td data-num="88"></td><td><pre><span class="token number">10651416467464803621603114282256855218563708145958489679058318021978830544978730924942241432099578884470740234126821697375729664498602532349482345418457088</span></pre></td></tr><tr><td data-num="89"></td><td><pre><span class="token number">10404178060767649959914980425711462685185047660403956586077524648107302258355106442750599703504199298960879123916991045461711195593633639725836610851307520</span></pre></td></tr><tr><td data-num="90"></td><td><pre><span class="token number">7669486494274631112409350393883008722314648796351177301626597032136766136906884203232647077674553648507917850413831316967176990881334794941758372852006912</span></pre></td></tr><tr><td data-num="91"></td><td><pre><span class="token number">10712800325798554474723501367281782649161969880939904418071432934328809103546458127950451074827476909164945731129420384510752882763513275091900351098388480</span></pre></td></tr><tr><td data-num="92"></td><td><pre><span class="token number">9289156009277921706046224952798179901679653803316269225495106725305554211500763714696093230269811243499205112163537917370705529918862842112855517714972672</span></pre></td></tr><tr><td data-num="93"></td><td><pre><span class="token number">7977056166661561538868276739117707760090357558128755270038694136386895660588204313475399091227659730381049961505469386574802448823202593725438292184268800</span></pre></td></tr><tr><td data-num="94"></td><td><pre><span class="token number">9817734859306401389589574963093282249050414165659574961027655309927008152259182052482668663573309518942514811459780910125858088146186434357070079327207424</span></pre></td></tr><tr><td data-num="95"></td><td><pre><span class="token number">9915712517873026970941954381235529901613175656979038104395244039723647823180015782205880910861286383820278324000481546428690946853053082455724385577730048</span></pre></td></tr><tr><td data-num="96"></td><td><pre><span class="token number">10055855947456947824680518748654384595609524365444295033292671082791323022555160232601405723625177570767523893639864538140315412108959927459825236754563072</span></pre></td></tr><tr><td data-num="97"></td><td><pre><span class="token number">12645664275934128425995801153772545253026383395565753504650614866505543182771558467152829196131875933432657805591907258960649822946125501504918973421977600</span></pre></td></tr><tr><td data-num="98"></td><td><pre><span class="token number">9834238889257332495918006089780261695704839857971654218510242365521955370832772767063394759209040602238140841199256301538545758891393074066502184006057984</span></pre></td></tr><tr><td data-num="99"></td><td><pre><span class="token number">9766543977052067127703164428908599582991488816504043311879571732981897514257511476090579267875601033622927472673339193185682367441759059627508250800291840</span></pre></td></tr><tr><td data-num="100"></td><td><pre><span class="token number">9035484712485254386262740252021399928992124527449985133104101080789329336239319530324237035467950762052492497010287960386656906097165111257865313272725504</span></pre></td></tr><tr><td data-num="101"></td><td><pre><span class="token number">12434757484953955388423494019153597130942138071039820197041589673560379216308678555179730768729287915858921664067095692770733049440369356509161101365084160</span></pre></td></tr><tr><td data-num="102"></td><td><pre><span class="token number">11781697199153871547754221154366135578994091627698089749632402740892618336465094698898923802069090704309653496422522310615502716679940879359159864366465024</span></pre></td></tr><tr><td data-num="103"></td><td><pre><span class="token number">7044336588192497304268384227572993375570213683084675426968043024142879929862859642108797238685345746188708144242509272811835536086745365850762991372337152</span></pre></td></tr><tr><td data-num="104"></td><td><pre><span class="token number">11783467879494812533887991944228346092030567704228368211861866347087844229446215095242954697536379818810998510700706989303671430048426511948493296758685696</span></pre></td></tr><tr><td data-num="105"></td><td><pre><span class="token number">7667741651763186599060272011203058049966706233642489359738417100431516008427912758263797443001074057932267863657596626618333240346951452919177977278758912</span></pre></td></tr><tr><td data-num="106"></td><td><pre><span class="token number">12081790263251520792245915810400752403698611307074584508338698515332712970543654796350106965351523070585962475078690571545840730141123564929908617770958848</span></pre></td></tr><tr><td data-num="107"></td><td><pre><span class="token number">8304712677034242741879424091331981490418607778675075377803738449210400077776410458981814184198403861355156989435581033245652350048642939214169748264714240</span></pre></td></tr><tr><td data-num="108"></td><td><pre><span class="token number">11731831938699772462127271873430115361544445093018344205508116263256543526314353604701640010896040499228777875913175294497034647460453248703129442880323584</span></pre></td></tr><tr><td data-num="109"></td><td><pre><span class="token number">12611340792013662409548423412084090313541991428873460594451143922766575732008077576355899572115836413223853292335585527738394056748863098221758029565526016</span></pre></td></tr><tr><td data-num="110"></td><td><pre><span class="token number">6920514056066752049896312657794962616499627606782345496721136061660972740504489014716954040643339880149753794384547866514638249797775571157011056233021440</span></pre></td></tr><tr><td data-num="111"></td><td><pre><span class="token number">8012802214172608785822338061113949203526970105927939461359134862985996256466303431426642248012926173840551142639737538301306023231710328226570049566015488</span></pre></td></tr><tr><td data-num="112"></td><td><pre><span class="token number">8472245399695050600320122897672141627967205379689218408944051944140949860506981827249657139699014553136300215872732651030582212798322209941784334688059392</span></pre></td></tr><tr><td data-num="113"></td><td><pre><span class="token number">12410853978543082931896742879800764639465898058602003579500826870559416001104420934654807857856954230815935180124417566096898572858880179166444466240225280</span></pre></td></tr><tr><td data-num="114"></td><td><pre><span class="token number">9482549434846322453030638107394623528900653078037336884349635465205012176188184199497567197099120461769292262498569785812457365121926571539713915072020480</span></pre></td></tr><tr><td data-num="115"></td><td><pre><span class="token number">9150916634351409080197710165770539206676008128536540541717456861997357603112111159569029666038960879457991973858327421056360325802011179757764443432288256</span></pre></td></tr><tr><td data-num="116"></td><td><pre><span class="token number">9572481632182302455252063408682547236293884340092764998966833801558029007935967483404495958786753043838845663371022055769721932840641723393127627993645056</span></pre></td></tr><tr><td data-num="117"></td><td><pre><span class="token number">8829185939199811116695686657008221592517065315221117863333945516299382230252080234314643161147613605516755976748309046503994576477237519950967843307126784</span></pre></td></tr><tr><td data-num="118"></td><td><pre><span class="token number">8822628619281313684700644957382685451032922056071445680283328235288317145945407233158298116938733305123490309475127199532834112577883283907940200122155008</span></pre></td></tr><tr><td data-num="119"></td><td><pre><span class="token number">7839711815472697775142882852988785569781262235230256597445286796798968529073774587224646549230618335651887641210976676422786413224510864168319106431320064</span></pre></td></tr><tr><td data-num="120"></td><td><pre><span class="token number">10463239550546312946999221518957659462141579584120000336302141604780017304425427058611175333465603975797667645525273216203248962417478751497093275088584704</span></pre></td></tr><tr><td data-num="121"></td><td><pre><span class="token number">13177302566647859366931826853218951417527358462220617193128871532356087828017609294867462098785136680491874745616801791495428945212801179423696520793292800</span></pre></td></tr><tr><td data-num="122"></td><td><pre><span class="token number">9253199978154597101356972570334769972103050901882670648647637184268808073304361089048826398792540466003077986057454857478024362098088575247675082185637888</span></pre></td></tr><tr><td data-num="123"></td><td><pre><span class="token number">12452175857017018758887918761471554135409099554191196016924534437926985301798960354476843005132255011762344217012057020045383142221683039496960375580000256</span></pre></td></tr><tr><td data-num="124"></td><td><pre><span class="token number">7292557330060185779268948911111693275339382503998421377121751779483178332692404432045341532444212200974055971194351480112108565438398611963611882698309632</span></pre></td></tr><tr><td data-num="125"></td><td><pre><span class="token number">9852967406332414896552811953233742667996597218988704340789262299853346820256965389289302807188192772090123508958331400610998703570407727111442476902121472</span></pre></td></tr><tr><td data-num="126"></td><td><pre><span class="token number">7684261049992045157933381290153201464414730067120939214813058508287109789323413172853746986073622442338147415381746777541037288714775364194498881372815360</span></pre></td></tr><tr><td data-num="127"></td><td><pre><span class="token number">10684346944173007063723051170445283632835119638284563472873463025465780711464857747138993581351751168940494136992356071774085125365769922926064314051723264</span></pre></td></tr><tr><td data-num="128"></td><td><pre><span class="token number">8510760086876756953116511566562715458917511804620250777694968642081231652904057030202340745958144095410138228973965523095277175209189839588745736416657408</span></pre></td></tr><tr><td data-num="129"></td><td><pre><span class="token number">8880501070618386336835179816671291813393692118265017714560026565852827640901613364732027981590363683277166715338892232568910008163770573837313454093893632</span></pre></td></tr><tr><td data-num="130"></td><td><pre><span class="token number">10927663022022848112576613051440189570921461187576641785058144940925367083638643015502824270031604057898836935896086957681209109349081121055169211065696256</span></pre></td></tr><tr><td data-num="131"></td><td><pre><span class="token number">11065460099632713626114074213628133213208031368636943030660893407606771896023093702282051063005056616677256138228852000722034608913744977661109800919891968</span></pre></td></tr><tr><td data-num="132"></td><td><pre><span class="token number">8528558426695364101018502869552516048167370753217602881863506758942770533224091469149470071780263906213216048695495317215636195291314278996729304134451200</span></pre></td></tr><tr><td data-num="133"></td><td><pre><span class="token number">9992207307383165807055726461654302777062570935307844590530213520831226364125761166207032497440860098162489538520528217568718645908666567568981083958542336</span></pre></td></tr><tr><td data-num="134"></td><td><pre><span class="token number">11387600105321552273333592074741064662436053298182150131803615548941610623211796057336420955776606458622728975028306091535172686744992673981435261673799680</span></pre></td></tr><tr><td data-num="135"></td><td><pre><span class="token number">13254549680959727691519047759215241559557636271473528815010057145072733382199751353680248856296079580012731762530060832489804097294729057822731303573782528</span></pre></td></tr><tr><td data-num="136"></td><td><pre><span class="token number">8636453048977004090748313014420193993580465848933198869880468648396061207781366684465997954483808458181047642890118580838258547167584680359063317213347840</span></pre></td></tr><tr><td data-num="137"></td><td><pre><span class="token number">7745171931286066713981822690234904328059597633315006970659375840675215092290309143177137726292272174270326613236421191736605617456329566003769837168361472</span></pre></td></tr><tr><td data-num="138"></td><td><pre><span class="token number">12722481251621106191009043469730703472687567773224213329482598211146715278270082420744452710787698703178352420803259043633082685596782438908920132353916928</span></pre></td></tr><tr><td data-num="139"></td><td><pre><span class="token number">13389288071766611061596163568387989716128670000576901930092122848242211679752312989778111820638046128968288762924060258085863315165113192530964821728821248</span></pre></td></tr><tr><td data-num="140"></td><td><pre><span class="token number">8996553709322460232850787254342689776497991762671458730641758808163092908948849466820197224994587633844477265912812755750291616969837121558930540885704704</span></pre></td></tr><tr><td data-num="141"></td><td><pre><span class="token number">11668554352289937302662011855758915637812300100030026118434164668324414586037455193636467284906328465058683516231677294442387748092512976382822143555010560</span></pre></td></tr><tr><td data-num="142"></td><td><pre><span class="token number">10407703355769886528679070761014863674215547377040128706251397591242730724149862062848609492290060553297055295490446242385605821635157504633356558943649792</span></pre></td></tr><tr><td data-num="143"></td><td><pre><span class="token number">7914545382939938224505462276524806597762336456778014601255748188239773834594576467119017297494305401320898751558028571648303402900044874962342416186605568</span></pre></td></tr><tr><td data-num="144"></td><td><pre><span class="token number">10512708710748190624250450789656654743987887101983992703416049982078197769934618694238537761746081240389333318773414938177624678638324629241237370627424256</span></pre></td></tr><tr><td data-num="145"></td><td><pre><span class="token number">13128187740815743983311479123003199002599852602538840649582033887349477368861962374044908887155604518950930340502613490652110348065254913260468344826363904</span></pre></td></tr><tr><td data-num="146"></td><td><pre><span class="token number">12850703192394508867074281222647170907051920584954552730832876684768429934965257478150183926204752344957929391520419523656594754118150554328681046446440448</span></pre></td></tr><tr><td data-num="147"></td><td><pre><span class="token number">7976225821353475156934997704720425338164842350027267997958143260067433072651280094012452774118426686309411406835509318422570832336977917599493386141696000</span></pre></td></tr><tr><td data-num="148"></td><td><pre><span class="token number">6737566608336937894077961637983570377044558770716623543823389012701672006393516175620583714950585322984204885198320834463793317321592854740980558475558912</span></pre></td></tr><tr><td data-num="149"></td><td><pre><span class="token number">11986302895088026733184303090047264805404021059888713514655398889582024708797550985503869225446434640273696171313540938493800994830897786509780045847855104</span></pre></td></tr><tr><td data-num="150"></td><td><pre><span class="token number">9100506848196680105682515766062615568700674621920939270627686170103996659713031668726428406323388970826411150507762054385035169050115177821673659033452544</span></pre></td></tr><tr><td data-num="151"></td><td><pre><span class="token number">8933106199991049431957198816007208608473498863179298195493852345818489436209725279987724714335457065296585823814897179897529463680251999554255878789005312</span></pre></td></tr><tr><td data-num="152"></td><td><pre><span class="token number">11747144143064157851173741905821917076991991470002048139814220602876667242347463974157796922761337966166587020972217740274803812542485435266188837224710144</span></pre></td></tr><tr><td data-num="153"></td><td><pre><span class="token number">13401411573878562561574346005874124685410233690756475064920648336376955823059402366037728370964484961879159414204105837214974893157218513191015824928800768</span></pre></td></tr><tr><td data-num="154"></td><td><pre><span class="token number">9866949065769133846069539320905306888258991612260938177209660204679293518280190955011520313985040753735247275985525770486142823069011272627449744374890496</span></pre></td></tr><tr><td data-num="155"></td><td><pre><span class="token number">10693040111506570166070937529090558427399165411386230363045092522899096169056929498631770966310769367618889921080844684734768520649775793220156489302278144</span></pre></td></tr><tr><td data-num="156"></td><td><pre><span class="token number">8581227246293839081758520849307091685831311074381851507105355537525938034813963685721146554083304897726057315249912194963448287510871624853785633982775296</span></pre></td></tr><tr><td data-num="157"></td><td><pre><span class="token number">7714395570893326252422482542107307648524288637714787666741722056569193688752812221039872143128034708292735067598238244289413525813787792709785210450870272</span></pre></td></tr><tr><td data-num="158"></td><td><pre><span class="token number">9855738767027535452978093200342112117981107686658516860218712505224613232550497528754752044554690675047842131133278959194794062543820353174711993517473792</span></pre></td></tr><tr><td data-num="159"></td><td><pre><span class="token number">9780163692438941032894987149848488058902628611379316601888427233620595407962257147934520121784614807371764214941894191204318151889375933288974064287744000</span></pre></td></tr><tr><td data-num="160"></td><td><pre><span class="token number">9573600207090041750877743293449546910891480707861307544670321905171089145401996686025267898065502714822979915912304171201533601167106470750681644924928000</span></pre></td></tr><tr><td data-num="161"></td><td><pre><span class="token number">8340512104010588165917735952686382449576820587035507681117457032907766347073807404582219979812806713425949924409057789825548289272940836433992683949654016</span></pre></td></tr><tr><td data-num="162"></td><td><pre><span class="token number">10098964476043825742572451411510009027037637053626765840163547247290571683356387459185112391042994124956908258649123691413595748127264896576171628224839680</span></pre></td></tr><tr><td data-num="163"></td><td><pre><span class="token number">12320990232849581115799352708439879810326480594433950675090828710534460717164694140855231375104026092293382768628657269138788113090356180807095783264354304</span></pre></td></tr><tr><td data-num="164"></td><td><pre><span class="token number">7109351534352708454303448887621181044819731033103893791140488758054114294246250965621348318329578246557915822257976104830999489295209154201955182445592576</span></pre></td></tr><tr><td data-num="165"></td><td><pre><span class="token number">10148167240338064261608043464089356433407881728435155580190904726084387542286201562514017497390525235608607953789364863043062048008667410861520724642758656</span></pre></td></tr><tr><td data-num="166"></td><td><pre><span class="token number">7951579653564955313006976555516793066801839804305622202068981831573067028196737553491440700688698011762798900413935631445034978112992241331830468202463232</span></pre></td></tr><tr><td data-num="167"></td><td><pre><span class="token number">8629215098911648274802380179382829850270506370227986999086744785087288825860127216494335244792829135811876576734069410155248333893763652464072465118658560</span></pre></td></tr><tr><td data-num="168"></td><td><pre><span class="token number">12792037974032017072934922910407287453225073145058654773355081826700343423760231085338782677033402117034233505243663658527148582127877835700506743812390912</span></pre></td></tr><tr><td data-num="169"></td><td><pre><span class="token number">7392018546769025535091092092963600277680339763069322427422147558871335438459584174836225708335528516761980547428667961384535797175532190688669539009298432</span></pre></td></tr><tr><td data-num="170"></td><td><pre><span class="token number">7894334157548279288419978106571344136142963734002721169088161721013430586147262437652660133978776927171911897053072817687773047949624875085638033838440448</span></pre></td></tr><tr><td data-num="171"></td><td><pre><span class="token number">9341699959418815020193028739060769293077116647774515185638475996749465890469112754573161866465234000969558193418684150877712959295173473486854087906426880</span></pre></td></tr><tr><td data-num="172"></td><td><pre><span class="token number">10707031268454065707615055806083095357830864241990336155181470874302622160936668002562085723941877870217262788556429110133262797705638840034357589879816192</span></pre></td></tr><tr><td data-num="173"></td><td><pre><span class="token number">7523524155955892466558864444516195392299621719403382817189462204638741987301641751703352940510408540054913378387826506144935300386763463417370049851162624</span></pre></td></tr><tr><td data-num="174"></td><td><pre><span class="token number">11092426363800620561833696878974166300344275706877365925211238239798636619609097328861038954940453422212812094406454774281047898327486032603030846877728768</span></pre></td></tr><tr><td data-num="175"></td><td><pre><span class="token number">10188841548065200507025631564258964478696202368728543348951437731388128873626911610407083310008537833815808817974504914538457498057426119446554021780783104</span></pre></td></tr><tr><td data-num="176"></td><td><pre><span class="token number">6960995864454276447008485059168793407772885887549440834474505152705236045115221288590734621758293974729071093614114616192697575126506959623168398471462912</span></pre></td></tr><tr><td data-num="177"></td><td><pre><span class="token number">12659742733807014821457800442972021951043890051711019549851064405658345134709001291767793619905506010461395462259480348681265961115907239289469423587426304</span></pre></td></tr><tr><td data-num="178"></td><td><pre><span class="token number">10790753548097669019227487930205429455760038941323109343704300543273376796749972315254598483059806127356831016169048217115083659634623604135619594968629248</span></pre></td></tr><tr><td data-num="179"></td><td><pre><span class="token number">9368341626342261277544311000142562911170522765711312581726508542635881921129040929996078902046352513260926724764197936976160750195056936000093329444306944</span></pre></td></tr><tr><td data-num="180"></td><td><pre><span class="token number">11514441000961623777904802873374123708029140483779156732061726073894483521912507830395068017860055044626173156929365077667222504451861633129118109160964096</span></pre></td></tr><tr><td data-num="181"></td><td><pre><span class="token number">9243496738952721625994049770917559451813510137151615345843109614718008153032157460432142820777023637059608735154685660094237159847656782079427445115584512</span></pre></td></tr><tr><td data-num="182"></td><td><pre><span class="token number">9486209767840225967745722943244284442240394305883047145210716140530158131775300227184192271167282451699042588809732008668514509535068216552783020153634816</span></pre></td></tr><tr><td data-num="183"></td><td><pre><span class="token number">9734300867273278510178870119183891468492359431334241827855279733953340546579414752964793566332115622014248655450084781631532019578060365695230189175308288</span></pre></td></tr><tr><td data-num="184"></td><td><pre><span class="token number">8880677828401152373027562563556975275617771316357381955323553543136002570266000904350396396234676038185383402785812228880496539728555849975383078207488000</span></pre></td></tr><tr><td data-num="185"></td><td><pre><span class="token number">6970517270723524745202305220911274808462268973743264964213036521170247169043620944266098624101459204429114963894514472802681235835954420738984979353042944</span></pre></td></tr><tr><td data-num="186"></td><td><pre><span class="token number">10290152218496876984786458605356910241145709099893487638860766121633584117511808155921574165645449124920027121312264640044391684967345663005781479894548480</span></pre></td></tr><tr><td data-num="187"></td><td><pre><span class="token number">13083838027597467083586989304836738116395727883265481582349563908877695497139744457868595051017423080761473669402266663244540472170609637493106854043058176</span></pre></td></tr><tr><td data-num="188"></td><td><pre><span class="token number">9621482807027401848460997483309012645974318967590507439785880580651827396611247657583444349816475826162865682456153895475101344074767646547978865898160128</span></pre></td></tr><tr><td data-num="189"></td><td><pre><span class="token number">10293804833808994285046918058828975957342949635860823364833644631038475951439784103699299489986350643987791527886794028375237939433720467633098984144240640</span></pre></td></tr><tr><td data-num="190"></td><td><pre><span class="token number">13355558588948861221773007026512604319986644100305859132809453887175110103681468112254786917032449346129999267167372804972651099044051613072211623102382080</span></pre></td></tr><tr><td data-num="191"></td><td><pre><span class="token number">10483962366567168624247146557188730215606169778708790917257308166386617851071421624407632210513721887660096995076754045645008514857407433522725897417785344</span></pre></td></tr><tr><td data-num="192"></td><td><pre><span class="token number">13095198362765647280491612807377199873726119807723292970309669784643556884426423306009168311137439951575289630129785614802884143395628371445282934620160000</span></pre></td></tr><tr><td data-num="193"></td><td><pre><span class="token number">13083298877716723031868721332734691374568476337585283565753878723752922537693126757719287196322061242646696122140085838843647576972435437479014313465217024</span></pre></td></tr><tr><td data-num="194"></td><td><pre><span class="token number">7493200275300255758193942864750477909317920723648330686225939352993062276694850640447165650095535353738023480803500947548974452390599900373200665718030336</span></pre></td></tr><tr><td data-num="195"></td><td><pre><span class="token number">13194127485170211209651883073306025648950665950520446331352277892499488385312570653841118650410248485232299739811407202658041657247146017597746519694376960</span></pre></td></tr><tr><td data-num="196"></td><td><pre><span class="token number">9338381564709760928470669565697584166097013396927954138639606486517249453167575733941807837099278028897211895507129793068799301506441662424856162925019136</span></pre></td></tr><tr><td data-num="197"></td><td><pre><span class="token number">7194634723885717363294954216159112035256090377418422803240751015113605768748207662627644682327374049529071794202447288819848733325117080369479789764935680</span></pre></td></tr><tr><td data-num="198"></td><td><pre><span class="token number">12480398023211215500091177433063399717961835019006968010383160846015819038693314163469487676262187519519137735041054091477154983036388960695477254813122560</span></pre></td></tr><tr><td data-num="199"></td><td><pre><span class="token number">8026945233520010614359021528942460591128260356009704364937263291355082159402746125236578483337649312934112147991724019993027454058313980561016794438959104</span></pre></td></tr><tr><td data-num="200"></td><td><pre><span class="token number">13178230620801630836363274182749932756892006207693044443048432545511931446447088989582149959004249212070237557511736679698342096216995367655781060470374400</span></pre></td></tr><tr><td data-num="201"></td><td><pre><span class="token number">6731412030340380606534395585263948936781922515158657517544365935064131180415043885634404688131307235966621192883260115459220875476014799288652610328854528</span></pre></td></tr><tr><td data-num="202"></td><td><pre><span class="token number">10226445281206256606540695107635239883449216611814239514089153028393020875956044584732556263719157997515227619627929953225493444800229905140833920477036544</span></pre></td></tr><tr><td data-num="203"></td><td><pre><span class="token number">13311354671600143595626538288216625241855604673476840764812889387585124815687182153165550624367077729099402112432734082214536532736715266812395040951762944</span></pre></td></tr><tr><td data-num="204"></td><td><pre><span class="token number">6787695890281979607768533714137132933577813781253672734461083492721879773075439784005622477910234132979315269750147966651876161795637055739069632314605568</span></pre></td></tr><tr><td data-num="205"></td><td><pre><span class="token number">12001709273720070177685394877568639566746473590962281958807058963434040968359237055651839359684511844921063059577037411459820932493805724501422274315812864</span></pre></td></tr><tr><td data-num="206"></td><td><pre><span class="token number">8179898329841716543898792363230897443142032722602173043722871414359732351095966078745958654819717367556166775578472687054420068797652267851398396038348800</span></pre></td></tr><tr><td data-num="207"></td><td><pre><span class="token number">12786084161871680408711645609357100638795860422705680000805737452073481601276491480594130568300885695026165979626718457847867355684932703332237144479498240</span></pre></td></tr><tr><td data-num="208"></td><td><pre><span class="token number">12344458800695617339408460635696941160687933126755233767929527283522917411495232385828115094976419030627907586448582882718536949328093057085808350773379072</span></pre></td></tr><tr><td data-num="209"></td><td><pre><span class="token number">13033554202070210895269599377490016226726408852836077460362541757133883127247527233700440772759746948683087124507357733022499395811973996403619087077343232</span></pre></td></tr><tr><td data-num="210"></td><td><pre><span class="token number">8511601680484423926368442089548648113992939672523274066855400440928101309069595370516438028563233205608663247271816562457829075032082237427113217654521856</span></pre></td></tr><tr><td data-num="211"></td><td><pre><span class="token number">13213963510980147642218387700252009262547944790485616025018524499765618442269461772943387296603257894751896530121291916075968978719056216006920998643302400</span></pre></td></tr><tr><td data-num="212"></td><td><pre><span class="token number">12067962304250901679777520324761413885256494607911807355073291399670474139644409829538168609546383294050771767248056357474022333571621731472278514844041216</span></pre></td></tr><tr><td data-num="213"></td><td><pre><span class="token number">12720703266168054492242207512107119013650382789031545536391406632387233281622174890081116210008539047256536953162256545343187963832740677353339005532372992</span></pre></td></tr><tr><td data-num="214"></td><td><pre><span class="token number">6823097277252733923596420887315690589653921434416823345795280672700189364696973326933361485072729380399053967203484863233951574452039428644884906223075328</span></pre></td></tr><tr><td data-num="215"></td><td><pre><span class="token number">10265009304281882119936532403028295309604452650707506619795315154351360024604050124314472166238210207628995367675450538243856985614733816560791746097709056</span></pre></td></tr><tr><td data-num="216"></td><td><pre><span class="token number">11437448964303939553252582947435505208451187474124443119423522204983103405988139934140729033727264371435643292278995687436237484587794346048496293510119424</span></pre></td></tr><tr><td data-num="217"></td><td><pre><span class="token number">10647498390557545471021041462067945106288762650851028032831519597077081674874224445802800861705816178562454840416233197237857358514313848837155424735068160</span></pre></td></tr><tr><td data-num="218"></td><td><pre><span class="token number">9041215650462447965984177562970114613202889822153667378038012145698573123168099128541506242515012923972260307663113174087455163186070512236744687187132416</span></pre></td></tr><tr><td data-num="219"></td><td><pre><span class="token number">10963577184381494583508050206150949928687452534484028098363656518569203543669716860913590285872547426176299287614677663810325919214759287233424873798762496</span></pre></td></tr><tr><td data-num="220"></td><td><pre><span class="token number">10946770715235836881883569640879252251470114113087008683624120489507106033128884718732835028027482461374059747822002503570896688225187082044249625377898496</span></pre></td></tr><tr><td data-num="221"></td><td><pre><span class="token number">11868057744492704188369296235444935446678402871055961938265785228240444200162649922071311358738399426277474310442565958947129373353354792008115233337901056</span></pre></td></tr><tr><td data-num="222"></td><td><pre><span class="token number">13134422422277139827464605895251284160742929737673160227113312099558302594997242471732484162680781154758894169420407370400193857008845988754881010724765696</span></pre></td></tr><tr><td data-num="223"></td><td><pre><span class="token number">9101071682554355911272578988955738391689249080751159562353767218637139224288555478993716691782295424585421050417287909307831358026395794214254657386053632</span></pre></td></tr><tr><td data-num="224"></td><td><pre><span class="token number">10716241187183461205366315461780595661673760875635762705605050651910785236030760146410161162504527907726130194773271016238403853014293656836278290600689664</span></pre></td></tr><tr><td data-num="225"></td><td><pre><span class="token number">7034927598056868995289113354934775576520569230331731909346342491679295598454382074343925427621242076900933537052029765873118187950997679913194084919934976</span></pre></td></tr><tr><td data-num="226"></td><td><pre><span class="token number">9653544662206435264925869819098571274640561458470637138871400635816586662810650167269229167387019675211851507497200501059567552507382894492578973227155456</span></pre></td></tr><tr><td data-num="227"></td><td><pre><span class="token number">8695799803266868544509019524360956144359175705612921470986736155819512797647491730673335813792652549230951819211169852774125209553723422404767373338268672</span></pre></td></tr><tr><td data-num="228"></td><td><pre><span class="token number">12297387013073541929637491151586436303048880543270928619560185783505539645996751496801788186758972652049693433577614748058664174702363847259671005365272576</span></pre></td></tr><tr><td data-num="229"></td><td><pre><span class="token number">12906812241629868802052799893596238769446708909381386578848158688024199614814114035302830299915240532818152362165457322769762883451744341926595830709485568</span></pre></td></tr><tr><td data-num="230"></td><td><pre><span class="token number">7871241271525236575006554247139255434901841409703712439828975306410439267749542826632291136234613089691813846140955303195512332652080435423745339214004224</span></pre></td></tr><tr><td data-num="231"></td><td><pre><span class="token number">7376813692425845929702293166100584923420959148402864820849224554956284137902629459722120182429696428490128562254474834691364914109452154961329118263640064</span></pre></td></tr><tr><td data-num="232"></td><td><pre><span class="token number">10315991440988839492674829150364567958067266475642507256221881776484242626554021866849166749882886803217471352746223687684652061806441671620430018576908288</span></pre></td></tr><tr><td data-num="233"></td><td><pre><span class="token number">12206256535711300051390590121030938329491116760528980996515978191977807551866247748852706584166838070756743569113388903015019603753503729408427656378056704</span></pre></td></tr><tr><td data-num="234"></td><td><pre><span class="token number">8393467617978439425833207318161348250595087059086286771185353196211201109979805592687099212288395748388220565048432663456139211532606352755404200820604928</span></pre></td></tr><tr><td data-num="235"></td><td><pre><span class="token number">8741989740080379737846911686369786527202978774710479468385314856979390174924932111901732404568360838109853265235933984742357514814832848223877600351092736</span></pre></td></tr><tr><td data-num="236"></td><td><pre><span class="token number">11915635788100869387259911970392950188957256784678986913381261190760725450740159228258076661286711959380674254087558389124007549711750509399804360217591808</span></pre></td></tr><tr><td data-num="237"></td><td><pre><span class="token number">11331411067204308870207945040483360319524097285196158322894164056886446527387138430010215812829781341885639108297372852017410338392443569045015016899608576</span></pre></td></tr><tr><td data-num="238"></td><td><pre><span class="token number">7221219324068251117466864775461051938873614012651494131477894629026816104357769585720509427133482443341115794293585081880735398846887987478701295622160384</span></pre></td></tr><tr><td data-num="239"></td><td><pre><span class="token number">12730218277715163676699868438619828627601489774673567094550302613491809560098601640862269032186399336481270523425558427226951859381977261921779906254995456</span></pre></td></tr><tr><td data-num="240"></td><td><pre><span class="token number">8637092726102675771082471103897575572827563303276608953567496717672817591595201698149537726923253902753678516346358084226867349036535135945732698018938880</span></pre></td></tr><tr><td data-num="241"></td><td><pre><span class="token number">11956381324567493693892676497683114025857832594751753381108098310593617259000957370769326528397269851219385563955955219890750309599790303983618689664548864</span></pre></td></tr><tr><td data-num="242"></td><td><pre><span class="token number">10936319471861039523859008714351206180556084282531005724523989675210898048896277322146354357112149094048519991425857243100367418995657990969263450279116800</span></pre></td></tr><tr><td data-num="243"></td><td><pre><span class="token number">8031612277424328082765881049743107283942178069903262174455909081476452823483190972778926628685062103999311067171001199156747723419946137092503185716674560</span></pre></td></tr><tr><td data-num="244"></td><td><pre><span class="token number">7340926742256417460793892471637981037581384644676773307146810710262747871190939392199456223248921191765280621291192477298251104673252184444448461180370944</span></pre></td></tr><tr><td data-num="245"></td><td><pre><span class="token number">10567312872538802195240906718737607022263235253094962309356299799565761292509385883159654503573312553798342536184560909239196010543396341814620146739707904</span></pre></td></tr><tr><td data-num="246"></td><td><pre><span class="token number">12817023261467075917386054516923205634649084766341425237921297715550227763101204061008472745715455265888433345594809993787844005231643488196916300243533824</span></pre></td></tr><tr><td data-num="247"></td><td><pre><span class="token number">13121732614015222253066787019903599944640860975981897980196416598077204842668240928186098426573492111070849880633122504886452048056116727127297105638457344</span></pre></td></tr><tr><td data-num="248"></td><td><pre><span class="token number">10570153963800624454983396670023937161742875584214388172598329795718200619230200384214324493167055685724381407726225311757117302238215421837846591290998784</span></pre></td></tr><tr><td data-num="249"></td><td><pre><span class="token number">10605861697636167912392873287017257242874165463976183222472242396624781488197580931797367152011786091894693596785458957981417642432244455134345031369213440</span></pre></td></tr><tr><td data-num="250"></td><td><pre><span class="token number">7668811610026569991208796461661741937762458543338135034998583430408782929218487867072605003670339880667404133898805911785795899326869926639566600770945024</span></pre></td></tr><tr><td data-num="251"></td><td><pre><span class="token number">7110215151871522155267815795016464380279916860433125564249991686227491638571841219970134496131706833257188627591309500788295691789408336672673080560058368</span></pre></td></tr><tr><td data-num="252"></td><td><pre><span class="token number">9110117306238599594188132180637102677543478083939753687728613046714992553964760569725581538403312187135311885834394640744729499926533915499669225388113920</span></pre></td></tr><tr><td data-num="253"></td><td><pre><span class="token number">9228168875244701641790063499617388058208068283884031871611060087019979698482090208804821996936023984015380644747094336231867825704169446635270619577450496</span></pre></td></tr><tr><td data-num="254"></td><td><pre><span class="token number">9049776043653151705804041231318161837724995439511786693709468019602805787668606743193167670163477975031141493555982029870797836504599987689172298633314304</span></pre></td></tr><tr><td data-num="255"></td><td><pre><span class="token number">8214232030137685765052305677078380110744048626822525057166107952994533425858079689095028367276714645180808494033813374243313502686326948343963263420071936</span></pre></td></tr><tr><td data-num="256"></td><td><pre><span class="token number">11508281382455856865533453243679344776480477745928717187004985386146978434708807645983182362925144684429325284812863649367186065431040165737072088829657088</span></pre></td></tr><tr><td data-num="257"></td><td><pre><span class="token number">10761988467671437764753615552035413101810866593821314440842746119223746555004491016381551734119754930165769584604457449300420186522007604851124615788888064</span></pre></td></tr><tr><td data-num="258"></td><td><pre><span class="token number">10528531976981403508552373008137716802115420783175861935847118183900300302212605540160024086381697763629009008973840068864634712683488618315860661992685568</span></pre></td></tr><tr><td data-num="259"></td><td><pre><span class="token number">10516063164584418321862119596638773476458763853961105281739696864037110468770425094123964244561681056994463546238860858200726070359809287604279105562869760</span></pre></td></tr><tr><td data-num="260"></td><td><pre><span class="token number">12105282066368734641939027591450399454883354323414122133478382430192656905625471324385858250749432479135590943541101797898148974573482744134775830262841344</span></pre></td></tr><tr><td data-num="261"></td><td><pre><span class="token number">6777441727797511895835365055099137493155360062714565071597162440449846903070093530888688592969149209782191963921941943491042860924686421323910602949656576</span></pre></td></tr><tr><td data-num="262"></td><td><pre><span class="token number">13341997551136357623784630154137826717862384243527831168183637842253188025834897426825773607268193116745587721015198376299102996892608503386381143169302528</span></pre></td></tr><tr><td data-num="263"></td><td><pre><span class="token number">10702105912739774705516978900689874645716030852264937870563908765569850000031379717714911322299599728681040653554335074563074768524599738924880772179427328</span></pre></td></tr><tr><td data-num="264"></td><td><pre><span class="token number">13191064729552952759230240250805556001929644240783394099923886316443657550825503961854232543705261012158187418925974464642622911332304522865293173014396928</span></pre></td></tr><tr><td data-num="265"></td><td><pre><span class="token number">10029762765969787632995450207702405805749615289692390879113605302167630406285205524144899296536780763927686185299649560597468157826888263930066921800597504</span></pre></td></tr><tr><td data-num="266"></td><td><pre><span class="token number">7414291278687805119239247344050705210970068163145448714032522894264084126440484543805533970885642341918288467200930899549787824040243128306372770392965120</span></pre></td></tr><tr><td data-num="267"></td><td><pre><span class="token number">12334164027109488807772944122263781379791621921054997429960292379771042000780653060395296629725524585343712963146354474144360511180400173554262822568853504</span></pre></td></tr><tr><td data-num="268"></td><td><pre><span class="token number">8625707190126819536049902091861128533925954372641807229534099137035738537472496802773498116216990065607257838326147741170130253287755616599528662458433536</span></pre></td></tr><tr><td data-num="269"></td><td><pre><span class="token number">12923423458675529032722830556684980776211737585883266560336835657176201147917067672472893078913699985971407258898389625984564787086177320073616800724151704</span></pre></td></tr><tr><td data-num="270"></td><td><pre><span class="token number">10786596952479484178090991339229562221552355362028151541594784817902541572951362119841050038217259138180203549336323318829572433622290099281806846637113344</span></pre></td></tr><tr><td data-num="271"></td><td><pre><span class="token number">8316777535665264244573986828401443703152587219708352892853994678098337771307843227938316060774762466720800448355867846640823095993376092159707386159824896</span></pre></td></tr><tr><td data-num="272"></td><td><pre><span class="token number">10328715609557955937184060182086039909136062621765428831116716928920951053949466443720388280129250240730611706449160537665167443416987369923295396950441984</span></pre></td></tr><tr><td data-num="273"></td><td><pre><span class="token number">10480256893307329898938122009079782214305563322174146334791078928169382732613498028828993346246328270383560547440791377971649420184236305365276427573788672</span></pre></td></tr><tr><td data-num="274"></td><td><pre><span class="token number">8821507664373797046502778214554316625613992522633638007668634836695940610385141096915372948773485466648157854723377791965272392212907327057390000918233088</span></pre></td></tr><tr><td data-num="275"></td><td><pre><span class="token number">12624085917919822191352186109627145039023666960818557457442331546988500780962482546378717054294262092301542974558227101743721420366867406618931272295120896</span></pre></td></tr><tr><td data-num="276"></td><td><pre><span class="token number">12609292986374592324574512691929287986549517294003207264912478644766955135505780620483115071898960721725846136746280833810033255532613992985165327713173504</span></pre></td></tr><tr><td data-num="277"></td><td><pre><span class="token number">7254830042470260321095111787708154061680127911762197642150421539844948866192116920133991474144789712459557976070912682874523908006753439907135553154318336</span></pre></td></tr><tr><td data-num="278"></td><td><pre><span class="token number">6787890565113019148200264988568634132466231060737687279438922170267887514564380464449362233495855996002787669359920738793223954835684355961101786642644992</span></pre></td></tr><tr><td data-num="279"></td><td><pre><span class="token number">11294950248384688599976962306787418246673660758505356575766860394805776395527304964697031229229226916712317707338237695034352940576237651096409904433332224</span></pre></td></tr><tr><td data-num="280"></td><td><pre><span class="token number">9215781418083215286411845150601909884052364557328476068262327791069839384136701779059821756106408868935292174562060917720774747706590717488292085756854272</span></pre></td></tr><tr><td data-num="281"></td><td><pre><span class="token number">12770193937065949134650262085427907482230766567827770019383643744172199756265850887986363015861124688534560546437958433152670853043253730543992419112714240</span></pre></td></tr><tr><td data-num="282"></td><td><pre><span class="token number">13367751701435635123036722561485700781540670869100205064435340358861179630667554937325593560752928200354487550021448071324343351602378441252207177530081280</span></pre></td></tr><tr><td data-num="283"></td><td><pre><span class="token number">8697555162077336958090718398909333938434014354717114268605610449537626294161447450492348247600224278121400930296059296277094399369927365639345193980264448</span></pre></td></tr><tr><td data-num="284"></td><td><pre><span class="token number">13342269222997206608096129003860675825114783106754088676227659054753119207784558230691973357466795098193715260189373887250249487175184304431163136364511232</span></pre></td></tr><tr><td data-num="285"></td><td><pre><span class="token number">12192194998747310088734848583310913208359046367344034562719102454022614777904537097476092608983873670431548583856025983512415421453059018338573091193487360</span></pre></td></tr><tr><td data-num="286"></td><td><pre><span class="token number">9217867951835535505957142186266519212642064001657270447184948492558712770675563546551288579989746106536896902503209159961955794433213266838173133691682816</span></pre></td></tr><tr><td data-num="287"></td><td><pre><span class="token number">10998821592922498353496065831794587503924007597677060943538702237790052376519508699893249631224380292123376260184567339883420310905105670976122618277527552</span></pre></td></tr><tr><td data-num="288"></td><td><pre><span class="token number">12388804256736756515598057844134002363007614826978314311027951869264907654628201955261102115682136622705891684937984128682897605738974841556930751803424768</span></pre></td></tr><tr><td data-num="289"></td><td><pre><span class="token number">10134496010647966167136992190368358365216984917878539436217382084771701764614589821798442948888856757383836133685185399248782336507722847164290459557167104</span></pre></td></tr><tr><td data-num="290"></td><td><pre><span class="token number">9963096580193400318939094555615285898084795589298528065156724678856410819299368117952343915009899177449483824427480326824829523350381658617304646131122176</span></pre></td></tr><tr><td data-num="291"></td><td><pre><span class="token number">10484653385928614806386383357909088582333815328188012753526027657738601631481685536308597405285917072473445227176304686322025066317137716792032493534445568</span></pre></td></tr><tr><td data-num="292"></td><td><pre><span class="token number">12663855343923247038191744718033263535515852836668975973935341475271457814002936461342130895278317258315313798420405554998685063093192415903560113659576320</span></pre></td></tr><tr><td data-num="293"></td><td><pre><span class="token number">12257693814176983503069984863610454047004738130748385678929644997850280376838814406863540646889503005876521694089041624852333314319142640700353510360743936</span></pre></td></tr><tr><td data-num="294"></td><td><pre><span class="token number">10955316115827405358959981684570031974093393169739043297081573785679506218046651547007411314425263647393938329483743891956308844874018209274866882402320384</span></pre></td></tr><tr><td data-num="295"></td><td><pre><span class="token number">7551409704636041056733412326325245374506760866514780462377954883832588269259567953744813004809528872033067587554377800352562623624727008346213697443594240</span></pre></td></tr><tr><td data-num="296"></td><td><pre><span class="token number">12685319015122231886323195120727601412640136615031238611724854964851887386684818031444354778049793896894811683503798296921889524410432324480674080239910912</span></pre></td></tr><tr><td data-num="297"></td><td><pre><span class="token number">10598003720773682210724778586361259114292883207341438444316028895407482996666903824943627227530868758997038515444161897134160145160413516512925964302286848</span></pre></td></tr><tr><td data-num="298"></td><td><pre><span class="token number">9622950039562683062371274411248934607728873454855099714883505799360609327980642022718093253915076745984319129663994718749346429930766584228522538980868096</span></pre></td></tr><tr><td data-num="299"></td><td><pre><span class="token number">12342747640921483080074753009133945902540658434248119705428186393487844434352339302146700311037059584651732909315146002671420887595691683728931801188532224</span></pre></td></tr><tr><td data-num="300"></td><td><pre><span class="token number">10257390788897073085404340788219712397937920601046821282482357128747076045523110977852809783429298711088097283953997571716869965275662859847947017638641664</span></pre></td></tr><tr><td data-num="301"></td><td><pre><span class="token number">9645739474504517660897996091126630722966801824499350640175396834844979407686272395333816911499147181960536187181142462053239541148639456599850439979728896</span></pre></td></tr><tr><td data-num="302"></td><td><pre><span class="token number">11218083409327322932911081421709311773022404296997308650505637524673584279906106733424627883851893625064021335965588771610019876875114692958521511448150016</span></pre></td></tr><tr><td data-num="303"></td><td><pre><span class="token number">10752683736317017068444353385585964433066566411614565053317532601065471022280484521747280994193228127001342053260309255682402573170024901566861029226315776</span></pre></td></tr><tr><td data-num="304"></td><td><pre><span class="token number">10971380286122025883575223275546823140293435507759095870005080210799041298488252021009121779624625429834885828678246512587973871396783056033952291241328640</span></pre></td></tr><tr><td data-num="305"></td><td><pre><span class="token number">12656784234031668909552432169007240464997408196228324795080104978512719906135300837195149257870108229417069081571387913851350957042279476855337110317563904</span></pre></td></tr><tr><td data-num="306"></td><td><pre><span class="token number">8624078126800445610827620536918614493957815054040767548810266223482490437557139189682865349874523311921197479220452729344525352959474984583987751282540544</span></pre></td></tr><tr><td data-num="307"></td><td><pre><span class="token number">12936254461828620734632021358154786274929067526465549971763791786106679702104227157954053623767534142775276769906165510915432823386561391667896662712385536</span></pre></td></tr><tr><td data-num="308"></td><td><pre><span class="token number">13162409092390415708942233777486962675102903314019792311546608541828004631088516512779677868093090209333041640461867692212964344211275396229641341243490304</span></pre></td></tr><tr><td data-num="309"></td><td><pre><span class="token number">13362308229583910798494181238443939038307392825021041869317312735437488785765898071143955963891782392606680640275205001730637370867230025137146388092551168</span></pre></td></tr><tr><td data-num="310"></td><td><pre><span class="token number">9497878165273074531426064663221031124389064986618585519613153735562698728396237404329613744947907937823318659122338225070370606841313124915064008693776384</span></pre></td></tr><tr><td data-num="311"></td><td><pre><span class="token number">8586451250995506138106046611295917193510316777660071679310677980514586491411247741791959731373348325128228509918580790972757292300443031751540240543645696</span></pre></td></tr><tr><td data-num="312"></td><td><pre><span class="token number">12432762245321319621893195397857096495978701607337500554000391562664672645058170887834171406745935638819392387637129146157765919819592986293635404787613696</span></pre></td></tr><tr><td data-num="313"></td><td><pre><span class="token number">12726379913897668245505797326110452356922454458309524674890955716979333485467781787871628964008469995888747008652677831124987486105581742157744400716791808</span></pre></td></tr><tr><td data-num="314"></td><td><pre><span class="token number">8043685104675748626437753347289692195511565141005898597271747102112998003856319524554414624904659898092116541972800884419043434896214767514912744892530688</span></pre></td></tr><tr><td data-num="315"></td><td><pre><span class="token number">11051471649625502389608565812152185135684028921842470925253112654552172723657669044932619644150129474118044475479402915497429485943022966226988231854351488</span></pre></td></tr><tr><td data-num="316"></td><td><pre><span class="token number">10818448530384487942732556517326438080991321790172147609950083384068215003378356433527918445937486623586770684056900497048945879397677272131342775200251904</span></pre></td></tr><tr><td data-num="317"></td><td><pre><span class="token number">9080407591770226907112489230022600727980381087489050697128254334708600448461060435157079191778728336179536586614973258413070181997183136662270803194150912</span></pre></td></tr><tr><td data-num="318"></td><td><pre><span class="token number">12329831282218045433761041659504991921568904076868205072066954457020286955707484182365998032946440359910093823318030778120808257025017468279499612057763840</span></pre></td></tr><tr><td data-num="319"></td><td><pre><span class="token number">9260729501475615069174186904846685139071978333188859424285109167804846638183066305882811171724231121670587403874980348458425184867239657008214577233526784</span></pre></td></tr><tr><td data-num="320"></td><td><pre><span class="token number">8361979972708464587127701705380962934767246112155183408138704067376731370796843782112708972621471263897591709967648261284524950329994320966356201967190016</span></pre></td></tr><tr><td data-num="321"></td><td><pre><span class="token number">6730704850573448211347745489745699031798456667048174281825675169937169110494836761319043922964370054131688813819537423508264907693942721628840951822680064</span></pre></td></tr><tr><td data-num="322"></td><td><pre><span class="token number">12959676363748443459358350812286233197161029797438864561546402755996944569694800578053240473231030076468516424878828280118590578616167018532873909278081024</span></pre></td></tr><tr><td data-num="323"></td><td><pre><span class="token number">10981336373541584285817407988213625220988791471031734731807631366156314654006063307634145835451023526096101876160549324421782903073136220455316712016838656</span></pre></td></tr><tr><td data-num="324"></td><td><pre><span class="token number">12964464626489033407530994861694303846735480663047409416489213145175031751996242036989804861432566821386967588809889126172561216690167365991460937192701952</span></pre></td></tr><tr><td data-num="325"></td><td><pre><span class="token number">12844497328976380028995657951625649271492588178823339765638651366688998991905619227054221681698779445107075263686654512651809844164325753237050477001191424</span></pre></td></tr><tr><td data-num="326"></td><td><pre><span class="token number">6797868726787113551160672557896423876149020151148148519582972055933764085125123495187404028479679883962952675444988181508142749924237550969824076141428736</span></pre></td></tr><tr><td data-num="327"></td><td><pre><span class="token number">12264922758371325269536203803896640732484219034026088868573710674380051282344632521298603282726092018794588258498294037588033143797649745925841835134025728</span></pre></td></tr><tr><td data-num="328"></td><td><pre><span class="token number">8523965163182494519663713654552337111906269134262478576515251178240333608603215169329664504777756958285711030093222458033691715641616674482862148162682880</span></pre></td></tr><tr><td data-num="329"></td><td><pre><span class="token number">10469915323116245896965320861885049445316265651544731393659023068066613542479693274450337389698349918408546153514615396401408171880760255545212455486488576</span></pre></td></tr><tr><td data-num="330"></td><td><pre><span class="token number">10359957448205153098439717990620581296261671949215844161700877042737191989395888252412565799399544943020449652128481949040470197115601895283124599707926528</span></pre></td></tr><tr><td data-num="331"></td><td><pre><span class="token number">9563919270976579513029521719194398980432429701574137111665610461212475487412387861066593116118156359147050534176403878860381306323395099620722688372244480</span></pre></td></tr><tr><td data-num="332"></td><td><pre><span class="token number">12325652593635495789192558621520089293422196762004724508551745244966444136420236829489649983402322953232379149134981552396488072584339174971054189187170304</span></pre></td></tr><tr><td data-num="333"></td><td><pre><span class="token number">11044830180606358794806017369055410074638217501212006161751116176616585866671661062909394087339411914357151657568759448412588547451419559733047085548699648</span></pre></td></tr><tr><td data-num="334"></td><td><pre><span class="token number">8138441162751393875467136216398846954756171987487035713840097035487139440519804906018677461109481466411887057057590768472923215971817520339341300264402944</span></pre></td></tr><tr><td data-num="335"></td><td><pre><span class="token number">10508396754481309431658721481126173371239798972370470816893433776587677464253555925575044747652646253158976048187636498224342247022096935254125324911247360</span></pre></td></tr><tr><td data-num="336"></td><td><pre><span class="token number">11466558428364460702223809995496313689012057342325370412472983041642643366741173596946800572162911388661565836767800507024277297438971055600583993196363776</span></pre></td></tr><tr><td data-num="337"></td><td><pre><span class="token number">11097423506245526802281059581022824625232594276077232976811665492468720221997992789633595843895958375699104185029820864600939983502481865030540785761648640</span></pre></td></tr><tr><td data-num="338"></td><td><pre><span class="token number">11089225936803264325350087755017097707463652341245932485425982618181217493839336878891284209985956972742097026180900863940544333930780231419867296878821376</span></pre></td></tr><tr><td data-num="339"></td><td><pre><span class="token number">8802314598025299736643980484205205655182887318267368527233259482363153262624315356907143826107782624910292378898918842466939475560515913817473592738316288</span></pre></td></tr><tr><td data-num="340"></td><td><pre><span class="token number">9611454180284216108407030344403793337520642722016453426098864133159964859075512855120132129722303728724315900727260398641017044115875418144889971434061824</span></pre></td></tr><tr><td data-num="341"></td><td><pre><span class="token number">6953782026609462329700066739292601270384042666959047604066062528049519313752401889539344879012131209071354928082867539168093524830019982071745281502437216</span></pre></td></tr><tr><td data-num="342"></td><td><pre><span class="token number">10230315793774198345174343844471382345886987834988225888621561803558030611292497692200178725312371587492518679396052408705840392044954134194413240127062016</span></pre></td></tr><tr><td data-num="343"></td><td><pre><span class="token number">6918514772197443752350812194902164958605865983770951504368566057568816575153401861213001899150723690523211051106538555673280170724719441783071197710254080</span></pre></td></tr><tr><td data-num="344"></td><td><pre><span class="token number">10776335169547004997109885270716501563423222575018728357555768922223634803064255960918592785579011619941691444020740751994173356182399679221044051148013568</span></pre></td></tr><tr><td data-num="345"></td><td><pre><span class="token number">11316274706862328145750861082453709669339733192523343018096782721099152467111963794017595110655123947793177798263935342380153942552306534784665939011960832</span></pre></td></tr><tr><td data-num="346"></td><td><pre><span class="token number">7202504423752441999330730679073866463070140339541747813609370393687032765271124760824190983939208125195221156025350588722447346942734314876714969437569024</span></pre></td></tr><tr><td data-num="347"></td><td><pre><span class="token number">10611018184185789979945940399419762414451704937655005122651401138848541046488405840862774254911078082299410330245912197196312194191632762320438203672166400</span></pre></td></tr><tr><td data-num="348"></td><td><pre><span class="token number">10688570561196880323377074837416612902688087129868570977235989768789055019571463166388919367586677238381884736565792983465351253432932694452463356383891812</span></pre></td></tr><tr><td data-num="349"></td><td><pre><span class="token number">8406052104465755835727648646594543608361738524437895387202276925310088333406282241556303406290564787008335539768565719011475905508980824522650544081207296</span></pre></td></tr><tr><td data-num="350"></td><td><pre><span class="token number">9060582081714150194935379351216604184304820767571595253401269077619403508272877548730640116262283644036774709540867376813965858918496955780392023226318848</span></pre></td></tr><tr><td data-num="351"></td><td><pre><span class="token number">10432471436686640103122472152999545577687503990867750771549008738610777757344889944545426739621812964683356535362811172270820979790461882067844662049112064</span></pre></td></tr><tr><td data-num="352"></td><td><pre><span class="token number">8358848490714843458110550161664106238107498452462342846213503631579573670594174822905324296945127256253219445269083934388409002103661987332860431842672640</span></pre></td></tr><tr><td data-num="353"></td><td><pre><span class="token number">7127566139471602219245875471438243708417806395301866640104336057178536316922839999670340910721173246981696043809980705746541808916010637544357762456092672</span></pre></td></tr><tr><td data-num="354"></td><td><pre><span class="token number">10950514845680372444637981981904634254497120390539118350987343081473539621536865392608013393236075557022999635758033202879001418198654273559626465509638144</span></pre></td></tr><tr><td data-num="355"></td><td><pre><span class="token number">8369519203089805039869996362467548215000596685946618169824535190446197689621670518197404206980594013973051082241624217831957615731174316725262251083169792</span></pre></td></tr><tr><td data-num="356"></td><td><pre><span class="token number">6910906526133235908255402790161930396233290332565795245313467403753798754390864838002416393174795741671048045724920306463129413211441150724331327423774720</span></pre></td></tr><tr><td data-num="357"></td><td><pre><span class="token number">9474235646323939999931242237560858277697753072603747941750343677306635603669291795878249822765269272896639265218956465010699394895458604061735984849485824</span></pre></td></tr><tr><td data-num="358"></td><td><pre><span class="token number">7000440238454336329210647581641617675396025941840743014668150590302492694527212849919152421607523624963871205239334266134651126702346689832198245565071360</span></pre></td></tr><tr><td data-num="359"></td><td><pre><span class="token number">12707724554958946775711176318723361273315885685071809037256962878581080225948264305930972821739802635265548677737786609239986748315482871665553324107628544</span></pre></td></tr><tr><td data-num="360"></td><td><pre><span class="token number">6747322042976722250635078987063777247770608684905505629860544496799533349275443926505569117163221144433851418966973915818202293086402600343057746681135104</span></pre></td></tr><tr><td data-num="361"></td><td><pre><span class="token number">9944647990054639897250787341210994958322511050674423743126584015661550468604249684510356341033097016571883202953970524534493500793836687442067380259258368</span></pre></td></tr><tr><td data-num="362"></td><td><pre><span class="token number">7427860913342197054011179294671496119743079805942391861356138680647059848177007464933872458339842884818441474973227597833053726945057387114000221204381696</span></pre></td></tr><tr><td data-num="363"></td><td><pre><span class="token number">7937483715808890941161756335993545173657437442092937579256631387941556915910683270216598663856918031013908373128390839153712490885460300980128777655812096</span></pre></td></tr><tr><td data-num="364"></td><td><pre><span class="token number">8153583920483139027588114369369525083523708153753073502843366329225340929359804618852906046817830730215875719358595332157798202136835299230457518035566592</span></pre></td></tr><tr><td data-num="365"></td><td><pre><span class="token number">7917138210277973321057060274783492601520051474194744049646309775492907693525589192295109064197161324792714006614171061776426171252267729869183738055753728</span></pre></td></tr><tr><td data-num="366"></td><td><pre><span class="token number">6786555507145266152828499076532340249567735224179072345007298475277545278651289783928653427602257421515485933834674709243374167362352820411302772293500928</span></pre></td></tr><tr><td data-num="367"></td><td><pre><span class="token number">9196215075117172522496602252416041918465510132629659799712691147361884866374810710070260427671955490662695534726456653106065817204471345770747394116288512</span></pre></td></tr><tr><td data-num="368"></td><td><pre><span class="token number">10324560277027274981411808642117542917974455774558051763255452473445404564415631726160906791063549373715776034775213115251159070641745722398538715780612096</span></pre></td></tr><tr><td data-num="369"></td><td><pre><span class="token number">7738873616079787503117791912917880892944354947046151630340675137231078612510271447169320020415764977632721298233490032546400657769088501460743668296056832</span></pre></td></tr><tr><td data-num="370"></td><td><pre><span class="token number">7430182111716760081161613135686533543046374030684411163958237309533985468471695974710671132929315604998742747953108438391402656867989632746767082292510720</span></pre></td></tr><tr><td data-num="371"></td><td><pre><span class="token number">12829910061538955159009717184395165477851115081704720407749534407816839016426821555886233193435164837647736403244224035545192282877510123585427454096834560</span></pre></td></tr><tr><td data-num="372"></td><td><pre><span class="token number">11519652765949032182701816181146626776155749095402270276002795472488944308918491436038561562065704239267747966916987913438449819047692474704170665348431872</span></pre></td></tr><tr><td data-num="373"></td><td><pre><span class="token number">10561704101275816120814634492015257318639729924358444884390408049762149709915290027775438865974080108389562746160552164261056171683087502492088746524016640</span></pre></td></tr><tr><td data-num="374"></td><td><pre><span class="token number">12867831124264078252755713901669592304302809218244846414458783401644322352268064323555091401570203164371293394547961201104221077633905094627383853348552704</span></pre></td></tr><tr><td data-num="375"></td><td><pre><span class="token number">12127778252317631353231854097392845679589520186698386606657398129800043974626984558790400973526355061205331614539896956742959867216582599840079402032431104</span></pre></td></tr><tr><td data-num="376"></td><td><pre><span class="token number">10489292998533014747020792808672132216544598921500181317635140200002129292286205364303335117522067653400534935565306852068010410913319143236253162246504448</span></pre></td></tr><tr><td data-num="377"></td><td><pre><span class="token number">8752851361783265457036541256085211157608071244326222463604938567771975001690645911497257122174217099780973712111925116317253205916999095850275981318160384</span></pre></td></tr><tr><td data-num="378"></td><td><pre><span class="token number">7927123868094147652865056932666688454869613701590055383216547298378157442181913840955500506951302099363318908140233662534342107518498918397318303890538496</span></pre></td></tr><tr><td data-num="379"></td><td><pre><span class="token number">10238412524424973159718873564408456567789336444060587663455142741132431349941368238463884399390761195778631274524571773745239777165254087583207349431566336</span></pre></td></tr><tr><td data-num="380"></td><td><pre><span class="token number">11530646514493477919615288333395067004825981476184477464375473437117238614103903284317901353331691896504727161661042643164758995326711437084525230020362240</span></pre></td></tr><tr><td data-num="381"></td><td><pre><span class="token number">10535546128195845571085073159629281133265611404758364094309267858162219361231635906728111165562548521060848645304648896271566304501431063038057159380172800</span></pre></td></tr><tr><td data-num="382"></td><td><pre><span class="token number">12582425324630551895805640948668079025998002717526398193835466217848317002643371182492979679503086866138178250190072276998858808480863816937947397732958208</span></pre></td></tr><tr><td data-num="383"></td><td><pre><span class="token number">11918247895946553023798808005521181668835476438229606540460798749117430166021979527560080694978082965183352654026899133110214517431379544549210780887678976</span></pre></td></tr><tr><td data-num="384"></td><td><pre><span class="token number">8064243734824246008672510708854521793373589734545143895991959362007433047352726039301242670286053328772317811141197656828592864086297641780821118091788288</span></pre></td></tr><tr><td data-num="385"></td><td><pre><span class="token number">12740153608387820445316556176676813890701984266148987004659552734551670203489767285079433398679850829470062407925043250865426309507252893311424228457709568</span></pre></td></tr><tr><td data-num="386"></td><td><pre><span class="token number">10782548662409891319823446861350111607401618899665855416557961766508664725356997983785491684121528293655020737516182873904361643062146484717664169879404544</span></pre></td></tr><tr><td data-num="387"></td><td><pre><span class="token number">7057203261939444905433060171873642404851978443155838796022731746087438893030500919763059975207078708220847794757665609262520363954056536750400244312702976</span></pre></td></tr><tr><td data-num="388"></td><td><pre><span class="token number">10082054500842158275807312814935967732325965045857711358979559248110022480461636130633733474152048941237047165813738112588049621360382876760392853775974400</span></pre></td></tr><tr><td data-num="389"></td><td><pre><span class="token number">11891506085376577597375281601901325355870648776182270091605299006477250535448260416989164147939128440350789442415282209672441660859696038143936132116643840</span></pre></td></tr><tr><td data-num="390"></td><td><pre><span class="token number">12903599696652659383524152428599524849779437373538920362551500040049051878185883306818498518585654689514869820455537116840067321170411824603429600239812608</span></pre></td></tr><tr><td data-num="391"></td><td><pre><span class="token number">12592509858849356565558212896606518732496688200562445075371112638571750841436671624486076730674689761606693712646763287306890669344734421321833617398169600</span></pre></td></tr><tr><td data-num="392"></td><td><pre><span class="token number">9433657488064812525875399543147917307264269459051324766647514265552340271074648307053006654952887553122369488058909877514493865370623798443725181360799744</span></pre></td></tr><tr><td data-num="393"></td><td><pre><span class="token number">8188402842730379385265804570643840632242783807058505672923363671918414991707880001448919146225316283710042577984395086812027147359226779549118236100395008</span></pre></td></tr><tr><td data-num="394"></td><td><pre><span class="token number">12707132939086480688270543789383204255356685922454642560661192980216920807555058997074953473082741088034588479000196361304941574096432075522224371154288640</span></pre></td></tr><tr><td data-num="395"></td><td><pre><span class="token number">9218961255479107476559711539770810455899748595618651766289925020077370475566683035849826198363229157725245727425573623967878695640345077415158289602183168</span></pre></td></tr><tr><td data-num="396"></td><td><pre><span class="token number">6703903964971298549787012499102923063739682910296196688861780721860882015036773488400937149083451713845015929093243025426876941405973284973216824503042048</span></pre></td></tr><tr><td data-num="397"></td><td><pre><span class="token number">11326821630886059835524991665884041373999833383558041598702439853782246282918073309553382874946602688103589886623160043335895074408641487059773552607625216</span></pre></td></tr><tr><td data-num="398"></td><td><pre><span class="token number">9525749285467547714370512538013743741257614570701400619305394686126226028260892452709433063223772924444009938503502182512128319761835291567895122469191680</span></pre></td></tr><tr><td data-num="399"></td><td><pre><span class="token number">10380267591780048106760617116991921336863660050885266422125094069434433423556123365818196231616714274896220094256806847684666944251593118547720829598171136</span></pre></td></tr><tr><td data-num="400"></td><td><pre><span class="token number">6933552345316108226673220415442622108303961636919151441607567829661467504226477540221982734114494302045014908117786690594360755345469997827512482983313408</span></pre></td></tr><tr><td data-num="401"></td><td><pre><span class="token number">8202772000905561212688202973535255679444796345776113058988240414326993206235534787800747519361420189219326183583122762851474350749378995305705537738136320</span></pre></td></tr><tr><td data-num="402"></td><td><pre><span class="token number">12736493130088335938832510710919846070828426899593825324656971547983777637646195923101581479412454649160917281470742617769793475960759341953145406595530752</span></pre></td></tr><tr><td data-num="403"></td><td><pre><span class="token number">10291592449267332328780313133154187495546614346532643536805385500818584146354039022123838785344275049933619531823123604935483448383937569930775756506398720</span></pre></td></tr><tr><td data-num="404"></td><td><pre><span class="token number">11350131325306228180545402747326696693237365178003825458027711794731878275246497600107671216856043023300345757007270248525664581430787325477974927986393088</span></pre></td></tr><tr><td data-num="405"></td><td><pre><span class="token number">10967031350890818606133759253255722173225475163199744339724959087217762304895170722818380402137943597616801629914529778247757037557718276256584297147793408</span></pre></td></tr><tr><td data-num="406"></td><td><pre><span class="token number">9555022142052867240426081057553689747728259012627497449507996272728577911945442293326176881005771692419234509481195891117852003277980494780119605288370176</span></pre></td></tr><tr><td data-num="407"></td><td><pre><span class="token number">8818146071480402318187514658941755384358086194106035845971134705575387044398212914035812421185982573229825079448777877790284870556938815189444664940822528</span></pre></td></tr><tr><td data-num="408"></td><td><pre><span class="token number">12021197452388071733166530792480282724654473909642357169832985065873693431580288189202378678396403795284781571791404267144796475879832416461907442653986816</span></pre></td></tr><tr><td data-num="409"></td><td><pre><span class="token number">8189380136474168326062499003221292061712604931309149728128803157549733858338840816701025129476285971099152205060196986652193692568143982908069894200229888</span></pre></td></tr><tr><td data-num="410"></td><td><pre><span class="token number">9124481445295336096308220674923628029357257146609974868751816803873465354260672576764279124276027375370439822088191463229060977238946857586246121802432512</span></pre></td></tr><tr><td data-num="411"></td><td><pre><span class="token number">10680348926622073695820845419437940859277394065496850802865052839955369457126206957150021812387462662800395007505281051332944554833981856782416388072407040</span></pre></td></tr><tr><td data-num="412"></td><td><pre><span class="token number">7735536317530607799769577687871327163883175862778617626240006044698096459959162392669469772236514390217795451434903810454152118619295545187366590520229888</span></pre></td></tr><tr><td data-num="413"></td><td><pre><span class="token number">12437262544901686999821001855943571070358106430345585678524081097009964710023372037198542614938303061648485070695423134915315409457006134179763508318568448</span></pre></td></tr><tr><td data-num="414"></td><td><pre><span class="token number">10960785551646540453958980257507970106967480943417858973767296466223117729993801293131482022622485589905335082514148880453538047941242766365729181755506688</span></pre></td></tr><tr><td data-num="415"></td><td><pre><span class="token number">7535058742847031652780680763376714130861545281733360707832489077420917407139784577317185036149964707762104311727694112655716486540349001916735320785682432</span></pre></td></tr><tr><td data-num="416"></td><td><pre><span class="token number">11937962993384635493379940568611756891642927854075822292673936244422290488004358098643217956968542591970074438098121357858272078694061415693316454891913216</span></pre></td></tr><tr><td data-num="417"></td><td><pre><span class="token number">9189089960639205703667529652350805956635663144434953955713409749742504499564381269718635557313732781455526443897103580840221241116324933414773189022580736</span></pre></td></tr><tr><td data-num="418"></td><td><pre><span class="token number">10080730148692408213594071062660137293608605435688756203362762801971329921680920733367394212789839695943017534080563568883649709788845458261286819368796160</span></pre></td></tr><tr><td data-num="419"></td><td><pre><span class="token number">12265216669259905496183988256932432450424852555892607364857551893890205449763830527479999576032051141118005491854998499170790536735938076403297755932393472</span></pre></td></tr><tr><td data-num="420"></td><td><pre><span class="token number">8732916395617800125513624101447899652690518575320891309054676634769390260725266773158938191932048860931623081358806701179820822586322994613355859501121536</span></pre></td></tr><tr><td data-num="421"></td><td><pre><span class="token number">13182202029076820133332847800278097413561183084937266604798065543604082737911672367365807728931661583285591796808842274113603703351565799788596353755512832</span></pre></td></tr><tr><td data-num="422"></td><td><pre><span class="token number">9848401826168309593677728557924653240665014303998696922109177991708581460622060620227236538150361549130974630035033795974484046604641780357319791317352448</span></pre></td></tr><tr><td data-num="423"></td><td><pre><span class="token number">8187922678971417250311688940368785698622320582943175406193973316426893421784488327715618810826605906172526425890629876939978751179769396339164207149744128</span></pre></td></tr><tr><td data-num="424"></td><td><pre><span class="token number">9899594624883002125911401958384252930216731683904629515763836676104452887777246943566397749136973406415094315134011940247934359133976833775420276503216128</span></pre></td></tr><tr><td data-num="425"></td><td><pre><span class="token number">9924209489033381513690719598033833812461661007569534788491845030720380750226505213856030190216824227770151255127497982686177227843971159296770853141460159</span></pre></td></tr><tr><td data-num="426"></td><td><pre><span class="token number">8783499228683109906408527129354359249434757989936509925008965630648662764515725298415669992135517402011397283532154060764651272864520783873309754236338176</span></pre></td></tr><tr><td data-num="427"></td><td><pre><span class="token number">7262740076950818736651792932503439455200292706997045440869063806091467330648173865206618098395024583394156604576233818412037683072381011247520837783257088</span></pre></td></tr><tr><td data-num="428"></td><td><pre><span class="token number">9325871313233974556155067718665428145878109868825589075875669098429288482831213396952404555749556317320321455597523656097994964699891160094262243434168320</span></pre></td></tr><tr><td data-num="429"></td><td><pre><span class="token number">7874704475244577335429234461293098206298678761904134857013100681118479952587806462765551175763441709838334382409544601405426891602819162142435479094558720</span></pre></td></tr><tr><td data-num="430"></td><td><pre><span class="token number">12631256105379784580039462922332214929395304842564036568800261637805297451064468506708502694535078266799884004367555966995765429001057125015902765113671680</span></pre></td></tr><tr><td data-num="431"></td><td><pre><span class="token number">9751062670107105011089993262728949132498194702531381377010584212017401720555534493701001402502281703805640359719449619453992270601494609267293568234422272</span></pre></td></tr><tr><td data-num="432"></td><td><pre><span class="token number">13053242380859007489673451041885418155567397940330138186602326090107358711676567485496852298175883609547730010393639453031986262863424686905650363414609920</span></pre></td></tr><tr><td data-num="433"></td><td><pre><span class="token number">7775619722005732654611838649257630965860924523925491514371710667239700195293249261125707784975231623734084551867272116644211099052041192077766553174540288</span></pre></td></tr><tr><td data-num="434"></td><td><pre><span class="token number">8760551713956944298544162994992883636635821821018919287639902531785758230439558657100729671146154829496183342502734809364328547425139788284924157006708736</span></pre></td></tr><tr><td data-num="435"></td><td><pre><span class="token number">8950920434248129918272334941894327193778428976329410073337599976491011757624874639850844815828501760306590094890535390647077495031761131729025378927247360</span></pre></td></tr><tr><td data-num="436"></td><td><pre><span class="token number">12995586689823525369927369048377126885188816504285874271234867118215289574552011420168338642004107234562587397852904860922187629103480699171239392456998912</span></pre></td></tr><tr><td data-num="437"></td><td><pre><span class="token number">13060927090208023611284332908364837435312575685910376931495626476073014270234588742519382599315012687612569704834012577296129303213448795128278208187727872</span></pre></td></tr><tr><td data-num="438"></td><td><pre><span class="token number">8187602709067625237357668940743900619075701254687274826718057352811701873347416442424503628288255620165682064372265790613198892753731118078041135041740800</span></pre></td></tr><tr><td data-num="439"></td><td><pre><span class="token number">8934904899538636279165161058026333615611178341442107339285814319603621091443537561664340629161044055681952099840647928229297837164658843333965926606307328</span></pre></td></tr><tr><td data-num="440"></td><td><pre><span class="token number">13261554534030537547829470438442881148678994595176277021712877251254266157828994328839250059715583544804250112350084350880291289664822547514644173842022400</span></pre></td></tr><tr><td data-num="441"></td><td><pre><span class="token number">10524399321499675418235733163468108878305647971154130707773846971261292305371513687131152534273965020803839111062701670385890926945863506587423513082068992</span></pre></td></tr><tr><td data-num="442"></td><td><pre><span class="token number">8514248338765998013801366145716262860249912041847338976624130963531874895483493444826279371221374214127698612955792898147356747221072850963291326780538880</span></pre></td></tr><tr><td data-num="443"></td><td><pre><span class="token number">11390979176485677071546136539489862449793371579308073051361292650120194286245347975392808785502325755363951525637600057632061990480300736188837228900777984</span></pre></td></tr><tr><td data-num="444"></td><td><pre><span class="token number">7656579737441119032367708948603478670759268636948605969175014141167068891947800847999790880619407926304367795354900226056549048483704636990715065630982144</span></pre></td></tr><tr><td data-num="445"></td><td><pre><span class="token number">10315002988789997783450158795746178747921130132513152619875002053161770154169637214111423479445251745034115247772072289282132855321152589264141094142083072</span></pre></td></tr><tr><td data-num="446"></td><td><pre><span class="token number">9419181633383323119021165296516444294560746108230668419618004355214594461973906803897980138039908579438942286575467620647437281091149323538921712020094976</span></pre></td></tr><tr><td data-num="447"></td><td><pre><span class="token number">9722319938679056649068536479215160891906533388547658666362822543230350019957718981497118689103191251994576274786442148962184903668793699319496565009154048</span></pre></td></tr><tr><td data-num="448"></td><td><pre><span class="token number">10566533885296884303014175578580898399432287070427333877481024070104058743106944997627287393784555274437334696341395676884006411672588925867718136515526656</span></pre></td></tr><tr><td data-num="449"></td><td><pre><span class="token number">7864025647292655938288949358220224463274725365464623979001778709349185260032907494154263414325130549356382246334419953434282826933683400719428886313566208</span></pre></td></tr><tr><td data-num="450"></td><td><pre><span class="token number">9490891133530826594397834989836052329945825327690975504770239829117082976776257361897901087838454291916373831325776418669049288626163994712238078958764032</span></pre></td></tr><tr><td data-num="451"></td><td><pre><span class="token number">12194372674481041434034472232381036170051319157741545885521115375655140297687073160813084219505942400076144873358499868313500115444033278627346597428592640</span></pre></td></tr><tr><td data-num="452"></td><td><pre><span class="token number">7371675648982111491269703197255753290791877887688981905916372160952493309503327097597124247917936161903796812655265279912757261741333905156095844131274752</span></pre></td></tr><tr><td data-num="453"></td><td><pre><span class="token number">6984806023239421752888444897352204194647838282632743190981649032020896705363091950590689105978233030512522536699703185349700335459851397196491137849753600</span></pre></td></tr><tr><td data-num="454"></td><td><pre><span class="token number">13213623763972962156815296946145410086345810869603695388454869739072920121025572432011502420999187460416558363581021258728468469988927119700150315674238976</span></pre></td></tr><tr><td data-num="455"></td><td><pre><span class="token number">11900603457261632672110939658722248372981149730330113618524804477883622120937182047599280566304374588623430886050260673179507411949378566962864288914472960</span></pre></td></tr><tr><td data-num="456"></td><td><pre><span class="token number">11129158612454421873603456785475052554294161042582944494593038350010574287152950544813251559613227831804874306911154838598477332402532928364280527210938368</span></pre></td></tr><tr><td data-num="457"></td><td><pre><span class="token number">8876335673956996641316312901882670879221335450681449117000969147082745060902247697485147391841211340765411811358493810365642540830320302586398114270150656</span></pre></td></tr><tr><td data-num="458"></td><td><pre><span class="token number">11726668894950682487428958354899529483261732611913166896392371034043101203352580332157154303725578794943594982828334586211658854305094592264037426282889216</span></pre></td></tr><tr><td data-num="459"></td><td><pre><span class="token number">8734937321895496924911362547054298397793241410042842297062903339942606383701235014072097542137835259479790195816436660320564288922510196981114096041590784</span></pre></td></tr><tr><td data-num="460"></td><td><pre><span class="token number">12277522465221480407307941107394302441863977497817685900769996381515300681043644424485546260561136815321757184428182322943778200981221328537106042715111424</span></pre></td></tr><tr><td data-num="461"></td><td><pre><span class="token number">7218948516297425217405523717912974876037163890150717757884771000064809934340323724346131661008105652044159733121053255327576001245627806004702408232402944</span></pre></td></tr><tr><td data-num="462"></td><td><pre><span class="token number">6948524758361941138598442108404127521511938746011186161358395964059792051707999846486442182841557682970895439343010245578018072142613437208442356900036608</span></pre></td></tr><tr><td data-num="463"></td><td><pre><span class="token number">9418039442254039140822469354409446842941373627945855814994557479978453655359648150416800289841622491898586855863022617262017002806381516723153647953772544</span></pre></td></tr><tr><td data-num="464"></td><td><pre><span class="token number">11060798244819944838475852128410388929464972731038214416005194244544450241711068244486852731060886845057206467997174735994302177085518507677336222509826048</span></pre></td></tr><tr><td data-num="465"></td><td><pre><span class="token number">8930834591219377630620615864150612000914196085492719282213705227279186741966436767743952890581264695495837396977112344292632395879028425573013778962841600</span></pre></td></tr><tr><td data-num="466"></td><td><pre><span class="token number">12475846297330657757657567845157058005707006968319494902409162643206262656801252364457323139152117663765390010015184242319379182277930864388259586403991552</span></pre></td></tr><tr><td data-num="467"></td><td><pre><span class="token number">9079311465010681625865490141130488492277143950052103845392601050118518607324621931407870163113013694634994527076622281331268770245981961685337712109813760</span></pre></td></tr><tr><td data-num="468"></td><td><pre><span class="token number">10317899821864294260488794955029176836851790783636865502897863586081464790084369201454453657127804510526069894331324123550970994061251536325334467939926016</span></pre></td></tr><tr><td data-num="469"></td><td><pre><span class="token number">13306968871265061639172714668553405906986990363338442737922847245577151812326911569672338256444119651304975662070066666683880617507332166148143737387089920</span></pre></td></tr><tr><td data-num="470"></td><td><pre><span class="token number">11772998973951101528328202031465345952403543702829412436858635667003876285817916382857103334656820121107238355698644545711835639861040815795801231621881856</span></pre></td></tr><tr><td data-num="471"></td><td><pre><span class="token number">12830301459262760590854285901819338298343836389564007322560548275453947242348139726597159198264819601201910056702886765313925651969210856291854555612708864</span></pre></td></tr><tr><td data-num="472"></td><td><pre><span class="token number">11759221371202112466969452651357460248378160464304340219471669158161753916969655485714060988988234685419152983817708183046591857415891388313344209816911872</span></pre></td></tr><tr><td data-num="473"></td><td><pre><span class="token number">9914131399700081668552441884359674789260411941432763883906619979820256372647835185049447602789956976346773930342791486173084661872939079195456442550190080</span></pre></td></tr><tr><td data-num="474"></td><td><pre><span class="token number">7082288760978693311369367154465739293348114689535585499053253672289926248831066271510777190746617932080034198871098347081914078403378254502440253245095936</span></pre></td></tr><tr><td data-num="475"></td><td><pre><span class="token number">11163473745950743654976291137186305428755879030368863139978623882253290504344557150301478047951750772131143086527026681341698557500258190098803247309389824</span></pre></td></tr><tr><td data-num="476"></td><td><pre><span class="token number">12205228447043337389052994806278976270050208777700002388772624553272765776402060935903544393179741862586426041994834317107420009642142525188151106871492608</span></pre></td></tr><tr><td data-num="477"></td><td><pre><span class="token number">12291965532166200680444217594555979921940536713597571400376976608343973688804270241978307886087015367210699257341541379859701217735743052929401956358684672</span></pre></td></tr><tr><td data-num="478"></td><td><pre><span class="token number">7199252705623680054172832253714911504368820357187284656427028754750576713743544673446046375511097099145647749589203251072698309352576160720776663821975552</span></pre></td></tr><tr><td data-num="479"></td><td><pre><span class="token number">12311544724659857443869748629571908436993513343114373318287975901114244591243890071000818873139148983705523802693866917115723085304115554127219593243000832</span></pre></td></tr><tr><td data-num="480"></td><td><pre><span class="token number">8313629699881582383752912583197264312440429783265380676255023930910934490469520579942794876046819267308427476633555054800837985651682610757015008687685632</span></pre></td></tr><tr><td data-num="481"></td><td><pre><span class="token number">10551832996136958487434201903273602227034927637033235145090327110993401166769781809985247066014768325943440820654676152960392154421205272395202461744234496</span></pre></td></tr><tr><td data-num="482"></td><td><pre><span class="token number">11915399094770479249663752042169751547662831624061281709981549788149911503550241949578450971214081212783522638520673960321783365067386414937437643636473856</span></pre></td></tr><tr><td data-num="483"></td><td><pre><span class="token number">12311096663557861546032469291543897504914076921343396421170196516664994258450462527107806650874332323368658873623166392593754010619367811625102746006323200</span></pre></td></tr><tr><td data-num="484"></td><td><pre><span class="token number">10357899388963105584950303665018872019260704796985186530331352264688090999817124182076290943533346549111984882545972856232411470923239748092951741903929344</span></pre></td></tr><tr><td data-num="485"></td><td><pre><span class="token number">8132187527058245030394525599457264751132102649230729826818996991972241436289699549442281687989902969080423950766433642985266873891641306829021375549669376</span></pre></td></tr><tr><td data-num="486"></td><td><pre><span class="token number">7511899722696541428507918840781265514488894004099834016721586657674643476410178414441200374689491102586596716570428193362108181668462721147670762367221760</span></pre></td></tr><tr><td data-num="487"></td><td><pre><span class="token number">12569713115235292561061618925342961514318895547973603595825239647492062884849116457306254720880983034366184063126493718291724050447515017154186674178097152</span></pre></td></tr><tr><td data-num="488"></td><td><pre><span class="token number">8738174989246941886566612077332796079309775635378436002960863175666555937062274123644752740232862124642133210646067451576542386260453179678146809670139904</span></pre></td></tr><tr><td data-num="489"></td><td><pre><span class="token number">6914571597537336683731086973884232046526708094997826528203083852574821221088452195312400073233477324525151632839675698268023489318197334681087179520737280</span></pre></td></tr><tr><td data-num="490"></td><td><pre><span class="token number">8960527010599279296593611101395532634592584682799395629703880800256771164620119478745172387421882173313383473288068188562137601926393787092928903289765888</span></pre></td></tr><tr><td data-num="491"></td><td><pre><span class="token number">8233209429251927438759584461264835726252278846062478480610151297232984789284402456152456297436445223967155566180608065332488505583909258606494429961256960</span></pre></td></tr><tr><td data-num="492"></td><td><pre><span class="token number">12005126691965509389168493821318330261066032204053152512520642139438046173656733217876576859613520464184127151186568935922749098511043895189727564489818112</span></pre></td></tr><tr><td data-num="493"></td><td><pre><span class="token number">11309340184120120747834542894120899648529452439180106576416224396692232201269335268061849972013154798658760227989110388770886718522934480525089596480251702</span></pre></td></tr><tr><td data-num="494"></td><td><pre><span class="token number">11399317345423843301973051546528706172801100461518805359195076322736656823562477022369815268342041626668395014926999610169278135718364278992095235643801600</span></pre></td></tr><tr><td data-num="495"></td><td><pre><span class="token number">12424585005678020830669055610118471347529005834665752999308585197869692358816608440948663546319129548328925596703492537121552875300765446638500345720864768</span></pre></td></tr><tr><td data-num="496"></td><td><pre><span class="token number">12000905517031952285353476197350867834418799692687427058065265035083203676751173729071783157910241970026487705706979509237420562201952624033481333271429120</span></pre></td></tr><tr><td data-num="497"></td><td><pre><span class="token number">8078244889307818146009635909045797301870561799619780125575946230785796158929282595336740488512769501737187731395399312370064773931360344668287810047836160</span></pre></td></tr><tr><td data-num="498"></td><td><pre><span class="token number">9541246385733707340939235094644462899769642264295169284780896155475194329872064324021086263721012394303185508188893838266852664823501613266907307297472512</span></pre></td></tr><tr><td data-num="499"></td><td><pre><span class="token number">8487536168941916110298706161724162821162301105007557670573898208258365237516721914344756184409577513755048970160813732847028479928850718916561485504184320</span></pre></td></tr><tr><td data-num="500"></td><td><pre><span class="token number">10122847672976464190439163583015324028263633300970588599491035419682539412393388441486177451280725640102073109396284076137685098127908008579687298230542336</span></pre></td></tr><tr><td data-num="501"></td><td><pre><span class="token number">10723734716712978406736480657616253111119052658144129890922060516419680243162460415351299004872934183117973712473144028367992820710890145784052278110453760</span></pre></td></tr><tr><td data-num="502"></td><td><pre><span class="token number">7203285674315561793044654360547563110937089111838753278794160031587752610370432218182964883240431170766596175404352752549828478539094620657436599777230848</span></pre></td></tr><tr><td data-num="503"></td><td><pre><span class="token number">7955898176653179932418497593991225831545038763504012906189810267295815742488417828747969887499677607056367269251471547685439352159649306025667157410447360</span></pre></td></tr><tr><td data-num="504"></td><td><pre><span class="token number">8264261818755826736762666729972970890238784874556691020015771523259733379340275803931547366464972259300654934851792354302123298877025213611576695348789248</span></pre></td></tr><tr><td data-num="505"></td><td><pre><span class="token number">7042055426916364870789828072460869801180573220723799710477686967339327543865272409793860399054415726662219232792566316330884456221510541827116398792409088</span></pre></td></tr><tr><td data-num="506"></td><td><pre><span class="token number">9254748836368585526828748594890676209143468637329208460230827986972211889674199936078843084941989975095044185751889319252737128215528792760406189356875776</span></pre></td></tr><tr><td data-num="507"></td><td><pre><span class="token number">8393737578252954554776825061380054812016632736164165938675255094163231929438736071032201320106515786029828878486990247948898499707114694792954259903086592</span></pre></td></tr><tr><td data-num="508"></td><td><pre><span class="token number">9176562562484493466770443721318843385915898429667653632046737687384332223673276558187594878754673184660005201435691868792177330865121633771344973069811712</span></pre></td></tr><tr><td data-num="509"></td><td><pre><span class="token number">10462603307603789997125975389845353528129934671628293951709190600275915067685619710115658936910028722190411083941702173910931250541823177424248485764399104</span></pre></td></tr><tr><td data-num="510"></td><td><pre><span class="token number">12470521411843705717984528321123624582245149890879425640996916737057974512426275685856779219140499298280587427897540115024440866073673436825461992089190400</span></pre></td></tr><tr><td data-num="511"></td><td><pre><span class="token number">11361308932884817480073836669612223871500107045310693047159921519142870311119942968454117121047632663984493868668097160623457450138547656625083001270697984</span></pre></td></tr><tr><td data-num="512"></td><td><pre><span class="token number">8860744691644278533707008159231293208286948106399555041335701198464119784673096886177259707326692843976314287562757923427924255139812651280473839936471040</span></pre></td></tr><tr><td data-num="513"></td><td><pre><span class="token number">8146818555930710424301030127802761237114061406048246593561355029567778672284717200214558115526628167372733946325455616396339582059106539512999046071451648</span></pre></td></tr><tr><td data-num="514"></td><td><pre><span class="token number">12039203989675108877478282356551662894079377170214066692489219895037116895380253661990783863134613018645111023218636815511064202271341163307667509978595328</span></pre></td></tr><tr><td data-num="515"></td><td><pre><span class="token number">11958508680650532537002514450672407546936750241323635379517397865807423392829629052160777467450703214094671170288775859660085415314937265758728826625458176</span></pre></td></tr><tr><td data-num="516"></td><td><pre><span class="token number">10064589911211585196748084387867251391015406673711623097249634756147640199493928570900582676466989267850032224694384534036061767947642284884424454830030848</span></pre></td></tr><tr><td data-num="517"></td><td><pre></pre></td></tr><tr><td data-num="518"></td><td><pre><span class="token comment">#r</span></pre></td></tr><tr><td data-num="519"></td><td><pre><span class="token number">6753785483255906709117615805253027649453460653974415214642466102672301763943358839905575042938258141827000621474498066533397472809407687579125519939754658</span></pre></td></tr></table></figure><p>简而言之，flag 加密后和 ef 封装在了一起，我们只要 ef 逆推出 flag 就好</p><p>首先分析一下关键函数</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">def</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="2"></td><td><pre>    choose<span class="token operator">=</span>getPrime<span class="token punctuation">(</span><span class="token number">512</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="3"></td><td><pre>    ps<span class="token operator">=</span>gen512num<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="4"></td><td><pre>    <span class="token keyword">print</span> <span class="token string">"gen over"</span></pre></td></tr><tr><td data-num="5"></td><td><pre>    bchoose<span class="token operator">=</span><span class="token builtin">bin</span><span class="token punctuation">(</span>choose<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="6"></td><td><pre>    r<span class="token operator">=</span><span class="token number">0</span></pre></td></tr><tr><td data-num="7"></td><td><pre>    bchoose <span class="token operator">=</span> <span class="token string">"0"</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token number">512</span><span class="token operator">-</span><span class="token builtin">len</span><span class="token punctuation">(</span>bchoose<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">+</span>bchoose</pre></td></tr><tr><td data-num="8"></td><td><pre>    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">512</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="9"></td><td><pre>        <span class="token keyword">if</span> bchoose<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">==</span><span class="token string">'1'</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="10"></td><td><pre>            r<span class="token operator">=</span>r<span class="token operator">^</span>ps<span class="token punctuation">[</span>i<span class="token punctuation">]</span> </pre></td></tr><tr><td data-num="11"></td><td><pre>    flag<span class="token operator">=</span><span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"flag"</span><span class="token punctuation">,</span><span class="token string">"r"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr></table></figure><p>flag 和 bchoose 关系很大，而 bchoose 又是 choose 的二进制，所以我们只要求出 choose 的值；</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">512</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="2"></td><td><pre>        <span class="token keyword">if</span> bchoose<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">==</span><span class="token string">'1'</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="3"></td><td><pre>            r<span class="token operator">=</span>r<span class="token operator">^</span>ps<span class="token punctuation">[</span>i<span class="token punctuation">]</span></pre></td></tr></table></figure><p>即攻破它就能拿到 flag</p><p>在 gen512num () 里</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">512</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="2"></td><td><pre>        p<span class="token operator">=</span>getPrime<span class="token punctuation">(</span><span class="token number">512</span><span class="token operator">-</span>order<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">+</span><span class="token number">10</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="3"></td><td><pre>        pre<span class="token operator">=</span><span class="token builtin">bin</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">:</span><span class="token punctuation">(</span><span class="token number">512</span><span class="token operator">-</span>order<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token operator">+</span><span class="token string">"1"</span></pre></td></tr><tr><td data-num="4"></td><td><pre>        ps<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span>pre<span class="token operator">+</span><span class="token string">"0"</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token number">512</span><span class="token operator">-</span><span class="token builtin">len</span><span class="token punctuation">(</span>pre<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="5"></td><td><pre>    <span class="token keyword">return</span> ps</pre></td></tr></table></figure><p>ps 的值是来自于 order，而 order 又是随机生成数，pre 要求每个数最后一位 1，因此读取 ps 最后一个 1 出现位置均不同</p><p>读取一下 r，果不其然最后一个 1 出现的位置都不相同</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">for</span> k <span class="token keyword">in</span> ps<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="2"></td><td><pre>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token builtin">bin</span><span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span>k<span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">==</span><span class="token string">'1'</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="3"></td><td><pre>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">bin</span><span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span>k<span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">bin</span><span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span>r<span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr></table></figure><h3 id="payload-3"><a class="anchor" href="#payload-3">#</a> payload</h3><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> <span class="token operator">*</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Cipher <span class="token keyword">import</span> AES</pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">import</span> hashlib</pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">from</span> random <span class="token keyword">import</span> randint</pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token keyword">import</span> os</pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token keyword">import</span> base64</pre></td></tr><tr><td data-num="7"></td><td><pre>r<span class="token operator">=</span><span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"r"</span><span class="token punctuation">,</span><span class="token string">"r"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="8"></td><td><pre>ef<span class="token operator">=</span><span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"ef"</span><span class="token punctuation">,</span><span class="token string">"r"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="9"></td><td><pre>ps<span class="token operator">=</span><span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"ps"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>readlines<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="10"></td><td><pre>ef<span class="token operator">=</span>base64<span class="token punctuation">.</span>b64decode<span class="token punctuation">(</span>ef<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="11"></td><td><pre></pre></td></tr><tr><td data-num="12"></td><td><pre><span class="token triple-quoted-string string">'''</span></pre></td></tr><tr><td data-num="13"></td><td><pre>for k in ps:</pre></td></tr><tr><td data-num="14"></td><td><pre>    if(bin(int(k,10))[-3]=='1'):</pre></td></tr><tr><td data-num="15"></td><td><pre>        print(bin(int(k,10)))</pre></td></tr><tr><td data-num="16"></td><td><pre>print(bin(int(r,10)))</pre></td></tr><tr><td data-num="17"></td><td><pre>'''</pre></td></tr><tr><td data-num="18"></td><td><pre>psre<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="19"></td><td><pre><span class="token keyword">for</span> k <span class="token keyword">in</span> ps<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="20"></td><td><pre>    t<span class="token operator">=</span><span class="token builtin">bin</span><span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span>k<span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="21"></td><td><pre>    psre<span class="token punctuation">.</span>append<span class="token punctuation">(</span>t<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="22"></td><td><pre></pre></td></tr><tr><td data-num="23"></td><td><pre>l<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="24"></td><td><pre><span class="token keyword">for</span> i <span class="token keyword">in</span> psre<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="25"></td><td><pre>    <span class="token keyword">if</span> i<span class="token punctuation">.</span>rfind<span class="token punctuation">(</span><span class="token string">'1'</span><span class="token punctuation">)</span> <span class="token keyword">not</span> <span class="token keyword">in</span> l<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="26"></td><td><pre>        l<span class="token punctuation">.</span>append<span class="token punctuation">(</span>i<span class="token punctuation">.</span>rfind<span class="token punctuation">(</span><span class="token string">'1'</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="27"></td><td><pre>    <span class="token keyword">else</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="28"></td><td><pre>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'error'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="29"></td><td><pre>        <span class="token comment">#print(i.rfind('1'))</span></pre></td></tr><tr><td data-num="30"></td><td><pre></pre></td></tr><tr><td data-num="31"></td><td><pre>bchoose<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">0</span> <span class="token keyword">for</span> _ <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">512</span><span class="token punctuation">)</span><span class="token punctuation">]</span>  </pre></td></tr><tr><td data-num="32"></td><td><pre><span class="token comment">#print(bchoose)</span></pre></td></tr><tr><td data-num="33"></td><td><pre></pre></td></tr><tr><td data-num="34"></td><td><pre>r2<span class="token operator">=</span><span class="token builtin">int</span><span class="token punctuation">(</span>r<span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="35"></td><td><pre><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">512</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="36"></td><td><pre>    rre<span class="token operator">=</span><span class="token builtin">bin</span><span class="token punctuation">(</span>r2<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="37"></td><td><pre>    rre<span class="token operator">=</span><span class="token string">'0'</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token number">512</span><span class="token operator">-</span><span class="token builtin">len</span><span class="token punctuation">(</span>rre<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">+</span>rre</pre></td></tr><tr><td data-num="38"></td><td><pre>    ii <span class="token operator">=</span> rre<span class="token punctuation">[</span><span class="token operator">-</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="39"></td><td><pre>    <span class="token keyword">if</span><span class="token punctuation">(</span>ii<span class="token operator">==</span><span class="token string">'1'</span> <span class="token keyword">or</span> ii<span class="token operator">==</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="40"></td><td><pre>        sub<span class="token operator">=</span><span class="token string">'1'</span><span class="token operator">+</span><span class="token string">'0'</span><span class="token operator">*</span>i</pre></td></tr><tr><td data-num="41"></td><td><pre>        <span class="token keyword">for</span> z <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">512</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="42"></td><td><pre>            <span class="token keyword">if</span> psre<span class="token punctuation">[</span>z<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token operator">-</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token operator">==</span>sub<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="43"></td><td><pre>                bchoose<span class="token punctuation">[</span>z<span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">1</span></pre></td></tr><tr><td data-num="44"></td><td><pre>                r2<span class="token operator">=</span>r2<span class="token operator">^</span><span class="token builtin">int</span><span class="token punctuation">(</span>ps<span class="token punctuation">[</span>z<span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="45"></td><td><pre>                <span class="token keyword">break</span></pre></td></tr><tr><td data-num="46"></td><td><pre><span class="token comment">#print(bchoose)</span></pre></td></tr><tr><td data-num="47"></td><td><pre>i<span class="token operator">=</span><span class="token number">0</span></pre></td></tr><tr><td data-num="48"></td><td><pre><span class="token keyword">for</span> k <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">512</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="49"></td><td><pre>    <span class="token keyword">if</span> bchoose<span class="token punctuation">[</span>k<span class="token punctuation">]</span> <span class="token operator">==</span><span class="token number">1</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="50"></td><td><pre>        i<span class="token operator">=</span>i<span class="token operator">^</span><span class="token builtin">int</span><span class="token punctuation">(</span>ps<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="51"></td><td><pre><span class="token comment">#print(i==int(r,10))</span></pre></td></tr><tr><td data-num="52"></td><td><pre><span class="token comment">#print(bin(i))</span></pre></td></tr><tr><td data-num="53"></td><td><pre><span class="token comment">#print(bin(int(r,10)))</span></pre></td></tr><tr><td data-num="54"></td><td><pre>choose<span class="token operator">=</span><span class="token number">0</span></pre></td></tr><tr><td data-num="55"></td><td><pre><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">512</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="56"></td><td><pre>    choose<span class="token operator">=</span>choose<span class="token operator">*</span><span class="token number">2</span><span class="token operator">+</span>bchoose<span class="token punctuation">[</span>i<span class="token punctuation">]</span></pre></td></tr><tr><td data-num="57"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span>choose<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="58"></td><td><pre></pre></td></tr><tr><td data-num="59"></td><td><pre></pre></td></tr><tr><td data-num="60"></td><td><pre>key<span class="token operator">=</span>long_to_bytes<span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span>hashlib<span class="token punctuation">.</span>md5<span class="token punctuation">(</span>long_to_bytes<span class="token punctuation">(</span>choose<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>hexdigest<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="61"></td><td><pre>aes_obj <span class="token operator">=</span> AES<span class="token punctuation">.</span>new<span class="token punctuation">(</span>key<span class="token punctuation">,</span> AES<span class="token punctuation">.</span>MODE_ECB<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="62"></td><td><pre>flag <span class="token operator">=</span> aes_obj<span class="token punctuation">.</span>decrypt<span class="token punctuation">(</span>ef<span class="token punctuation">)</span>  <span class="token comment">#final</span></pre></td></tr><tr><td data-num="63"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span></pre></td></tr></table></figure><h1 id="xor"><a class="anchor" href="#xor">#</a> Xor</h1><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">import</span> base64</pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">from</span> twisted<span class="token punctuation">.</span>internet <span class="token keyword">import</span> reactor<span class="token punctuation">,</span> protocol</pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">import</span> os</pre></td></tr><tr><td data-num="4"></td><td><pre> </pre></td></tr><tr><td data-num="5"></td><td><pre>PORT <span class="token operator">=</span> <span class="token number">9013</span></pre></td></tr><tr><td data-num="6"></td><td><pre> </pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token keyword">import</span> struct</pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token keyword">def</span> <span class="token function">get_bytes_from_file</span><span class="token punctuation">(</span>filename<span class="token punctuation">)</span><span class="token punctuation">:</span>  </pre></td></tr><tr><td data-num="9"></td><td><pre>    <span class="token keyword">return</span> <span class="token builtin">open</span><span class="token punctuation">(</span>filename<span class="token punctuation">,</span> <span class="token string">"rb"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>  </pre></td></tr><tr><td data-num="10"></td><td><pre>    </pre></td></tr><tr><td data-num="11"></td><td><pre>KEY <span class="token operator">=</span> <span class="token string">"[CENSORED]"</span></pre></td></tr><tr><td data-num="12"></td><td><pre> </pre></td></tr><tr><td data-num="13"></td><td><pre><span class="token keyword">def</span> <span class="token function">length_encryption_key</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="14"></td><td><pre>    <span class="token keyword">return</span> <span class="token builtin">len</span><span class="token punctuation">(</span>KEY<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="15"></td><td><pre> </pre></td></tr><tr><td data-num="16"></td><td><pre><span class="token keyword">def</span> <span class="token function">get_magic_png</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="17"></td><td><pre>    image <span class="token operator">=</span> get_bytes_from_file<span class="token punctuation">(</span><span class="token string">"./sleeping.png"</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="18"></td><td><pre>    encoded_string <span class="token operator">=</span> base64<span class="token punctuation">.</span>b64encode<span class="token punctuation">(</span>image<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="19"></td><td><pre>    key_len <span class="token operator">=</span> length_encryption_key<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="20"></td><td><pre>    <span class="token keyword">print</span> <span class="token string">'Sending magic....'</span></pre></td></tr><tr><td data-num="21"></td><td><pre>    <span class="token keyword">if</span> key_len <span class="token operator">!=</span> <span class="token number">12</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="22"></td><td><pre>        <span class="token keyword">return</span> <span class="token string">''</span></pre></td></tr><tr><td data-num="23"></td><td><pre>    <span class="token keyword">return</span> encoded_string </pre></td></tr><tr><td data-num="24"></td><td><pre>    </pre></td></tr><tr><td data-num="25"></td><td><pre> </pre></td></tr><tr><td data-num="26"></td><td><pre><span class="token keyword">class</span> <span class="token class-name">MyServer</span><span class="token punctuation">(</span>protocol<span class="token punctuation">.</span>Protocol<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="27"></td><td><pre>    <span class="token keyword">def</span> <span class="token function">connectionMade</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="28"></td><td><pre>        resp <span class="token operator">=</span> get_magic_png<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="29"></td><td><pre>        self<span class="token punctuation">.</span>transport<span class="token punctuation">.</span>write<span class="token punctuation">(</span>resp<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="30"></td><td><pre> </pre></td></tr><tr><td data-num="31"></td><td><pre><span class="token keyword">class</span> <span class="token class-name">MyServerFactory</span><span class="token punctuation">(</span>protocol<span class="token punctuation">.</span>Factory<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="32"></td><td><pre>    protocol <span class="token operator">=</span> MyServer</pre></td></tr><tr><td data-num="33"></td><td><pre> </pre></td></tr><tr><td data-num="34"></td><td><pre>factory <span class="token operator">=</span> MyServerFactory<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="35"></td><td><pre>reactor<span class="token punctuation">.</span>listenTCP<span class="token punctuation">(</span>PORT<span class="token punctuation">,</span> factory<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="36"></td><td><pre>reactor<span class="token punctuation">.</span>run<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr></table></figure><p>还有一个服务器端口里面塞满了 base</p><p><img data-src="https://s3.bmp.ovh/imgs/2022/04/03/4b68db6950aa3ce6.png" alt=""></p><p>源码里面说有个 sleeping.png，难道就是 base64 转图片吗</p><p>拖到 kali 里试验一下</p><p><img data-src="https://s3.bmp.ovh/imgs/2022/04/03/b88772f70e5be745.png" alt=""></p><p>不行啊，打不开</p><p><img data-src="https://s3.bmp.ovh/imgs/2022/04/03/a2ae005b683c0a3e.png" alt=""></p><p><img data-src="https://s3.bmp.ovh/imgs/2022/04/03/3a345ce399146664.png" alt=""></p><p>windows 下也不行</p><p>010 看一下</p><p><img data-src="https://s3.bmp.ovh/imgs/2022/04/03/3187eba8a84c6f08.png" alt=""></p><p>唔。。少了头文件</p><p>正常 png 是 89 50 开头的</p><p><img data-src="https://s3.bmp.ovh/imgs/2022/04/03/c551f8d8e8d85269.png" alt=""></p><p>回到题目给的 py 上</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">if</span> key_len <span class="token operator">!=</span> <span class="token number">12</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="2"></td><td><pre>        <span class="token keyword">return</span> <span class="token string">''</span></pre></td></tr><tr><td data-num="3"></td><td><pre>    <span class="token keyword">return</span> encoded_string</pre></td></tr></table></figure><p>这句似乎成了关键语句，除此以外真的再也没有什么和编码，加密什么的有关系的了</p><p>那是不是异或呢？png 的文件头异或现有的 12 位文件头；</p><p>试一下吧</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token number">0x57</span><span class="token punctuation">,</span> <span class="token number">0x6f</span><span class="token punctuation">,</span> <span class="token number">0x41</span><span class="token punctuation">,</span> <span class="token number">0x68</span><span class="token punctuation">,</span> <span class="token number">0x5f</span><span class="token punctuation">,</span> <span class="token number">0x41</span><span class="token punctuation">,</span> <span class="token number">0x5f</span><span class="token punctuation">,</span> <span class="token number">0x4b</span><span class="token punctuation">,</span> <span class="token number">0x65</span><span class="token punctuation">,</span> <span class="token number">0x79</span><span class="token punctuation">,</span> <span class="token number">0x21</span><span class="token punctuation">,</span> <span class="token number">0x3f</span></pre></td></tr></table></figure><p>再把这个写入文件里面或许就行了。上网搜了一下类似脚本</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">def</span> <span class="token function">xor</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span> key<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="2"></td><td><pre>    l <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="3"></td><td><pre>    <span class="token keyword">return</span> <span class="token builtin">bytearray</span><span class="token punctuation">(</span><span class="token punctuation">(</span></pre></td></tr><tr><td data-num="4"></td><td><pre>        <span class="token punctuation">(</span>data<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">^</span> key<span class="token punctuation">[</span>i <span class="token operator">%</span> l<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token builtin">len</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="5"></td><td><pre>    <span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="6"></td><td><pre> </pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token comment"># Read the encrypted image as bytearray</span></pre></td></tr><tr><td data-num="8"></td><td><pre>data <span class="token operator">=</span> <span class="token builtin">bytearray</span><span class="token punctuation">(</span><span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'out.png'</span><span class="token punctuation">,</span> <span class="token string">'rb'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="9"></td><td><pre> </pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token comment"># This is our key as bytearray: "WoAh_A_Key!?"</span></pre></td></tr><tr><td data-num="11"></td><td><pre>key <span class="token operator">=</span> <span class="token builtin">bytearray</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0x57</span><span class="token punctuation">,</span> <span class="token number">0x6f</span><span class="token punctuation">,</span> <span class="token number">0x41</span><span class="token punctuation">,</span> <span class="token number">0x68</span><span class="token punctuation">,</span> <span class="token number">0x5f</span><span class="token punctuation">,</span> <span class="token number">0x41</span><span class="token punctuation">,</span> <span class="token number">0x5f</span><span class="token punctuation">,</span> <span class="token number">0x4b</span><span class="token punctuation">,</span> <span class="token number">0x65</span><span class="token punctuation">,</span> <span class="token number">0x79</span><span class="token punctuation">,</span> <span class="token number">0x21</span><span class="token punctuation">,</span> <span class="token number">0x3f</span><span class="token punctuation">]</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="12"></td><td><pre> </pre></td></tr><tr><td data-num="13"></td><td><pre><span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'decrypted.png'</span><span class="token punctuation">,</span> <span class="token string">'wb'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> file_<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="14"></td><td><pre>    file_<span class="token punctuation">.</span>write<span class="token punctuation">(</span>xor<span class="token punctuation">(</span>data<span class="token punctuation">,</span>key<span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr></table></figure><p><img data-src="https://s3.bmp.ovh/imgs/2022/04/03/521b5834a401b64b.png" alt=""></p><p>好有意思的题目啊。。。</p><div class="tags"><a href="/tags/crypto%E6%95%B4%E5%90%88/" rel="tag"><i class="ic i-tag"></i> crypto整合</a></div></div><footer><div class="meta"><span class="item"><span class="icon"><i class="ic i-calendar-check"></i> </span><span class="text">更新于</span> <time title="修改时间：2022-04-29 15:53:00" itemprop="dateModified" datetime="2022-04-29T15:53:00+08:00">2022-04-29</time> </span><span id="crypto/write/RSA和一些其他密码知识的归纳I/" class="item leancloud_visitors" data-flag-title="十万个 Crypto【Updating...】" title="阅读次数"><span class="icon"><i class="ic i-eye"></i> </span><span class="text">阅读次数</span> <span class="leancloud-visitors-count"></span> <span class="text">次</span></span></div><div class="reward"><button><i class="ic i-heartbeat"></i> 赞赏</button><p>请我喝[茶]~(￣▽￣)~*</p><div id="qr"><div><img data-src="/images/wechatpay.png" alt="GNIeliauk 微信支付"><p>微信支付</p></div></div></div><div id="copyright"><ul><li class="author"><strong>本文作者： </strong>GNIeliauk <i class="ic i-at"><em>@</em></i>GNI+Eliauk</li><li class="link"><strong>本文链接：</strong> <a href="http://kyrita.top/crypto/write/RSA%E5%92%8C%E4%B8%80%E4%BA%9B%E5%85%B6%E4%BB%96%E5%AF%86%E7%A0%81%E7%9F%A5%E8%AF%86%E7%9A%84%E5%BD%92%E7%BA%B3I/" title="十万个 Crypto【Updating...】">http://kyrita.top/crypto/write/RSA和一些其他密码知识的归纳I/</a></li><li class="license"><strong>版权声明： </strong>本站所有文章除特别声明外，均采用 <span class="exturl" data-url="aHR0cHM6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LW5jLXNhLzQuMC9kZWVkLnpo"><i class="ic i-creative-commons"><em>(CC)</em></i>BY-NC-SA</span> 许可协议。转载请注明出处！</li></ul></div></footer></article></div><div class="post-nav"><div class="item left"><a href="/hgame2/" itemprop="url" rel="prev" data-background-image="https:&#x2F;&#x2F;s3.bmp.ovh&#x2F;imgs&#x2F;2022&#x2F;02&#x2F;4c8ae6a92124b60e.jpg" title="hgame2022"><span class="type">上一篇</span> <span class="category"><i class="ic i-flag"></i> wp</span><h3>hgame2022</h3></a></div><div class="item right"><a href="/number/math/%E6%A4%AD%E5%9C%86%E6%9B%B2%E7%BA%BF/" itemprop="url" rel="next" data-background-image="https:&#x2F;&#x2F;s3.bmp.ovh&#x2F;imgs&#x2F;2022&#x2F;03&#x2F;a0ca0436c66aeaca.webp" title="有限域上的椭圆曲线点群与椭圆曲线密码算术"><span class="type">下一篇</span> <span class="category"><i class="ic i-flag"></i> Math</span><h3>有限域上的椭圆曲线点群与椭圆曲线密码算术</h3></a></div></div><div class="wrap" id="comments"></div></div><div id="sidebar"><div class="inner"><div class="panels"><div class="inner"><div class="contents panel pjax" data-title="文章目录"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#rsa"><span class="toc-number">1.</span> <span class="toc-text">RSA</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#factoring-large-integers"><span class="toc-number">1.1.</span> <span class="toc-text">Factoring Large Integers</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%B1%E6%A8%A1%E6%94%BB%E5%87%BB"><span class="toc-number">1.2.</span> <span class="toc-text">共模攻击</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#base64%E9%9A%90%E5%86%99"><span class="toc-number">1.2.1.</span> <span class="toc-text">BASE64 隐写</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#encode"><span class="toc-number">1.2.1.1.</span> <span class="toc-text">Encode</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#decode"><span class="toc-number">1.2.1.2.</span> <span class="toc-text">Decode</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BD%8E%E8%A7%A3%E5%AF%86%E6%8C%87%E6%95%B0%E6%94%BB%E5%87%BB"><span class="toc-number">1.3.</span> <span class="toc-text">低解密指数攻击</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B0%8F%E6%98%8E%E6%96%87%E6%94%BB%E5%87%BB"><span class="toc-number">1.3.1.</span> <span class="toc-text">小明文攻击</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#boneh_durfees-attack"><span class="toc-number">1.4.</span> <span class="toc-text">Boneh_Durfee&#39;s Attack</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%80%E9%81%93%E8%9B%AE%E6%9C%89%E6%84%8F%E6%80%9D%E7%9A%84rsa"><span class="toc-number">1.5.</span> <span class="toc-text">一道蛮有意思的 RSA</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%AC%A7%E6%8B%89%E5%87%BD%E6%95%B0%E8%BF%90%E7%94%A8"><span class="toc-number">1.6.</span> <span class="toc-text">欧拉函数运用</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%AC%A7%E6%8B%89%E5%87%BD%E6%95%B0"><span class="toc-number">1.6.1.</span> <span class="toc-text">欧拉函数</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%A7%AF%E6%80%A7%E5%87%BD%E6%95%B0"><span class="toc-number">1.6.1.1.</span> <span class="toc-text">积性函数</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%AC%A7%E6%8B%89%E5%87%BD%E6%95%B0%E7%9A%84%E5%87%A0%E4%B8%AA%E6%80%A7%E8%B4%A8"><span class="toc-number">1.6.1.2.</span> <span class="toc-text">欧拉函数的几个性质</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#schmidt-samoa-%E5%AF%86%E7%A0%81%E4%BD%93%E7%B3%BB"><span class="toc-number">1.7.</span> <span class="toc-text">Schmidt-Samoa 密码体系</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%A8%8D%E5%BE%AE%E5%B8%A6%E4%B8%80%E4%B8%8Brabin"><span class="toc-number">1.7.1.</span> <span class="toc-text">稍微带一下 Rabin</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%89%A9%E5%B1%95%E6%AC%A7%E5%87%A0%E9%87%8C%E5%BE%97"><span class="toc-number">1.8.</span> <span class="toc-text">扩展欧几里得</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#handicraft_rsa"><span class="toc-number">1.9.</span> <span class="toc-text">Handicraft_RSA</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#handicraft_rsapy"><span class="toc-number">1.9.1.</span> <span class="toc-text">handicraft_rsa.py</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#payload"><span class="toc-number">1.9.2.</span> <span class="toc-text">payload</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#iscc-2017%E8%AF%B4%E6%88%91%E4%BD%9C%E5%BC%8A%E9%9C%80%E8%A6%81%E8%AF%81%E6%8D%AE"><span class="toc-number">1.10.</span> <span class="toc-text">ISCC-2017 说我作弊需要证据</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8D%B7%E7%8E%8B%E6%9D%AF%E7%AD%BE%E5%88%B0"><span class="toc-number">1.11.</span> <span class="toc-text">卷王杯 — 签到</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#encryptpy"><span class="toc-number">1.11.1.</span> <span class="toc-text">encrypt.py</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#payload-2"><span class="toc-number">1.11.2.</span> <span class="toc-text">payload</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E8%83%8C%E5%8C%85%E5%8A%A0%E5%AF%86"><span class="toc-number">2.</span> <span class="toc-text">背包加密</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#merklehellman"><span class="toc-number">2.1.</span> <span class="toc-text">Merkle–Hellman</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%94%9F%E6%88%90%E7%A7%81%E9%92%A5"><span class="toc-number">2.1.1.</span> <span class="toc-text">生成私钥</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%94%9F%E6%88%90%E5%85%AC%E9%92%A5"><span class="toc-number">2.1.2.</span> <span class="toc-text">生成公钥</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8A%A0%E5%AF%86"><span class="toc-number">2.1.3.</span> <span class="toc-text">加密</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A7%A3%E5%AF%86"><span class="toc-number">2.1.4.</span> <span class="toc-text">解密</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%9B%BD%E5%AF%86"><span class="toc-number">3.</span> <span class="toc-text">国密</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#sm1"><span class="toc-number">3.1.</span> <span class="toc-text">SM1</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#smpy"><span class="toc-number">3.1.1.</span> <span class="toc-text">sm.py</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#payload-3"><span class="toc-number">3.1.2.</span> <span class="toc-text">payload</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#xor"><span class="toc-number">4.</span> <span class="toc-text">Xor</span></a></li></ol></div><div class="related panel pjax" data-title="系列文章"><ul><li><a href="/crypto/write/HASH%E7%A0%B4%E8%A7%A3/" rel="bookmark" title="HASH破解">HASH破解</a></li><li><a href="/crypto/write/%E4%BB%8A%E6%97%A5%E4%BB%BD%E7%9A%84%E5%AF%86%E7%A0%81%E5%AD%A6/" rel="bookmark" title="今日份的密码学">今日份的密码学</a></li><li><a href="/crypto/write/%E4%BF%AE%E5%A4%8D%E7%A0%B4%E7%A2%8E%E7%9A%84MD5/" rel="bookmark" title="修复破碎的MD5">修复破碎的MD5</a></li><li><a href="/crypto/write/RSA-1/" rel="bookmark" title="RSA-1">RSA-1</a></li><li><a href="/crypto/write/RSA-2/" rel="bookmark" title="RSA-2">RSA-2</a></li><li><a href="/crypto/write/%E8%BE%BE%E8%8A%AC%E5%A5%87%E5%AF%86%E7%A0%81/" rel="bookmark" title="达芬奇密码">达芬奇密码</a></li><li class="active"><a href="/crypto/write/RSA%E5%92%8C%E4%B8%80%E4%BA%9B%E5%85%B6%E4%BB%96%E5%AF%86%E7%A0%81%E7%9F%A5%E8%AF%86%E7%9A%84%E5%BD%92%E7%BA%B3I/" rel="bookmark" title="十万个 Crypto【Updating...】">十万个 Crypto【Updating...】</a></li><li><a href="/crypto/write/DH/" rel="bookmark" title="浅谈Diffie-Hellman">浅谈Diffie-Hellman</a></li><li><a href="/crypto/write/Lattice%20Based%20Crypto/" rel="bookmark" title="Lattice Based Crypto">Lattice Based Crypto</a></li><li><a href="/crypto/write/Coppersmith/" rel="bookmark" title="Coppersmith定理">Coppersmith定理</a></li><li><a href="/crypto/write/%E6%A4%AD%E5%9C%86%E6%9B%B2%E7%BA%BF%E7%82%B9%E5%8E%8B%E7%BC%A9/" rel="bookmark" title="点压缩技术在椭圆曲线上的理论应用">点压缩技术在椭圆曲线上的理论应用</a></li></ul></div><div class="overview panel" data-title="站点概览"><div class="author" itemprop="author" itemscope itemtype="http://schema.org/Person"><img class="image" itemprop="image" alt="GNIeliauk" data-src="/images/avatar.jpg"><p class="name" itemprop="name">GNIeliauk</p><div class="description" itemprop="description">再不放假就要坏掉了</div></div><nav class="state"><div class="item posts"><a href="/archives/"><span class="count">42</span> <span class="name">文章</span></a></div><div class="item categories"><a href="/categories/"><span class="count">24</span> <span class="name">分类</span></a></div><div class="item tags"><a href="/tags/"><span class="count">33</span> <span class="name">标签</span></a></div></nav><div class="social"><span class="exturl item github" data-url="aHR0cHM6Ly9naXRodWIuY29tL2d1ZGEwNDAyMQ==" title="https:&#x2F;&#x2F;github.com&#x2F;guda04021"><i class="ic i-github"></i></span> <span class="exturl item twitter" data-url="aHR0cHM6Ly90d2l0dGVyLmNvbS95b3VybmFtZQ==" title="https:&#x2F;&#x2F;twitter.com&#x2F;yourname"><i class="ic i-twitter"></i></span> <span class="exturl item music" data-url="aHR0cHM6Ly9tdXNpYy4xNjMuY29tLyMvdXNlci9ob21lP2lkPTM0NzUwMDI4Ng==" title="https:&#x2F;&#x2F;music.163.com&#x2F;#&#x2F;user&#x2F;home?id&#x3D;347500286"><i class="ic i-cloud-music"></i></span></div><ul class="menu"><li class="item"><a href="/" rel="section"><i class="ic i-home"></i>首页</a></li><li class="item"><a href="/resources/" rel="section"><i class="ic i-align-left"></i>随言</a></li><li class="item"><a href="/footstep/" rel="section"><i class="ic i-chart-area"></i>足迹</a></li><li class="item"><a href="/friends/" rel="section"><i class="ic i-sitemap"></i>链环</a></li></ul></div></div></div><ul id="quick"><li class="prev pjax"><a href="/hgame2/" rel="prev" title="上一篇"><i class="ic i-chevron-left"></i></a></li><li class="up"><i class="ic i-arrow-up"></i></li><li class="down"><i class="ic i-arrow-down"></i></li><li class="next pjax"><a href="/number/math/%E6%A4%AD%E5%9C%86%E6%9B%B2%E7%BA%BF/" rel="next" title="下一篇"><i class="ic i-chevron-right"></i></a></li><li class="percent"></li></ul></div></div><div class="dimmer"></div></div></main><footer id="footer"><div class="inner"><div class="widgets"><div class="rpost pjax"><h2>随机文章</h2><ul><li class="item"><div class="breadcrumb"><a href="/categories/wiki/" title="分类于 wiki">wiki</a> <i class="ic i-angle-right"></i> <a href="/categories/wiki/python/" title="分类于 python">python</a></div><span><a href="/Python%E4%B8%ADtranslate-%E5%92%8Cmaketrans-%E7%9A%84%E4%BD%BF%E7%94%A8/" title="Python中translate()和maketrans()的使用">Python中translate()和maketrans()的使用</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/wiki/" title="分类于 wiki">wiki</a> <i class="ic i-angle-right"></i> <a href="/categories/wiki/pwn/" title="分类于 pwn">pwn</a></div><span><a href="/ret2text/" title="ret2text">ret2text</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/wp/" title="分类于 wp">wp</a> <i class="ic i-angle-right"></i> <a href="/categories/wp/pwn/" title="分类于 pwn">pwn</a></div><span><a href="/Rip%E8%A6%86%E7%9B%96/" title="Rip覆盖">Rip覆盖</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/WEB%E5%89%8D%E5%90%8E%E7%AB%AF%E5%8E%9F%E7%90%86/" title="分类于 WEB前后端原理">WEB前后端原理</a> <i class="ic i-angle-right"></i> <a href="/categories/WEB%E5%89%8D%E5%90%8E%E7%AB%AF%E5%8E%9F%E7%90%86/%E5%90%8E%E7%AB%AF%E5%9F%BA%E7%A1%80SQL/" title="分类于 后端基础SQL">后端基础SQL</a></div><span><a href="/MySQL-Group-concat-%E7%9A%84%E7%94%A8%E6%B3%95/" title="MySQL Group_concat()的用法">MySQL Group_concat()的用法</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/wiki/" title="分类于 wiki">wiki</a> <i class="ic i-angle-right"></i> <a href="/categories/wiki/python/" title="分类于 python">python</a></div><span><a href="/Python%E5%AE%9E%E7%8E%B0%E5%AD%97%E9%A2%91%E7%BB%9F%E8%AE%A1/" title="Python实现字频统计">Python实现字频统计</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/%E7%94%9F%E6%B4%BB%E9%9A%8F%E7%AC%94/" title="分类于 生活随笔">生活随笔</a> <i class="ic i-angle-right"></i> <a href="/categories/%E7%94%9F%E6%B4%BB%E9%9A%8F%E7%AC%94/GAME/" title="分类于 GAME">GAME</a></div><span><a href="/Catherine/" title="Catherine">Catherine</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/crypto/" title="分类于 Write-up">Write-up</a> <i class="ic i-angle-right"></i> <a href="/categories/crypto/write/" title="分类于 密码学">密码学</a></div><span><a href="/crypto/write/HASH%E7%A0%B4%E8%A7%A3/" title="HASH破解">HASH破解</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/crypto/" title="分类于 Write-up">Write-up</a> <i class="ic i-angle-right"></i> <a href="/categories/crypto/write/" title="分类于 密码学">密码学</a></div><span><a href="/crypto/write/%E8%BE%BE%E8%8A%AC%E5%A5%87%E5%AF%86%E7%A0%81/" title="达芬奇密码">达芬奇密码</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/wp/" title="分类于 wp">wp</a></div><span><a href="/hgame2/" title="hgame2022">hgame2022</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/crypto/" title="分类于 Write-up">Write-up</a> <i class="ic i-angle-right"></i> <a href="/categories/crypto/write/" title="分类于 密码学">密码学</a></div><span><a href="/crypto/write/RSA-1/" title="RSA-1">RSA-1</a></span></li></ul></div><div><h2>最新评论</h2><ul class="leancloud-recent-comment"></ul></div></div><div class="status"><div class="copyright">&copy; 2010 – <span itemprop="copyrightYear">2022</span> <span class="with-love"><i class="ic i-sakura rotate"></i> </span><span class="author" itemprop="copyrightHolder">GNIeliauk @ E raser</span></div><div class="count"><span class="post-meta-item-icon"><i class="ic i-chart-area"></i> </span><span title="站点总字数">319k 字</span> <span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="ic i-coffee"></i> </span><span title="站点阅读时长">4:50</span></div><img src="pic/o_1dfilp8ruo521thr1hvf18ji17soa.png"> <a href="https://beian.miit.gov.cn" style="color:#f72b07" target="_blank">苏ICP备 - 2021023834号</a><div class="powered-by">基于 <span class="exturl" data-url="aHR0cHM6Ly9oZXhvLmlv">Hexo</span> & Theme.<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2FtZWhpbWUvaGV4by10aGVtZS1zaG9rYQ==">Shoka</span></div></div></div></footer></div><script data-config type="text/javascript">var LOCAL={path:"crypto/write/RSA和一些其他密码知识的归纳I/",favicon:{show:"咦?（●´3｀●)又好了",hide:"(´Д｀)坏掉了"},search:{placeholder:"文章搜索",empty:"关于 「 ${query} 」，什么也没搜到",stats:"${time} ms 内找到 ${hits} 条结果"},valine:!0,copy_tex:!0,katex:!0,fancybox:!0,copyright:'复制成功，转载请遵守 <i class="ic i-creative-commons"></i>BY-NC-SA 协议。',ignores:[function(e){return e.includes("#")},function(e){return new RegExp(LOCAL.path+"$").test(e)}]}</script><script src="https://cdn.polyfill.io/v2/polyfill.js"></script><script src="//cdn.jsdelivr.net/combine/npm/pace-js@1.0.2/pace.min.js,npm/pjax@0.2.8/pjax.min.js,npm/whatwg-fetch@3.4.0/dist/fetch.umd.min.js,npm/animejs@3.2.0/lib/anime.min.js,npm/algoliasearch@4/dist/algoliasearch-lite.umd.js,npm/instantsearch.js@4/dist/instantsearch.production.min.js,npm/lozad@1/dist/lozad.min.js,npm/quicklink@2/dist/quicklink.umd.js"></script><script src="/js/app.js?v=0.2.5"></script></body></html>