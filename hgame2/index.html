<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><meta name="theme-color" content="#FFF"><link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png"><link rel="icon" type="image/ico" sizes="32x32" href="/images/favicon.ico"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link rel="alternate" type="application/rss+xml" title="GNI+Eliauk" href="http://kyrita.top/rss.xml"><link rel="alternate" type="application/atom+xml" title="GNI+Eliauk" href="http://kyrita.top/atom.xml"><link rel="alternate" type="application/json" title="GNI+Eliauk" href="http://kyrita.top/feed.json"><link rel="stylesheet" href="//fonts.googleapis.com/css?family=Mulish:300,300italic,400,400italic,700,700italic%7CFredericka%20the%20Great:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20JP:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20SC:300,300italic,400,400italic,700,700italic%7CInconsolata:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext"><link rel="stylesheet" href="/css/app.css?v=0.2.5"><meta name="keywords" content="ctf-wp"><link rel="canonical" href="http://kyrita.top/hgame2/"><title>hgame2022 - wp | E raser = GNI+Eliauk = 每天身体健康 事事如意</title><meta name="generator" content="Hexo 5.3.0"></head><body itemscope itemtype="http://schema.org/WebPage"><div id="loading"><div id="counter-container" class="container"><div class="animation"><div class="circle top-left"><div class="line a"></div><div class="straight a"></div></div><div class="circle top-right"><div class="line b"></div><div class="straight b"></div></div><div class="drone-body"><div class="counter"><div class="count" id="count"></div></div></div><div class="circle bottom-left"><div class="line c"></div><div class="straight c"></div></div><div class="circle bottom-right"><div class="line d"></div><div class="straight d"></div></div></div><p class="page-loading">LOADING...</p><p class="page-loading2">LOADING...</p></div></div><div id="container"><header id="header" itemscope itemtype="http://schema.org/WPHeader"><div class="inner"><div id="brand"><div class="pjax"><h1 itemprop="name headline">hgame2022</h1><div class="meta"><span class="item" title="创建时间：2022-02-07 11:13:40"><span class="icon"><i class="ic i-calendar"></i> </span><span class="text">发表于</span> <time itemprop="dateCreated datePublished" datetime="2022-02-07T11:13:40+08:00">2022-02-07</time> </span><span class="item" title="本文字数"><span class="icon"><i class="ic i-pen"></i> </span><span class="text">本文字数</span> <span>29k</span> <span class="text">字</span> </span><span class="item" title="阅读时长"><span class="icon"><i class="ic i-clock"></i> </span><span class="text">阅读时长</span> <span>27 分钟</span></span></div></div></div><nav id="nav"><div class="inner"><div class="toggle"><div class="lines" aria-label="切换导航栏"><span class="line"></span> <span class="line"></span> <span class="line"></span></div></div><ul class="menu"><li class="item title"><a href="/" rel="start">E raser</a></li></ul><ul class="right"><li class="item theme"><i class="ic i-sun"></i></li><li class="item search"><i class="ic i-search"></i></li></ul></div></nav></div><div id="imgs" class="pjax"><img src="https://s3.bmp.ovh/imgs/2022/02/4c8ae6a92124b60e.jpg"></div><div id="waves"><svg class="waves" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto"><defs><path id="gentle-wave" d="M-160 44c30 0 58-18 88-18s 58 18 88 18 58-18 88-18 58 18 88 18 v44h-352z"/></defs><g class="parallax"><use xlink:href="#gentle-wave" x="48" y="0"/><use xlink:href="#gentle-wave" x="48" y="3"/><use xlink:href="#gentle-wave" x="48" y="5"/><use xlink:href="#gentle-wave" x="48" y="7"/></g></svg></div></header><main><div class="inner"><div id="main" class="pjax"><div class="article wrap"><div class="breadcrumb" itemscope itemtype="https://schema.org/BreadcrumbList"><i class="ic i-home"></i> <span><a href="/">首页</a></span><i class="ic i-angle-right"></i> <span class="current" itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem"><a href="/categories/wp/" itemprop="item" rel="index" title="分类于 wp"><span itemprop="name">wp</span></a><meta itemprop="position" content="1"></span></div><article itemscope itemtype="http://schema.org/Article" class="post block" lang="zh-CN"><link itemprop="mainEntityOfPage" href="http://kyrita.top/hgame2/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/avatar.jpg"><meta itemprop="name" content="GNIeliauk"><meta itemprop="description" content="每天身体健康 事事如意, 再不放假就要坏掉了"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="GNI+Eliauk"></span><div class="body md" itemprop="articleBody"><hr><p>这次 hgame 几乎都是靠写一些脚本跑出几道简单的密码题来得分，想学习 web 却无从下手；<br><a id="more"></a></p><h1 id="web"><a class="anchor" href="#web">#</a> Web</h1><h2 id="easy_auth"><a class="anchor" href="#easy_auth">#</a> easy_auth</h2><p>查看 wp 才会</p><p>这是关于鉴权方面的问题。</p><p>鉴权（authentication）是指验证用户是否拥有访问系统的权利。传统的鉴权是通过密码来验证的。这种方式的前提是，每个获得密码的用户都已经被授权。在建立用户时，就为此用户分配一个密码，用户的密码可以由管理员指定，也可以由用户自行申请。这种方式的弱点十分明显：一旦密码被偷或用户遗失密码，情况就会十分麻烦，需要管理员对用户密码进行重新修改，而修改密码之前还要人工验证用户的合法身份。</p><p>为了克服这种鉴权方式的缺点，需要一个更加可靠的鉴权方式。目前的主流鉴权方式是利用认证授权来验证数字签名的正确与否。</p><p>逻辑上，授权发生在鉴权之后，而实际上，这两者常常是一个过程。</p><p>我们常用的鉴权有四种：</p><p>1、HTTP Basic Authentication</p><p>2、session-cookie</p><p>3、Token 验证</p><p>4、OAuth (开放授权)</p><p><span class="exturl" data-url="aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3NpbmF0XzMzMjU1NDk1L2FydGljbGUvZGV0YWlscy8xMDM5MjAxMzE=">详情参考</span></p><p>这题是用的 Token 验证<br>认证过程:</p><ul><li>用户输入登陆凭据；</li><li>服务器验证凭据是否正确，然后返回一个经过签名的 token；</li><li>客户端负责存储 token，可以存在 localstorage，或者 cookie 中</li><li>对服务器的请求带上这个 token；</li><li>服务器对 JWT 进行解码，如果 token 有效，则处理该请求；</li><li>一旦用户登出，客户端销毁 token。</li></ul><p>我们先找到必需的 token 之后在对他进行<span class="exturl" data-url="aHR0cHM6Ly9qd3QuaW8vI2RlYnVnZ2Vy"> JWT 解码</span></p><p><img data-src="https://s3.bmp.ovh/imgs/2022/02/632baecfe53e17d5.png" alt=""></p><p><img data-src="https://s3.bmp.ovh/imgs/2022/02/af400a1d0b00429d.png" alt=""><br>需要密码的部分清空，这题不需要密码</p><p><img data-src="https://s3.bmp.ovh/imgs/2022/02/5e34d12e1f2c7a5d.png" alt=""><br>利用题目已知的 admin，猜测 ID，得到 flag 的 token</p><p>替换原来的 token，不用多久就会显现 flag<br><img data-src="https://s3.bmp.ovh/imgs/2022/02/51d181fc71c60dfa.png" alt=""></p><h2 id="蛛蛛嘿嘿我的蛛蛛"><a class="anchor" href="#蛛蛛嘿嘿我的蛛蛛">#</a> 蛛蛛... 嘿嘿♥我的蛛蛛</h2><p>爬虫爬<br>这里用正则更快一点<br>payload</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">import</span> requests</pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">import</span> re</pre></td></tr><tr><td data-num="3"></td><td><pre></pre></td></tr><tr><td data-num="4"></td><td><pre>headers <span class="token operator">=</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="5"></td><td><pre>        <span class="token string">'User-Agent'</span><span class="token punctuation">:</span><span class="token string">'Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:95.0) Gecko/20100101 Firefox/95.0'</span></pre></td></tr><tr><td data-num="6"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="7"></td><td><pre>next_url <span class="token operator">=</span> base <span class="token operator">=</span> <span class="token string">'https://hgame-spider.vidar.club/xxxx'</span></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token comment">#page_text = requests.get (url=next_url,headers=headers).text #使用通用爬虫对 url 对应的一张页面进行爬取</span></pre></td></tr><tr><td data-num="9"></td><td><pre>ex <span class="token operator">=</span> <span class="token string">'&lt;a href=\"(\S+)\">点我试试&lt;/a>'</span></pre></td></tr><tr><td data-num="10"></td><td><pre></pre></td></tr><tr><td data-num="11"></td><td><pre><span class="token keyword">while</span> <span class="token number">1</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="12"></td><td><pre>    keys <span class="token operator">=</span> re<span class="token punctuation">.</span>findall<span class="token punctuation">(</span>ex<span class="token punctuation">,</span>requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>next_url<span class="token punctuation">)</span><span class="token punctuation">.</span>text<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="13"></td><td><pre>    <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>keys<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span> <span class="token keyword">break</span></pre></td></tr><tr><td data-num="14"></td><td><pre>    next_url <span class="token operator">=</span> base <span class="token operator">+</span> keys<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="15"></td><td><pre>    <span class="token comment">#print(next_url)</span></pre></td></tr><tr><td data-num="16"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span>requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>next_url<span class="token punctuation">)</span><span class="token punctuation">.</span>headers<span class="token punctuation">)</span></pre></td></tr></table></figure><h2 id="webpack-engine"><a class="anchor" href="#webpack-engine">#</a> webpack-engine</h2><p>JavaScript 脚本正变得越来越复杂。大部分源码（尤其是各种函数库和框架）都要经过转换，才能投入生产环境。<br>常见的源码转换，主要是以下三种情况：</p><p>1）压缩，减小体积。比如 jQuery 1.9 的源码，压缩前是 252KB，压缩后是 32KB。<br>2）多个文件合并，减少 HTTP 请求数。<br>3）其他语言编译成 JavaScript。最常见的例子就是 CoffeeScript。</p><p>jQuery 1.9 压缩后只有 3 行，每行 3 万个字符，所有内部变量都改了名字。你看着报错信息，感到毫无头绪，根本不知道它所对应的原始位置。<br>这就是 Source map 想要解决的问题。</p><p>简单说，Source map 就是一个信息文件，里面储存着位置信息。也就是说，转换后的代码的每一个位置，所对应的转换前的位置。<br>有了它，出错的时候，除错工具将直接显示原始代码，而不是转换后的代码。这无疑给开发者带来了很大方便。<br>目前，暂时只有 Chrome 浏览器支持这个功能</p><p>如何使用 Source map 呢？其实只要在转换后的代码尾部，加上一行就可以了。</p><pre><code class="language-JavaScript">    　　//@ sourceMappingURL=/path/to/file.js.map
</code></pre><p>map 文件可以放在网络上，也可以放在本地文件系统。</p><p>Source map 的格式，它大概是这个样子：</p><figure class="highlight html"><figcaption data-lang="HTML"></figcaption><table><tr><td data-num="1"></td><td><pre>&#123;</pre></td></tr><tr><td data-num="2"></td><td><pre>    　　　　version : 3,</pre></td></tr><tr><td data-num="3"></td><td><pre>    　　　　file: "out.js",</pre></td></tr><tr><td data-num="4"></td><td><pre>    　　　　sourceRoot : "",</pre></td></tr><tr><td data-num="5"></td><td><pre>    　　　　sources: ["foo.js", "bar.js"],</pre></td></tr><tr><td data-num="6"></td><td><pre>    　　　　names: ["src", "maps", "are", "fun"],</pre></td></tr><tr><td data-num="7"></td><td><pre>    　　　　mappings: "AAgBC,SAAQ,CAAEA"</pre></td></tr><tr><td data-num="8"></td><td><pre>    　　&#125;</pre></td></tr></table></figure><p>那么回到正文，这题我们提示用 Chrome 打开去看看。</p><p><img data-src="https://s3.bmp.ovh/imgs/2022/02/e71c9e49bffe5710.png" alt=""></p><p>发现源文件里多出一个文件夹，这是 webpack 打包 js 时开启了 sourcemap，而 chrome 又还原了源码</p><p><img data-src="https://s3.bmp.ovh/imgs/2022/02/bc9b117600ac9ea8.png" alt=""></p><p d0nt_f0r9et_2_clos3_s0urce_m@p="">两次 base64 解码后得到: hgame</p><h1 id="crypto"><a class="anchor" href="#crypto">#</a> Crypto</h1><h2 id="easy-rsa"><a class="anchor" href="#easy-rsa">#</a> Easy RSA</h2><p>源码</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">from</span> math <span class="token keyword">import</span> gcd</pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">from</span> random <span class="token keyword">import</span> randint</pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">from</span> gmpy2 <span class="token keyword">import</span> next_prime</pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> getPrime</pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token keyword">from</span> secret <span class="token keyword">import</span> flag</pre></td></tr><tr><td data-num="6"></td><td><pre></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token keyword">def</span> <span class="token function">encrypt</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="8"></td><td><pre>    p <span class="token operator">=</span> getPrime<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="9"></td><td><pre>    q <span class="token operator">=</span> getPrime<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="10"></td><td><pre>    e <span class="token operator">=</span> randint<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> p <span class="token operator">*</span> q<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="11"></td><td><pre>    <span class="token keyword">while</span> gcd<span class="token punctuation">(</span>e<span class="token punctuation">,</span> <span class="token punctuation">(</span>p <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>q <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">1</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="12"></td><td><pre>        e <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>next_prime<span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="13"></td><td><pre>    <span class="token keyword">return</span> e<span class="token punctuation">,</span> p<span class="token punctuation">,</span> q<span class="token punctuation">,</span> <span class="token builtin">pow</span><span class="token punctuation">(</span><span class="token builtin">ord</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">,</span> e<span class="token punctuation">,</span> p <span class="token operator">*</span> q<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="14"></td><td><pre></pre></td></tr><tr><td data-num="15"></td><td><pre><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="16"></td><td><pre>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">list</span><span class="token punctuation">(</span><span class="token builtin">map</span><span class="token punctuation">(</span>encrypt<span class="token punctuation">,</span> flag<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="17"></td><td><pre>    <span class="token comment"># [(12433, 149, 197, 104), (8147, 131, 167, 6633), (10687, 211, 197, 35594), (19681, 131, 211, 15710), (33577, 251, 211, 38798), (30241, 157, 251, 35973), (293, 211, 157, 31548), (26459, 179, 149, 4778), (27479, 149, 223, 32728), (9029, 223, 137, 20696), (4649, 149, 151, 13418), (11783, 223, 251, 14239), (13537, 179, 137, 11702), (3835, 167, 139, 20051), (30983, 149, 227, 23928), (17581, 157, 131, 5855), (35381, 223, 179, 37774), (2357, 151, 223, 1849), (22649, 211, 229, 7348), (1151, 179, 223, 17982), (8431, 251, 163, 30226), (38501, 193, 211, 30559), (14549, 211, 151, 21143), (24781, 239, 241, 45604), (8051, 179, 131, 7994), (863, 181, 131, 11493), (1117, 239, 157, 12579), (7561, 149, 199, 8960), (19813, 239, 229, 53463), (4943, 131, 157, 14606), (29077, 191, 181, 33446), (18583, 211, 163, 31800), (30643, 173, 191, 27293), (11617, 223, 251, 13448), (19051, 191, 151, 21676), (18367, 179, 157, 14139), (18861, 149, 191, 5139), (9581, 211, 193, 25595)]</span></pre></td></tr></table></figure><p>这题其实很好理解，就是要我们求出被 encrypt () 函数加密的 flag</p><p>payload</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">from</span> math <span class="token keyword">import</span> gcd</pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">from</span> random <span class="token keyword">import</span> randint</pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">from</span> gmpy2 <span class="token keyword">import</span> next_prime</pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> getPrime</pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token keyword">import</span> gmpy2</pre></td></tr><tr><td data-num="6"></td><td><pre>xx<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token number">293</span><span class="token punctuation">,</span> <span class="token number">211</span><span class="token punctuation">,</span> <span class="token number">157</span><span class="token punctuation">,</span> <span class="token number">31548</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">26459</span><span class="token punctuation">,</span> <span class="token number">179</span><span class="token punctuation">,</span> <span class="token number">149</span><span class="token punctuation">,</span> <span class="token number">4778</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">27479</span><span class="token punctuation">,</span> <span class="token number">149</span><span class="token punctuation">,</span> <span class="token number">223</span><span class="token punctuation">,</span> <span class="token number">32728</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">9029</span><span class="token punctuation">,</span> <span class="token number">223</span><span class="token punctuation">,</span> <span class="token number">137</span><span class="token punctuation">,</span> <span class="token number">20696</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">4649</span><span class="token punctuation">,</span> <span class="token number">149</span><span class="token punctuation">,</span> <span class="token number">151</span><span class="token punctuation">,</span> <span class="token number">13418</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">11783</span><span class="token punctuation">,</span> <span class="token number">223</span><span class="token punctuation">,</span> <span class="token number">251</span><span class="token punctuation">,</span> <span class="token number">14239</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">13537</span><span class="token punctuation">,</span> <span class="token number">179</span><span class="token punctuation">,</span> <span class="token number">137</span><span class="token punctuation">,</span> <span class="token number">11702</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">3835</span><span class="token punctuation">,</span> <span class="token number">167</span><span class="token punctuation">,</span> <span class="token number">139</span><span class="token punctuation">,</span> <span class="token number">20051</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">30983</span><span class="token punctuation">,</span> <span class="token number">149</span><span class="token punctuation">,</span> <span class="token number">227</span><span class="token punctuation">,</span> <span class="token number">23928</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">17581</span><span class="token punctuation">,</span> <span class="token number">157</span><span class="token punctuation">,</span> <span class="token number">131</span><span class="token punctuation">,</span> <span class="token number">5855</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">35381</span><span class="token punctuation">,</span> <span class="token number">223</span><span class="token punctuation">,</span> <span class="token number">179</span><span class="token punctuation">,</span> <span class="token number">37774</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">2357</span><span class="token punctuation">,</span> <span class="token number">151</span><span class="token punctuation">,</span> <span class="token number">223</span><span class="token punctuation">,</span> <span class="token number">1849</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">22649</span><span class="token punctuation">,</span> <span class="token number">211</span><span class="token punctuation">,</span> <span class="token number">229</span><span class="token punctuation">,</span> <span class="token number">7348</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">1151</span><span class="token punctuation">,</span> <span class="token number">179</span><span class="token punctuation">,</span> <span class="token number">223</span><span class="token punctuation">,</span> <span class="token number">17982</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">8431</span><span class="token punctuation">,</span> <span class="token number">251</span><span class="token punctuation">,</span> <span class="token number">163</span><span class="token punctuation">,</span> <span class="token number">30226</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">38501</span><span class="token punctuation">,</span> <span class="token number">193</span><span class="token punctuation">,</span> <span class="token number">211</span><span class="token punctuation">,</span> <span class="token number">30559</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">14549</span><span class="token punctuation">,</span> <span class="token number">211</span><span class="token punctuation">,</span> <span class="token number">151</span><span class="token punctuation">,</span> <span class="token number">21143</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">24781</span><span class="token punctuation">,</span> <span class="token number">239</span><span class="token punctuation">,</span> <span class="token number">241</span><span class="token punctuation">,</span> <span class="token number">45604</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">8051</span><span class="token punctuation">,</span> <span class="token number">179</span><span class="token punctuation">,</span> <span class="token number">131</span><span class="token punctuation">,</span> <span class="token number">7994</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">863</span><span class="token punctuation">,</span> <span class="token number">181</span><span class="token punctuation">,</span> <span class="token number">131</span><span class="token punctuation">,</span> <span class="token number">11493</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">1117</span><span class="token punctuation">,</span> <span class="token number">239</span><span class="token punctuation">,</span> <span class="token number">157</span><span class="token punctuation">,</span> <span class="token number">12579</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">7561</span><span class="token punctuation">,</span> <span class="token number">149</span><span class="token punctuation">,</span> <span class="token number">199</span><span class="token punctuation">,</span> <span class="token number">8960</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">19813</span><span class="token punctuation">,</span> <span class="token number">239</span><span class="token punctuation">,</span> <span class="token number">229</span><span class="token punctuation">,</span> <span class="token number">53463</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">4943</span><span class="token punctuation">,</span> <span class="token number">131</span><span class="token punctuation">,</span> <span class="token number">157</span><span class="token punctuation">,</span> <span class="token number">14606</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">29077</span><span class="token punctuation">,</span> <span class="token number">191</span><span class="token punctuation">,</span> <span class="token number">181</span><span class="token punctuation">,</span> <span class="token number">33446</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">18583</span><span class="token punctuation">,</span> <span class="token number">211</span><span class="token punctuation">,</span> <span class="token number">163</span><span class="token punctuation">,</span> <span class="token number">31800</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">30643</span><span class="token punctuation">,</span> <span class="token number">173</span><span class="token punctuation">,</span> <span class="token number">191</span><span class="token punctuation">,</span> <span class="token number">27293</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">11617</span><span class="token punctuation">,</span> <span class="token number">223</span><span class="token punctuation">,</span> <span class="token number">251</span><span class="token punctuation">,</span> <span class="token number">13448</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">19051</span><span class="token punctuation">,</span> <span class="token number">191</span><span class="token punctuation">,</span> <span class="token number">151</span><span class="token punctuation">,</span> <span class="token number">21676</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">18367</span><span class="token punctuation">,</span> <span class="token number">179</span><span class="token punctuation">,</span> <span class="token number">157</span><span class="token punctuation">,</span> <span class="token number">14139</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">18861</span><span class="token punctuation">,</span> <span class="token number">149</span><span class="token punctuation">,</span> <span class="token number">191</span><span class="token punctuation">,</span> <span class="token number">5139</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">9581</span><span class="token punctuation">,</span> <span class="token number">211</span><span class="token punctuation">,</span> <span class="token number">193</span><span class="token punctuation">,</span> <span class="token number">25595</span><span class="token punctuation">)</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="7"></td><td><pre></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token keyword">for</span> fine <span class="token keyword">in</span> xx<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="9"></td><td><pre>    e<span class="token operator">=</span>fine<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="10"></td><td><pre>    p<span class="token operator">=</span>fine<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="11"></td><td><pre>    q<span class="token operator">=</span>fine<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="12"></td><td><pre></pre></td></tr><tr><td data-num="13"></td><td><pre><span class="token comment">#e=30241</span></pre></td></tr><tr><td data-num="14"></td><td><pre><span class="token comment">#p=157</span></pre></td></tr><tr><td data-num="15"></td><td><pre><span class="token comment">#q=251</span></pre></td></tr><tr><td data-num="16"></td><td><pre>    c<span class="token operator">=</span> <span class="token punctuation">[</span><span class="token builtin">chr</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">33</span><span class="token punctuation">,</span> <span class="token number">127</span><span class="token punctuation">)</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="17"></td><td><pre>    <span class="token keyword">for</span> i <span class="token keyword">in</span> c<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="18"></td><td><pre>      a<span class="token operator">=</span>gmpy2<span class="token punctuation">.</span>powmod<span class="token punctuation">(</span><span class="token builtin">ord</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">,</span>e<span class="token punctuation">,</span>p<span class="token operator">*</span>q<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="19"></td><td><pre>      <span class="token keyword">if</span><span class="token punctuation">(</span>a<span class="token operator">==</span>fine<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="20"></td><td><pre>         <span class="token keyword">print</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="21"></td><td><pre>   <span class="token comment">#hgame&#123;&#125;</span></pre></td></tr><tr><td data-num="22"></td><td><pre><span class="token comment">#list(map(encrypt, flag))=[(293, 211, 157, 31548), (26459, 179, 149, 4778), (27479, 149, 223, 32728), (9029, 223, 137, 20696), (4649, 149, 151, 13418), (11783, 223, 251, 14239), (13537, 179, 137, 11702), (3835, 167, 139, 20051), (30983, 149, 227, 23928), (17581, 157, 131, 5855), (35381, 223, 179, 37774), (2357, 151, 223, 1849), (22649, 211, 229, 7348), (1151, 179, 223, 17982), (8431, 251, 163, 30226), (38501, 193, 211, 30559), (14549, 211, 151, 21143), (24781, 239, 241, 45604), (8051, 179, 131, 7994), (863, 181, 131, 11493), (1117, 239, 157, 12579), (7561, 149, 199, 8960), (19813, 239, 229, 53463), (4943, 131, 157, 14606), (29077, 191, 181, 33446), (18583, 211, 163, 31800), (30643, 173, 191, 27293), (11617, 223, 251, 13448), (19051, 191, 151, 21676), (18367, 179, 157, 14139), (18861, 149, 191, 5139), (9581, 211, 193, 25595)]</span></pre></td></tr></table></figure><h2 id="rsa-attack"><a class="anchor" href="#rsa-attack">#</a> RSA Attack</h2><p>源码</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> getPrime</pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">from</span> libnum <span class="token keyword">import</span> s2n</pre></td></tr><tr><td data-num="3"></td><td><pre></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">from</span> secret <span class="token keyword">import</span> flag</pre></td></tr><tr><td data-num="5"></td><td><pre></pre></td></tr><tr><td data-num="6"></td><td><pre>m <span class="token operator">=</span> s2n<span class="token punctuation">(</span>flag<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="7"></td><td><pre>e <span class="token operator">=</span> <span class="token number">65537</span></pre></td></tr><tr><td data-num="8"></td><td><pre>p <span class="token operator">=</span> getPrime<span class="token punctuation">(</span><span class="token number">80</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="9"></td><td><pre>q <span class="token operator">=</span> getPrime<span class="token punctuation">(</span><span class="token number">80</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="10"></td><td><pre>n <span class="token operator">=</span> p <span class="token operator">*</span> q</pre></td></tr><tr><td data-num="11"></td><td><pre>c <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>m<span class="token punctuation">,</span> e<span class="token punctuation">,</span> n<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="12"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"e ="</span><span class="token punctuation">,</span> e<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="13"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"n ="</span><span class="token punctuation">,</span> n<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="14"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"c ="</span><span class="token punctuation">,</span> c<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="15"></td><td><pre></pre></td></tr><tr><td data-num="16"></td><td><pre><span class="token comment">#e = 65537</span></pre></td></tr><tr><td data-num="17"></td><td><pre><span class="token comment">#n = 700612512827159827368074182577656505408114629807</span></pre></td></tr><tr><td data-num="18"></td><td><pre><span class="token comment">#c = 122622425510870177715177368049049966519567512708</span></pre></td></tr></table></figure><p>yafu 分解大数 n</p><p>payload</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">import</span> gmpy2</pre></td></tr><tr><td data-num="2"></td><td><pre>p <span class="token operator">=</span> <span class="token number">715800347513314032483037</span></pre></td></tr><tr><td data-num="3"></td><td><pre>q <span class="token operator">=</span> <span class="token number">978782023871716954857211</span></pre></td></tr><tr><td data-num="4"></td><td><pre>e <span class="token operator">=</span> <span class="token number">65537</span></pre></td></tr><tr><td data-num="5"></td><td><pre>c <span class="token operator">=</span> <span class="token number">122622425510870177715177368049049966519567512708</span></pre></td></tr><tr><td data-num="6"></td><td><pre>n <span class="token operator">=</span> p <span class="token operator">*</span> q</pre></td></tr><tr><td data-num="7"></td><td><pre>d<span class="token operator">=</span>gmpy2<span class="token punctuation">.</span>invert<span class="token punctuation">(</span>e<span class="token punctuation">,</span><span class="token punctuation">(</span>p<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>q<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="8"></td><td><pre>m<span class="token operator">=</span>gmpy2<span class="token punctuation">.</span>powmod<span class="token punctuation">(</span>c<span class="token punctuation">,</span>d<span class="token punctuation">,</span>n<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token keyword">import</span> binascii</pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span>binascii<span class="token punctuation">.</span>unhexlify<span class="token punctuation">(</span><span class="token builtin">hex</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr></table></figure><h2 id="rsa-attack2"><a class="anchor" href="#rsa-attack2">#</a> RSA Attack2</h2><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">import</span> re</pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">from</span> math <span class="token keyword">import</span> ceil</pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> getPrime</pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">from</span> libnum <span class="token keyword">import</span> s2n</pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token keyword">from</span> secret <span class="token keyword">import</span> flag</pre></td></tr><tr><td data-num="6"></td><td><pre></pre></td></tr><tr><td data-num="7"></td><td><pre>flag_parts <span class="token operator">=</span> <span class="token string">"这里有段调试了很久blog上传一直debug，看源码就去百度吧"</span></pre></td></tr><tr><td data-num="8"></td><td><pre></pre></td></tr><tr><td data-num="9"></td><td><pre></pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"# task1"</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="11"></td><td><pre>m <span class="token operator">=</span> flag_parts<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="12"></td><td><pre>e <span class="token operator">=</span> <span class="token number">65537</span></pre></td></tr><tr><td data-num="13"></td><td><pre>p <span class="token operator">=</span> getPrime<span class="token punctuation">(</span><span class="token number">1024</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="14"></td><td><pre>q <span class="token operator">=</span> getPrime<span class="token punctuation">(</span><span class="token number">1024</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="15"></td><td><pre>r <span class="token operator">=</span> getPrime<span class="token punctuation">(</span><span class="token number">1024</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="16"></td><td><pre>n1 <span class="token operator">=</span> p <span class="token operator">*</span> q</pre></td></tr><tr><td data-num="17"></td><td><pre>c1 <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>m<span class="token punctuation">,</span> e<span class="token punctuation">,</span> n1<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="18"></td><td><pre>n2 <span class="token operator">=</span> r <span class="token operator">*</span> q</pre></td></tr><tr><td data-num="19"></td><td><pre>c2 <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>m<span class="token punctuation">,</span> e<span class="token punctuation">,</span> n2<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="20"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"e ="</span><span class="token punctuation">,</span> e<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="21"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"n1 ="</span><span class="token punctuation">,</span> n1<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="22"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"c1 ="</span><span class="token punctuation">,</span> c1<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="23"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"n2 ="</span><span class="token punctuation">,</span> n2<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="24"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"c2 ="</span><span class="token punctuation">,</span> c2<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="25"></td><td><pre></pre></td></tr><tr><td data-num="26"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"# task2"</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="27"></td><td><pre>m <span class="token operator">=</span> flag_parts<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="28"></td><td><pre>e <span class="token operator">=</span> <span class="token number">7</span></pre></td></tr><tr><td data-num="29"></td><td><pre>p <span class="token operator">=</span> getPrime<span class="token punctuation">(</span><span class="token number">1024</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="30"></td><td><pre>q <span class="token operator">=</span> getPrime<span class="token punctuation">(</span><span class="token number">1024</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="31"></td><td><pre>n <span class="token operator">=</span> p <span class="token operator">*</span> q</pre></td></tr><tr><td data-num="32"></td><td><pre>c <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>m<span class="token punctuation">,</span> e<span class="token punctuation">,</span> n<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="33"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"e ="</span><span class="token punctuation">,</span> e<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="34"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"n ="</span><span class="token punctuation">,</span> n<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="35"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"c ="</span><span class="token punctuation">,</span> c<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="36"></td><td><pre></pre></td></tr><tr><td data-num="37"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"# task3"</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="38"></td><td><pre>m <span class="token operator">=</span> flag_parts<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="39"></td><td><pre>p <span class="token operator">=</span> getPrime<span class="token punctuation">(</span><span class="token number">1024</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="40"></td><td><pre>q <span class="token operator">=</span> getPrime<span class="token punctuation">(</span><span class="token number">1024</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="41"></td><td><pre>n <span class="token operator">=</span> p <span class="token operator">*</span> q</pre></td></tr><tr><td data-num="42"></td><td><pre>e1 <span class="token operator">=</span> getPrime<span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="43"></td><td><pre>e2 <span class="token operator">=</span> getPrime<span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="44"></td><td><pre>c1 <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>m<span class="token punctuation">,</span> e1<span class="token punctuation">,</span> n<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="45"></td><td><pre>c2 <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>m<span class="token punctuation">,</span> e2<span class="token punctuation">,</span> n<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="46"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"n ="</span><span class="token punctuation">,</span> n<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="47"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"e1 ="</span><span class="token punctuation">,</span> e1<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="48"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"c1 ="</span><span class="token punctuation">,</span> c1<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="49"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"e2 ="</span><span class="token punctuation">,</span> e2<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="50"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"c2 ="</span><span class="token punctuation">,</span> c2<span class="token punctuation">)</span></pre></td></tr></table></figure><p>output</p><figure class="highlight html"><figcaption data-lang="HTML"></figcaption><table><tr><td data-num="1"></td><td><pre># task1</pre></td></tr><tr><td data-num="2"></td><td><pre>e = 65537</pre></td></tr><tr><td data-num="3"></td><td><pre>n1 = 14611545605107950827581005165327694782823188603151768169731431418361306231114985037775917461433925308054396970809690804073985835376464629860609710292181368600618626590498491850404503443414241455487304448344892337877422465715709154238653505141605904184985311873763495761345722155289457889686019746663293720106874227323699288277794292208957172446523420596391114891559537811029473150123641624108103676516754449492805126642552751278309634846777636042114135990516245907517377320190091400729277307636724890592155256437996566160995456743018225013851937593886086129131351582958811003596445806061492952513851932238563627194553</pre></td></tr><tr><td data-num="4"></td><td><pre>c1 = 965075803554932988664271816439183802328812013694203741320763105376036912584995031647672348468111310423680858101990670067065306237596121664884353679987689532305437801346923070145524106271337770666947677115752724993307387122132705797012726237073550669419110046308257408484535063515678066777681017211510981429273346928022971149411064556225001287399141306136081722471075032423079692908380267160214143720516748000734987068685104675254411687005690312116824966036851568223828884335112144637268090397158532937141122654075952730052331573980701136378212002956719295192733955673315234274064519957670199895100508623561838510479</pre></td></tr><tr><td data-num="5"></td><td><pre>n2 = 20937478725109983803079185450449616567464596961348727453817249035110047585580142823551289577145958127121586792878509386085178452171112455890429474457797219202827030884262273061334752493496797935346631509806685589179618367453992749753318273834113016237120686880514110415113673431170488958730203963489455418967544128619234394915820392908422974075932751838012185542968842691824203206517795693893863945100661940988455695923511777306566419373394091907349431686646485516325575494902682337518438042711296437513221448397034813099279203955535025939120139680604495486980765910892438284945450733375156933863150808369796830892363</pre></td></tr><tr><td data-num="6"></td><td><pre>c2 = 11536506945313747180442473461658912307154460869003392732178457643224057969838224601059836860883718459986003106970375778443725748607085620938787714081321315817144414115589952237492448483438910378865359239575169326116668030463275817609827626048962304593324479546453471881099976644410889657248346038986836461779780183411686260756776711720577053319504691373550107525296560936467435283812493396486678178020292433365898032597027338876045182743492831814175673834198345337514065596396477709839868387265840430322983945906464646824470437783271607499089791869398590557314713094674208261761299894705772513440948139429011425948090</pre></td></tr><tr><td data-num="7"></td><td><pre># task2</pre></td></tr><tr><td data-num="8"></td><td><pre>e = 7</pre></td></tr><tr><td data-num="9"></td><td><pre>n = 14157878492255346300993349653813018105991884577529909522555551468374307942096214964604172734381913051273745228293930832314483466922529240958994897697475939867025561348042725919663546949015024693952641936481841552751484604123097148071800416608762258562797116583678332832015617217745966495992049762530373531163821979627361200921544223578170718741348242012164115593777700903954409103110092921578821048933346893212805071682235575813724113978341592885957767377587492202740185970828629767501662195356276862585025913615910839679860669917255271734413865211340126544199760628445054131661484184876679626946360753009512634349537</pre></td></tr><tr><td data-num="10"></td><td><pre>c = 10262871020519116406312674685238364023536657841034751572844570983750295909492149101500869806418603732181350082576447594766587572350246675445508931577670158295558641219582729345581697448231116318080456112516700717984731655900726388185866905989088504004805024490513718243036445638662260558477697146032055765285263446084259814560197549018044099935158351931885157616527235283229066145390964094929007056946332051364474528453970904251050605631514869007890625</pre></td></tr><tr><td data-num="11"></td><td><pre># task3</pre></td></tr><tr><td data-num="12"></td><td><pre>n = 18819509188106230363444813350468162056164434642729404632983082518225388069544777374544142317612858448345344137372222988033366528086236635213756227816610865045924357232188768913642158448603346330462535696121739622702200540344105464126695432011739181531217582949804939555720700457350512898322376591813135311921904580338340203569582681889243452495363849558955947124975293736509426400460083981078846138740050634906824438689712748324336878791622676974341814691041262280604277357889892211717124319329666052810029131172229930723477981468761369516771720250571713027972064974999802168017946274736383148001865929719248159075729</pre></td></tr><tr><td data-num="13"></td><td><pre>e1 = 2519901323</pre></td></tr><tr><td data-num="14"></td><td><pre>c1 = 3230779726225544872531441169009307072073754578761888387983403206364548451496736513905460381907928107310030086346589351105809028599650303539607581407627819797944337398601400510560992462455048451326593993595089800150342999021874734748066692962362650540036002073748766509347649818139304363914083879918929873577706323599628031618641793074018304521243460487551364823299685052518852685706687800209505277426869140051056996242882132616256695188870782634310362973153766698286258946896866396670872451803114280846709572779780558482223393759475999103607704510618332253710503857561025613632592682931552228150171423846203875344870</pre></td></tr><tr><td data-num="15"></td><td><pre>e2 = 3676335737</pre></td></tr><tr><td data-num="16"></td><td><pre>c2 = 940818595622279161439836719641707846790294650888799822335007385854166736459283129434769062995122371073636785371800857633841379139761091890426137981113087519934854663776695944489430385663011713917022574342380155718317794204988626116362865144125136624722782309455452257758808172415884403909840651554485364309237853885251876941477098008690389600544398998669635962495989736021020715396415375890720335697504837045188626103142204474942751410819466379437091569610294575687793060945525108986660851277475079994466474859114092643797418927645726430175928247476884879817034346652560116597965191204061051401916282814886688467861</pre></td></tr></table></figure><p>payload</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">import</span> gmpy2</pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">from</span> math <span class="token keyword">import</span> gcd</pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">from</span> gmpy2 <span class="token keyword">import</span> invert</pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">from</span> libnum <span class="token keyword">import</span> n2s<span class="token punctuation">,</span>xgcd</pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token comment"># task1  分解公因子</span></pre></td></tr><tr><td data-num="6"></td><td><pre></pre></td></tr><tr><td data-num="7"></td><td><pre>e <span class="token operator">=</span> <span class="token number">65537</span></pre></td></tr><tr><td data-num="8"></td><td><pre>n1 <span class="token operator">=</span> <span class="token number">14611545605107950827581005165327694782823188603151768169731431418361306231114985037775917461433925308054396970809690804073985835376464629860609710292181368600618626590498491850404503443414241455487304448344892337877422465715709154238653505141605904184985311873763495761345722155289457889686019746663293720106874227323699288277794292208957172446523420596391114891559537811029473150123641624108103676516754449492805126642552751278309634846777636042114135990516245907517377320190091400729277307636724890592155256437996566160995456743018225013851937593886086129131351582958811003596445806061492952513851932238563627194553</span></pre></td></tr><tr><td data-num="9"></td><td><pre>c1 <span class="token operator">=</span> <span class="token number">965075803554932988664271816439183802328812013694203741320763105376036912584995031647672348468111310423680858101990670067065306237596121664884353679987689532305437801346923070145524106271337770666947677115752724993307387122132705797012726237073550669419110046308257408484535063515678066777681017211510981429273346928022971149411064556225001287399141306136081722471075032423079692908380267160214143720516748000734987068685104675254411687005690312116824966036851568223828884335112144637268090397158532937141122654075952730052331573980701136378212002956719295192733955673315234274064519957670199895100508623561838510479</span></pre></td></tr><tr><td data-num="10"></td><td><pre>n2 <span class="token operator">=</span> <span class="token number">20937478725109983803079185450449616567464596961348727453817249035110047585580142823551289577145958127121586792878509386085178452171112455890429474457797219202827030884262273061334752493496797935346631509806685589179618367453992749753318273834113016237120686880514110415113673431170488958730203963489455418967544128619234394915820392908422974075932751838012185542968842691824203206517795693893863945100661940988455695923511777306566419373394091907349431686646485516325575494902682337518438042711296437513221448397034813099279203955535025939120139680604495486980765910892438284945450733375156933863150808369796830892363</span></pre></td></tr><tr><td data-num="11"></td><td><pre>c2 <span class="token operator">=</span> <span class="token number">11536506945313747180442473461658912307154460869003392732178457643224057969838224601059836860883718459986003106970375778443725748607085620938787714081321315817144414115589952237492448483438910378865359239575169326116668030463275817609827626048962304593324479546453471881099976644410889657248346038986836461779780183411686260756776711720577053319504691373550107525296560936467435283812493396486678178020292433365898032597027338876045182743492831814175673834198345337514065596396477709839868387265840430322983945906464646824470437783271607499089791869398590557314713094674208261761299894705772513440948139429011425948090</span></pre></td></tr><tr><td data-num="12"></td><td><pre>q<span class="token operator">=</span>gcd<span class="token punctuation">(</span>n1<span class="token punctuation">,</span>n2<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="13"></td><td><pre>p<span class="token operator">=</span>n1<span class="token operator">//</span>q</pre></td></tr><tr><td data-num="14"></td><td><pre>r<span class="token operator">=</span>n2<span class="token operator">//</span>q</pre></td></tr><tr><td data-num="15"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span>n2s<span class="token punctuation">(</span><span class="token builtin">pow</span><span class="token punctuation">(</span>c1<span class="token punctuation">,</span><span class="token builtin">int</span><span class="token punctuation">(</span>invert<span class="token punctuation">(</span>e<span class="token punctuation">,</span><span class="token punctuation">(</span>p<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>q<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>n1<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>end<span class="token operator">=</span><span class="token string">""</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="16"></td><td><pre></pre></td></tr><tr><td data-num="17"></td><td><pre><span class="token comment"># task2 低加密指数攻击</span></pre></td></tr><tr><td data-num="18"></td><td><pre></pre></td></tr><tr><td data-num="19"></td><td><pre>e <span class="token operator">=</span> <span class="token number">7</span></pre></td></tr><tr><td data-num="20"></td><td><pre>n <span class="token operator">=</span> <span class="token number">14157878492255346300993349653813018105991884577529909522555551468374307942096214964604172734381913051273745228293930832314483466922529240958994897697475939867025561348042725919663546949015024693952641936481841552751484604123097148071800416608762258562797116583678332832015617217745966495992049762530373531163821979627361200921544223578170718741348242012164115593777700903954409103110092921578821048933346893212805071682235575813724113978341592885957767377587492202740185970828629767501662195356276862585025913615910839679860669917255271734413865211340126544199760628445054131661484184876679626946360753009512634349537</span></pre></td></tr><tr><td data-num="21"></td><td><pre>c <span class="token operator">=</span> <span class="token number">10262871020519116406312674685238364023536657841034751572844570983750295909492149101500869806418603732181350082576447594766587572350246675445508931577670158295558641219582729345581697448231116318080456112516700717984731655900726388185866905989088504004805024490513718243036445638662260558477697146032055765285263446084259814560197549018044099935158351931885157616527235283229066145390964094929007056946332051364474528453970904251050605631514869007890625</span></pre></td></tr><tr><td data-num="22"></td><td><pre></pre></td></tr><tr><td data-num="23"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span>n2s<span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span>gmpy2<span class="token punctuation">.</span>iroot<span class="token punctuation">(</span>c<span class="token punctuation">,</span>e<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>end<span class="token operator">=</span><span class="token string">""</span><span class="token punctuation">)</span> <span class="token comment">#c 开 e 次根 m=pow (c,d,n) d=invert (e,(p-1)*(q-1))</span></pre></td></tr><tr><td data-num="24"></td><td><pre></pre></td></tr><tr><td data-num="25"></td><td><pre><span class="token comment"># task3 共模攻击</span></pre></td></tr><tr><td data-num="26"></td><td><pre></pre></td></tr><tr><td data-num="27"></td><td><pre>n <span class="token operator">=</span> <span class="token number">18819509188106230363444813350468162056164434642729404632983082518225388069544777374544142317612858448345344137372222988033366528086236635213756227816610865045924357232188768913642158448603346330462535696121739622702200540344105464126695432011739181531217582949804939555720700457350512898322376591813135311921904580338340203569582681889243452495363849558955947124975293736509426400460083981078846138740050634906824438689712748324336878791622676974341814691041262280604277357889892211717124319329666052810029131172229930723477981468761369516771720250571713027972064974999802168017946274736383148001865929719248159075729</span></pre></td></tr><tr><td data-num="28"></td><td><pre>e1 <span class="token operator">=</span> <span class="token number">2519901323</span></pre></td></tr><tr><td data-num="29"></td><td><pre>c1 <span class="token operator">=</span> <span class="token number">3230779726225544872531441169009307072073754578761888387983403206364548451496736513905460381907928107310030086346589351105809028599650303539607581407627819797944337398601400510560992462455048451326593993595089800150342999021874734748066692962362650540036002073748766509347649818139304363914083879918929873577706323599628031618641793074018304521243460487551364823299685052518852685706687800209505277426869140051056996242882132616256695188870782634310362973153766698286258946896866396670872451803114280846709572779780558482223393759475999103607704510618332253710503857561025613632592682931552228150171423846203875344870</span></pre></td></tr><tr><td data-num="30"></td><td><pre>e2 <span class="token operator">=</span> <span class="token number">3676335737</span></pre></td></tr><tr><td data-num="31"></td><td><pre>c2 <span class="token operator">=</span> <span class="token number">940818595622279161439836719641707846790294650888799822335007385854166736459283129434769062995122371073636785371800857633841379139761091890426137981113087519934854663776695944489430385663011713917022574342380155718317794204988626116362865144125136624722782309455452257758808172415884403909840651554485364309237853885251876941477098008690389600544398998669635962495989736021020715396415375890720335697504837045188626103142204474942751410819466379437091569610294575687793060945525108986660851277475079994466474859114092643797418927645726430175928247476884879817034346652560116597965191204061051401916282814886688467861</span></pre></td></tr><tr><td data-num="32"></td><td><pre></pre></td></tr><tr><td data-num="33"></td><td><pre>s1<span class="token punctuation">,</span>s2<span class="token punctuation">,</span>_<span class="token operator">=</span>xgcd<span class="token punctuation">(</span>e1<span class="token punctuation">,</span>e2<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="34"></td><td><pre><span class="token keyword">if</span> s1<span class="token operator">&lt;</span><span class="token number">0</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="35"></td><td><pre>    s1<span class="token operator">=</span><span class="token operator">-</span>s1</pre></td></tr><tr><td data-num="36"></td><td><pre>    c1<span class="token operator">=</span><span class="token builtin">int</span><span class="token punctuation">(</span>invert<span class="token punctuation">(</span>c1<span class="token punctuation">,</span>n<span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="37"></td><td><pre><span class="token keyword">if</span> s2<span class="token operator">&lt;</span><span class="token number">0</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="38"></td><td><pre>    s2<span class="token operator">=</span><span class="token operator">-</span>s2</pre></td></tr><tr><td data-num="39"></td><td><pre>    c2<span class="token operator">=</span><span class="token builtin">int</span><span class="token punctuation">(</span>invert<span class="token punctuation">(</span>c2<span class="token punctuation">,</span>n<span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="40"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span>n2s<span class="token punctuation">(</span><span class="token builtin">pow</span><span class="token punctuation">(</span>c1<span class="token punctuation">,</span>s1<span class="token punctuation">,</span>n<span class="token punctuation">)</span><span class="token operator">*</span><span class="token builtin">pow</span><span class="token punctuation">(</span>c2<span class="token punctuation">,</span>s2<span class="token punctuation">,</span>n<span class="token punctuation">)</span><span class="token operator">%</span>n<span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr></table></figure><p>在此普及一下<br>低加密指数分解攻击<br>e=2 把密文 c 开平方求解<br>RSA 加密，由于 e 只有 2，相当于把明文 m 平方而已，得到的 c 也比 n 小很多。尝试把 c 开根号看能否得到明文。一般的 python 开根号方法精度较低，对大整数开出来的根号准确度低。发现使用 gmpy2 库可以对大整数开根号。iroot<br>e=2 Rabin 加密中的 N 可被分解<br>e<mark>2, 并不都是 Rabin 加密，但是 e</mark>2 是 Rabin 加密典型特征</p><p>共模攻击<br>明文 m、模数 n 相同，公钥指数 e、密文 c 不同，gcd (e1,e2)==1<br>对同一明文的多次加密使用相同的模数和不同的公钥指数可能导致共模攻击。</p><h2 id="multi-prime-rsa"><a class="anchor" href="#multi-prime-rsa">#</a> Multi Prime RSA</h2><p>源码</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> getPrime</pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">from</span> gmpy2 <span class="token keyword">import</span> invert</pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">from</span> libnum <span class="token keyword">import</span> s2n</pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">from</span> secret <span class="token keyword">import</span> flag</pre></td></tr><tr><td data-num="5"></td><td><pre></pre></td></tr><tr><td data-num="6"></td><td><pre>p <span class="token operator">=</span> getPrime<span class="token punctuation">(</span><span class="token number">2048</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="7"></td><td><pre>q <span class="token operator">=</span> getPrime<span class="token punctuation">(</span><span class="token number">2048</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="8"></td><td><pre>n <span class="token operator">=</span> p <span class="token operator">*</span> q</pre></td></tr><tr><td data-num="9"></td><td><pre>d <span class="token operator">=</span> getPrime<span class="token punctuation">(</span><span class="token number">64</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="10"></td><td><pre>e <span class="token operator">=</span> invert<span class="token punctuation">(</span>d<span class="token punctuation">,</span> <span class="token punctuation">(</span>p <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>q <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="11"></td><td><pre>c <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>s2n<span class="token punctuation">(</span>flag<span class="token punctuation">)</span><span class="token punctuation">,</span> e<span class="token punctuation">,</span> n<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="12"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"n = </span><span class="token interpolation"><span class="token punctuation">&#123;</span>n<span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="13"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"e = </span><span class="token interpolation"><span class="token punctuation">&#123;</span>e<span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="14"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"c = </span><span class="token interpolation"><span class="token punctuation">&#123;</span>c<span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="15"></td><td><pre></pre></td></tr><tr><td data-num="16"></td><td><pre><span class="token comment">#n = 507419170088344932990702256911694788408493968749527614421614568612944144764889717229444020813658893362983714454159980719026366361318789415279417172858536381938870379267670180128174798344744371725609827872339512302232610590888649555446972990419313445687852636305518801236132032618350847705234643521557851434711389664130274468354405273873218264222293858509477860634889001898462547712800153111774564939279190835857445378261920532206352364005840238252284065587291779196975457288580812526597185332036342330147250312262816994625317482869849388424397437470502449815132000588425028055964432298176942124697105509057090546600330760364385753313923003549670107599757996810939165300581847068233156887269181096893089415302163770884312255957584660964506028002922164767453287973102961910781312351686488047510932997937700597992705557881172640175117476017503918294534205898046483981707558521558992058512940087192655700351675718815723840568640509355338482631416345193176708501897458649841539192993142790402734898948352382350766125000186026261167277014748183012844440603384989647664190074853086693408529737767147592432979469020671772152652865219092597717869942730499507426269170189547020660681363276871874469322437194397171763927907099922324375991793759</span></pre></td></tr><tr><td data-num="17"></td><td><pre><span class="token comment">#e = 77310199867448677782081572109343472783781135641712597643597122591443011229091533516758925238949755491395489408922437493670252550920826641442189683907973926843505436730014899918587477913032286153545247063493885982941194996251799882984145155733050069564485120660716110828110738784644223519725613280140006783618393995138076030616463398284819550627612102010214315235269945251741407899692274978642663650687157736417831290404871181902463904311095448368498432147292938825418930527188720696497596867575843476810225152659244529481480993843168383016583068747733118703000287423374094051895724494193455175131120243097065270804457787026492578916584536863548445813916819417857064037664101684455000184987531252344582899589746272173970083733130106407810619258077266603898529285634495710846838011858287024329514491058790557305041389614650730267774482954666726949886313386881066593946789460028399523245777171320319444673551268379126203862576627540177888290265714418064334752499940587750374552330008143708562065940245637685833371348603338834447212248648869514585047871442060412622164276894766238383894693759347590977926306581080390685360615407766600573527565016914830132066428454738135380178959590692145577418811677639050929791996313180297924833690095</span></pre></td></tr><tr><td data-num="18"></td><td><pre><span class="token comment">#c = 165251729917394529793163344300848992394021337429474789711805041655116845722480301677817165053253655027459227404782607373107477419083333844871948673626672704233977397989843349633720167495862807995411682262559392496273163155214888276398332204954185252030616473235814999366132031184631541209554169938146205402400412307638567132128690379079483633171535375278689326189057930259534983374296873110199636558962144635514392282351103900375366360933088605794654279480277782805401749872568584335215630740265944133347038070337891035560658434763924576508969938866566235926587685108811154229747423410476421860059769485356567301897413767088823807510568561254627099309752215808220067495561412081320541540679503218232020279947159175547517811501280846596226165148013762293861131544331444165070186672186027410082671602892508739473724143698396105392623164025712124329254933353509384748403154342322725203183050328143736631333990445537119855865348221215277608372952942702104088940952142851523651639574409075484106857403651453121036577767672430612728022444370874223001778580387635197325043524719396707713385963432915855227152371800527536048555551237729690663544828830627192867570345853910196397851763591543484023134551876591248557980182981967782409054277224</span></pre></td></tr></table></figure><p>e 太大 可使用算法从 e 中快速推断出 d 的值。 可使用 Wiener’s Attack 进行解 d<br>求出 d 可直接求 m</p><p>在此贴一个维纳攻击的脚本</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">import</span> ContinuedFractions<span class="token punctuation">,</span> Arithmetic<span class="token punctuation">,</span> RSAvulnerableKeyGenerator</pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> long_to_bytes</pre></td></tr><tr><td data-num="3"></td><td><pre></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">def</span> <span class="token function">hack_RSA</span><span class="token punctuation">(</span>e<span class="token punctuation">,</span>n<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="5"></td><td><pre>    <span class="token triple-quoted-string string">'''</span></pre></td></tr><tr><td data-num="6"></td><td><pre>    Finds d knowing (e,n)</pre></td></tr><tr><td data-num="7"></td><td><pre>    applying the Wiener continued fraction attack</pre></td></tr><tr><td data-num="8"></td><td><pre>    '''</pre></td></tr><tr><td data-num="9"></td><td><pre>    frac <span class="token operator">=</span> ContinuedFractions<span class="token punctuation">.</span>rational_to_contfrac<span class="token punctuation">(</span>e<span class="token punctuation">,</span> n<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="10"></td><td><pre>    convergents <span class="token operator">=</span> ContinuedFractions<span class="token punctuation">.</span>convergents_from_contfrac<span class="token punctuation">(</span>frac<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="11"></td><td><pre>    </pre></td></tr><tr><td data-num="12"></td><td><pre>    <span class="token keyword">for</span> <span class="token punctuation">(</span>k<span class="token punctuation">,</span>d<span class="token punctuation">)</span> <span class="token keyword">in</span> convergents<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="13"></td><td><pre>        </pre></td></tr><tr><td data-num="14"></td><td><pre>        <span class="token comment">#check if d is actually the key</span></pre></td></tr><tr><td data-num="15"></td><td><pre>        <span class="token keyword">if</span> k<span class="token operator">!=</span><span class="token number">0</span> <span class="token keyword">and</span> <span class="token punctuation">(</span>e<span class="token operator">*</span>d<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">%</span>k <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="16"></td><td><pre>            phi <span class="token operator">=</span> <span class="token punctuation">(</span>e<span class="token operator">*</span>d<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">//</span>k</pre></td></tr><tr><td data-num="17"></td><td><pre>            s <span class="token operator">=</span> n <span class="token operator">-</span> phi <span class="token operator">+</span> <span class="token number">1</span></pre></td></tr><tr><td data-num="18"></td><td><pre>            <span class="token comment"># check if the equation x^2 - s*x + n = 0</span></pre></td></tr><tr><td data-num="19"></td><td><pre>            <span class="token comment"># has integer roots</span></pre></td></tr><tr><td data-num="20"></td><td><pre>            discr <span class="token operator">=</span> s<span class="token operator">*</span>s <span class="token operator">-</span> <span class="token number">4</span><span class="token operator">*</span>n</pre></td></tr><tr><td data-num="21"></td><td><pre>            <span class="token keyword">if</span><span class="token punctuation">(</span>discr<span class="token operator">>=</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="22"></td><td><pre>                t <span class="token operator">=</span> Arithmetic<span class="token punctuation">.</span>is_perfect_square<span class="token punctuation">(</span>discr<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="23"></td><td><pre>                <span class="token keyword">if</span> t<span class="token operator">!=</span><span class="token operator">-</span><span class="token number">1</span> <span class="token keyword">and</span> <span class="token punctuation">(</span>s<span class="token operator">+</span>t<span class="token punctuation">)</span><span class="token operator">%</span><span class="token number">2</span><span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="24"></td><td><pre>                    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Hacked!"</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="25"></td><td><pre>                    <span class="token keyword">return</span> d</pre></td></tr><tr><td data-num="26"></td><td><pre><span class="token keyword">def</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="27"></td><td><pre>    n <span class="token operator">=</span> <span class="token number">507419170088344932990702256911694788408493968749527614421614568612944144764889717229444020813658893362983714454159980719026366361318789415279417172858536381938870379267670180128174798344744371725609827872339512302232610590888649555446972990419313445687852636305518801236132032618350847705234643521557851434711389664130274468354405273873218264222293858509477860634889001898462547712800153111774564939279190835857445378261920532206352364005840238252284065587291779196975457288580812526597185332036342330147250312262816994625317482869849388424397437470502449815132000588425028055964432298176942124697105509057090546600330760364385753313923003549670107599757996810939165300581847068233156887269181096893089415302163770884312255957584660964506028002922164767453287973102961910781312351686488047510932997937700597992705557881172640175117476017503918294534205898046483981707558521558992058512940087192655700351675718815723840568640509355338482631416345193176708501897458649841539192993142790402734898948352382350766125000186026261167277014748183012844440603384989647664190074853086693408529737767147592432979469020671772152652865219092597717869942730499507426269170189547020660681363276871874469322437194397171763927907099922324375991793759</span></pre></td></tr><tr><td data-num="28"></td><td><pre>    e <span class="token operator">=</span> <span class="token number">77310199867448677782081572109343472783781135641712597643597122591443011229091533516758925238949755491395489408922437493670252550920826641442189683907973926843505436730014899918587477913032286153545247063493885982941194996251799882984145155733050069564485120660716110828110738784644223519725613280140006783618393995138076030616463398284819550627612102010214315235269945251741407899692274978642663650687157736417831290404871181902463904311095448368498432147292938825418930527188720696497596867575843476810225152659244529481480993843168383016583068747733118703000287423374094051895724494193455175131120243097065270804457787026492578916584536863548445813916819417857064037664101684455000184987531252344582899589746272173970083733130106407810619258077266603898529285634495710846838011858287024329514491058790557305041389614650730267774482954666726949886313386881066593946789460028399523245777171320319444673551268379126203862576627540177888290265714418064334752499940587750374552330008143708562065940245637685833371348603338834447212248648869514585047871442060412622164276894766238383894693759347590977926306581080390685360615407766600573527565016914830132066428454738135380178959590692145577418811677639050929791996313180297924833690095</span></pre></td></tr><tr><td data-num="29"></td><td><pre>    d<span class="token operator">=</span>hack_RSA<span class="token punctuation">(</span>e<span class="token punctuation">,</span>n<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="30"></td><td><pre>    c <span class="token operator">=</span> <span class="token number">165251729917394529793163344300848992394021337429474789711805041655116845722480301677817165053253655027459227404782607373107477419083333844871948673626672704233977397989843349633720167495862807995411682262559392496273163155214888276398332204954185252030616473235814999366132031184631541209554169938146205402400412307638567132128690379079483633171535375278689326189057930259534983374296873110199636558962144635514392282351103900375366360933088605794654279480277782805401749872568584335215630740265944133347038070337891035560658434763924576508969938866566235926587685108811154229747423410476421860059769485356567301897413767088823807510568561254627099309752215808220067495561412081320541540679503218232020279947159175547517811501280846596226165148013762293861131544331444165070186672186027410082671602892508739473724143698396105392623164025712124329254933353509384748403154342322725203183050328143736631333990445537119855865348221215277608372952942702104088940952142851523651639574409075484106857403651453121036577767672430612728022444370874223001778580387635197325043524719396707713385963432915855227152371800527536048555551237729690663544828830627192867570345853910196397851763591543484023134551876591248557980182981967782409054277224</span></pre></td></tr><tr><td data-num="31"></td><td><pre>    r<span class="token operator">=</span><span class="token builtin">pow</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span>d<span class="token punctuation">,</span>n<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="32"></td><td><pre>    flag<span class="token operator">=</span>long_to_bytes<span class="token punctuation">(</span>r<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="33"></td><td><pre>    <span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="34"></td><td><pre>main<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr></table></figure><h2 id="ecc"><a class="anchor" href="#ecc">#</a> ECC</h2><p>在网安数学的教材上看到过椭圆曲线加密，海量的公式＋复杂的绘图。嗯，这一定很 BT</p><p>这道题的源码如下</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> getPrime</pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">from</span> libnum <span class="token keyword">import</span> s2n</pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">from</span> secret <span class="token keyword">import</span> flag</pre></td></tr><tr><td data-num="4"></td><td><pre></pre></td></tr><tr><td data-num="5"></td><td><pre>p <span class="token operator">=</span> getPrime<span class="token punctuation">(</span><span class="token number">256</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="6"></td><td><pre>a <span class="token operator">=</span> getPrime<span class="token punctuation">(</span><span class="token number">256</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="7"></td><td><pre>b <span class="token operator">=</span> getPrime<span class="token punctuation">(</span><span class="token number">256</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="8"></td><td><pre>E <span class="token operator">=</span> EllipticCurve<span class="token punctuation">(</span>GF<span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">[</span>a<span class="token punctuation">,</span>b<span class="token punctuation">]</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="9"></td><td><pre>m <span class="token operator">=</span> E<span class="token punctuation">.</span>random_point<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="10"></td><td><pre>G <span class="token operator">=</span> E<span class="token punctuation">.</span>random_point<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="11"></td><td><pre>k <span class="token operator">=</span> getPrime<span class="token punctuation">(</span><span class="token number">256</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="12"></td><td><pre>K <span class="token operator">=</span> k <span class="token operator">*</span> G</pre></td></tr><tr><td data-num="13"></td><td><pre>r <span class="token operator">=</span> getPrime<span class="token punctuation">(</span><span class="token number">256</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="14"></td><td><pre>c1 <span class="token operator">=</span> m <span class="token operator">+</span> r <span class="token operator">*</span> K</pre></td></tr><tr><td data-num="15"></td><td><pre>c2 <span class="token operator">=</span> r <span class="token operator">*</span> G</pre></td></tr><tr><td data-num="16"></td><td><pre>cipher_left <span class="token operator">=</span> s2n<span class="token punctuation">(</span>flag<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token builtin">len</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span><span class="token operator">//</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">*</span> m<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="17"></td><td><pre>cipher_right <span class="token operator">=</span> s2n<span class="token punctuation">(</span>flag<span class="token punctuation">[</span><span class="token builtin">len</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span><span class="token operator">//</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">*</span> m<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="18"></td><td><pre></pre></td></tr><tr><td data-num="19"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"p = </span><span class="token interpolation"><span class="token punctuation">&#123;</span>p<span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="20"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"a = </span><span class="token interpolation"><span class="token punctuation">&#123;</span>a<span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="21"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"b = </span><span class="token interpolation"><span class="token punctuation">&#123;</span>b<span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="22"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"k = </span><span class="token interpolation"><span class="token punctuation">&#123;</span>k<span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="23"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"E = </span><span class="token interpolation"><span class="token punctuation">&#123;</span>E<span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="24"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"c1 = </span><span class="token interpolation"><span class="token punctuation">&#123;</span>c1<span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="25"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"c2 = </span><span class="token interpolation"><span class="token punctuation">&#123;</span>c2<span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="26"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"cipher_left = </span><span class="token interpolation"><span class="token punctuation">&#123;</span>cipher_left<span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="27"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"cipher_right = </span><span class="token interpolation"><span class="token punctuation">&#123;</span>cipher_right<span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="28"></td><td><pre></pre></td></tr><tr><td data-num="29"></td><td><pre></pre></td></tr><tr><td data-num="30"></td><td><pre><span class="token comment">#p = 74997021559434065975272431626618720725838473091721936616560359000648651891507</span></pre></td></tr><tr><td data-num="31"></td><td><pre><span class="token comment">#a = 61739043730332859978236469007948666997510544212362386629062032094925353519657</span></pre></td></tr><tr><td data-num="32"></td><td><pre><span class="token comment">#b = 87821782818477817609882526316479721490919815013668096771992360002467657827319</span></pre></td></tr><tr><td data-num="33"></td><td><pre><span class="token comment">#k = 93653874272176107584459982058527081604083871182797816204772644509623271061231</span></pre></td></tr><tr><td data-num="34"></td><td><pre><span class="token comment">#E = Elliptic Curve defined by y^2 = x^3 + 61739043730332859978236469007948666997510544212362386629062032094925353519657*x + 12824761259043751634610094689861000765081341921946160155432001001819005935812 over Finite Field of size 74997021559434065975272431626618720725838473091721936616560359000648651891507</span></pre></td></tr><tr><td data-num="35"></td><td><pre><span class="token comment">#c1 = (14455613666211899576018835165132438102011988264607146511938249744871964946084 : 25506582570581289714612640493258299813803157561796247330693768146763035791942 : 1)</span></pre></td></tr><tr><td data-num="36"></td><td><pre><span class="token comment">#c2 = (37554871162619456709183509122673929636457622251880199235054734523782483869931 : 71392055540616736539267960989304287083629288530398474590782366384873814477806 : 1)</span></pre></td></tr><tr><td data-num="37"></td><td><pre><span class="token comment">#cipher_left = 68208062402162616009217039034331142786282678107650228761709584478779998734710</span></pre></td></tr><tr><td data-num="38"></td><td><pre><span class="token comment">#cipher_right = 27453988545002384546706933590432585006240439443312571008791835203660152890619</span></pre></td></tr></table></figure><p>真真看不懂，去百度也都是比这道题更难理解的，实在是难以入门；</p><p>搜罗到一些 ECC 的原理，可以看一下。</p><p>找出两个 “很大” 的质数：P &amp; Q<br>N = P * Q<br>M = (P – 1) * (Q – 1)</p><p>找出整数 E，E 与 M 互质，即除了 1 之外，没有其他公约数</p><p>找出整数 D，使得 ED 除以 M 余 1，即 (E D) % M = 1，等价于 E<em>D-1=K</em>M</p><p>经过上述准备工作之后，可以得到：</p><pre><code>E是公钥，负责加密
D是私钥，负责解密
N负责公钥和私钥之间的联系
</code></pre><p>加密算法，假定对 X 进行加密</p><pre><code>(X ^ E) % N = Y
</code></pre><p>解密算法，根据费尔马小定义，可以使用以下公式完成解密</p><pre><code>(Y ^ D) % N = X
</code></pre><p>简单而言，椭圆曲线是基于解决离散问题的算法；给定 K 和 G, 算出 k。（点 G 称为基点，K=kG [其中 K,G 为 Ep (a,b) 上的点，k 为小于 n（n 是点 G 的阶）的整数]）<br>1、用户 A 选定一条椭圆曲线 Ep (a,b)，并取椭圆曲线上一点，作为基点 G。<br>2、用户 A 选择一个私有密钥 k，并生成公开密钥 K=kG。<br>3、用户 A 将 Ep (a,b) 和点 K，G 传给用户 B。<br>4、用户 B 接到信息后 ，将待传输的明文编码到 Ep (a,b) 上一点 M（编码方法很多，这里不作讨论），并产生一个随机整数 r。<br>5、用户 B 计算点 C1=M+rK；C2=rG。<br>6、用户 B 将 C1、C2 传给用户 A。<br>7、用户 A 接到信息后，计算 C1-kC2，结果就是点 M。因为 C1-kC2=M+rK-k (rG)=M+rK-r (kG)=M<br>再对点 M 进行解码就可以得到明文。</p><p>在这个加密通信中，如果有一个偷窥者 H ，他只能看到 Ep (a,b)、K、G、C1、C2，而通过 K、G 求 k 或通过 C2、G 求 r 都是相对困难的，因此，H 无法得到 A、B 间传送的明文信息。</p><p>有的人也会用到 sagemath 下面是使用手册<span class="exturl" data-url="aHR0cHM6Ly93d3cuZG9jaW4uY29tL3AtMTc5MjgwNDkwOS5odG1s"></span></p><p>等待 wp 后</p><p>payload:</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">from</span> libnum <span class="token keyword">import</span> n2s</pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre>p <span class="token operator">=</span> <span class="token number">74997021559434065975272431626618720725838473091721936616560359000648651891507</span></pre></td></tr><tr><td data-num="4"></td><td><pre>a <span class="token operator">=</span> <span class="token number">61739043730332859978236469007948666997510544212362386629062032094925353519657</span></pre></td></tr><tr><td data-num="5"></td><td><pre>b <span class="token operator">=</span> <span class="token number">87821782818477817609882526316479721490919815013668096771992360002467657827319</span></pre></td></tr><tr><td data-num="6"></td><td><pre>k <span class="token operator">=</span> <span class="token number">93653874272176107584459982058527081604083871182797816204772644509623271061231</span></pre></td></tr><tr><td data-num="7"></td><td><pre>E <span class="token operator">=</span> EllipticCurve<span class="token punctuation">(</span>GF<span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">[</span>a<span class="token punctuation">,</span>b<span class="token punctuation">]</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="8"></td><td><pre>c1 <span class="token operator">=</span> E<span class="token punctuation">(</span><span class="token number">14455613666211899576018835165132438102011988264607146511938249744871964946084</span><span class="token punctuation">,</span> <span class="token number">25506582570581289714612640493258299813803157561796247330693768146763035791942</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="9"></td><td><pre>c2 <span class="token operator">=</span> E<span class="token punctuation">(</span><span class="token number">37554871162619456709183509122673929636457622251880199235054734523782483869931</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token number">71392055540616736539267960989304287083629288530398474590782366384873814477806</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="11"></td><td><pre>m<span class="token operator">=</span>c1<span class="token operator">-</span>k<span class="token operator">*</span>c2</pre></td></tr><tr><td data-num="12"></td><td><pre>cipher_left <span class="token operator">=</span> <span class="token number">68208062402162616009217039034331142786282678107650228761709584478779998734710</span></pre></td></tr><tr><td data-num="13"></td><td><pre>cipher_right <span class="token operator">=</span> <span class="token number">27453988545002384546706933590432585006240439443312571008791835203660152890619</span></pre></td></tr><tr><td data-num="14"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span>n2s<span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span>cipher_left<span class="token operator">//</span>m<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">+</span>n2s<span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span>cipher_right<span class="token operator">//</span>m<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr></table></figure><div class="tags"><a href="/tags/ctf-wp/" rel="tag"><i class="ic i-tag"></i> ctf-wp</a></div></div><footer><div class="meta"><span class="item"><span class="icon"><i class="ic i-calendar-check"></i> </span><span class="text">更新于</span> <time title="修改时间：2022-02-19 10:57:03" itemprop="dateModified" datetime="2022-02-19T10:57:03+08:00">2022-02-19</time> </span><span id="hgame2/" class="item leancloud_visitors" data-flag-title="hgame2022" title="阅读次数"><span class="icon"><i class="ic i-eye"></i> </span><span class="text">阅读次数</span> <span class="leancloud-visitors-count"></span> <span class="text">次</span></span></div><div class="reward"><button><i class="ic i-heartbeat"></i> 赞赏</button><p>请我喝[茶]~(￣▽￣)~*</p><div id="qr"><div><img data-src="/images/wechatpay.png" alt="GNIeliauk 微信支付"><p>微信支付</p></div></div></div><div id="copyright"><ul><li class="author"><strong>本文作者： </strong>GNIeliauk <i class="ic i-at"><em>@</em></i>GNI+Eliauk</li><li class="link"><strong>本文链接：</strong> <a href="http://kyrita.top/hgame2/" title="hgame2022">http://kyrita.top/hgame2/</a></li><li class="license"><strong>版权声明： </strong>本站所有文章除特别声明外，均采用 <span class="exturl" data-url="aHR0cHM6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LW5jLXNhLzQuMC9kZWVkLnpo"><i class="ic i-creative-commons"><em>(CC)</em></i>BY-NC-SA</span> 许可协议。转载请注明出处！</li></ul></div></footer></article></div><div class="post-nav"><div class="item left"><a href="/%E7%88%AC%E8%99%AB--%E6%A8%A1%E6%8B%9F%E7%99%BB%E5%BD%95/" itemprop="url" rel="prev" data-background-image="https:&#x2F;&#x2F;s3.bmp.ovh&#x2F;imgs&#x2F;2022&#x2F;01&#x2F;9a1f67ef8fb33bac.jpg" title="爬虫第二步——模拟登录"><span class="type">上一篇</span> <span class="category"><i class="ic i-flag"></i> 爬虫</span><h3>爬虫第二步——模拟登录</h3></a></div><div class="item right"><a href="/crypto/write/RSA%E5%92%8C%E4%B8%80%E4%BA%9B%E5%85%B6%E4%BB%96%E5%AF%86%E7%A0%81%E7%9F%A5%E8%AF%86%E7%9A%84%E5%BD%92%E7%BA%B3I/" itemprop="url" rel="next" data-background-image="https:&#x2F;&#x2F;s1.ax1x.com&#x2F;2022&#x2F;04&#x2F;14&#x2F;L1Xm4S.jpg" title="十万个 Crypto【Updating...】"><span class="type">下一篇</span> <span class="category"><i class="ic i-flag"></i> 密码学</span><h3>十万个 Crypto【Updating...】</h3></a></div></div><div class="wrap" id="comments"></div></div><div id="sidebar"><div class="inner"><div class="panels"><div class="inner"><div class="contents panel pjax" data-title="文章目录"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#web"><span class="toc-number">1.</span> <span class="toc-text">Web</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#easy_auth"><span class="toc-number">1.1.</span> <span class="toc-text">easy_auth</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%9B%9B%E8%9B%9B%E5%98%BF%E5%98%BF%E6%88%91%E7%9A%84%E8%9B%9B%E8%9B%9B"><span class="toc-number">1.2.</span> <span class="toc-text">蛛蛛... 嘿嘿♥我的蛛蛛</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#webpack-engine"><span class="toc-number">1.3.</span> <span class="toc-text">webpack-engine</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#crypto"><span class="toc-number">2.</span> <span class="toc-text">Crypto</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#easy-rsa"><span class="toc-number">2.1.</span> <span class="toc-text">Easy RSA</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#rsa-attack"><span class="toc-number">2.2.</span> <span class="toc-text">RSA Attack</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#rsa-attack2"><span class="toc-number">2.3.</span> <span class="toc-text">RSA Attack2</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#multi-prime-rsa"><span class="toc-number">2.4.</span> <span class="toc-text">Multi Prime RSA</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ecc"><span class="toc-number">2.5.</span> <span class="toc-text">ECC</span></a></li></ol></li></ol></div><div class="related panel pjax" data-title="系列文章"><ul><li><a href="/EZre/" rel="bookmark" title="RE-新年快乐">RE-新年快乐</a></li><li><a href="/BJDCTF2020-The-mystery-of-ip/" rel="bookmark" title="BJDCTF2020-The mystery of ip">BJDCTF2020-The mystery of ip</a></li><li><a href="/ctf-show-%E8%90%8C%E6%96%B0%E8%AE%A1%E5%88%921-7/" rel="bookmark" title="ctf.show-萌新web1-4">ctf.show-萌新web1-4</a></li><li><a href="/pwn/" rel="bookmark" title="砰！">砰！</a></li><li><a href="/%E8%AF%B7%E9%97%AE%E5%A4%A7%E5%90%89%E6%9D%AF%E7%9A%84%E7%AD%BE%E5%88%B0%E6%98%AF%E5%9C%A8%E8%BF%99%E9%87%8C%E7%AD%BE%E5%90%97/" rel="bookmark" title="请问大吉杯的签到是在这里签吗?">请问大吉杯的签到是在这里签吗?</a></li><li><a href="/ciscn-2019-n-1/" rel="bookmark" title="ciscn_2019_n_1">ciscn_2019_n_1</a></li><li><a href="/Rip%E8%A6%86%E7%9B%96/" rel="bookmark" title="Rip覆盖">Rip覆盖</a></li><li><a href="/XOR/" rel="bookmark" title="XOR">XOR</a></li><li><a href="/%E6%83%B3%E8%B9%AD%E7%BD%91%E5%85%88%E8%A7%A3%E5%BC%80%E5%AF%86%E7%A0%81-Crunch%E5%AF%86%E7%A0%81%E7%94%9F%E6%88%90%E5%99%A8/" rel="bookmark" title="想蹭网先解开密码&Crunch密码生成器">想蹭网先解开密码&Crunch密码生成器</a></li><li><a href="/UPLOAD/" rel="bookmark" title="UPLOAD">UPLOAD</a></li><li><a href="/easy-tornado/" rel="bookmark" title="Easy_Tornado">Easy_Tornado</a></li><li class="active"><a href="/hgame2/" rel="bookmark" title="hgame2022">hgame2022</a></li></ul></div><div class="overview panel" data-title="站点概览"><div class="author" itemprop="author" itemscope itemtype="http://schema.org/Person"><img class="image" itemprop="image" alt="GNIeliauk" data-src="/images/avatar.jpg"><p class="name" itemprop="name">GNIeliauk</p><div class="description" itemprop="description">再不放假就要坏掉了</div></div><nav class="state"><div class="item posts"><a href="/archives/"><span class="count">42</span> <span class="name">文章</span></a></div><div class="item categories"><a href="/categories/"><span class="count">24</span> <span class="name">分类</span></a></div><div class="item tags"><a href="/tags/"><span class="count">33</span> <span class="name">标签</span></a></div></nav><div class="social"><span class="exturl item github" data-url="aHR0cHM6Ly9naXRodWIuY29tL2d1ZGEwNDAyMQ==" title="https:&#x2F;&#x2F;github.com&#x2F;guda04021"><i class="ic i-github"></i></span> <span class="exturl item twitter" data-url="aHR0cHM6Ly90d2l0dGVyLmNvbS95b3VybmFtZQ==" title="https:&#x2F;&#x2F;twitter.com&#x2F;yourname"><i class="ic i-twitter"></i></span> <span class="exturl item music" data-url="aHR0cHM6Ly9tdXNpYy4xNjMuY29tLyMvdXNlci9ob21lP2lkPTM0NzUwMDI4Ng==" title="https:&#x2F;&#x2F;music.163.com&#x2F;#&#x2F;user&#x2F;home?id&#x3D;347500286"><i class="ic i-cloud-music"></i></span></div><ul class="menu"><li class="item"><a href="/" rel="section"><i class="ic i-home"></i>首页</a></li><li class="item"><a href="/resources/" rel="section"><i class="ic i-align-left"></i>随言</a></li><li class="item"><a href="/footstep/" rel="section"><i class="ic i-chart-area"></i>足迹</a></li><li class="item"><a href="/friends/" rel="section"><i class="ic i-sitemap"></i>链环</a></li></ul></div></div></div><ul id="quick"><li class="prev pjax"><a href="/%E7%88%AC%E8%99%AB--%E6%A8%A1%E6%8B%9F%E7%99%BB%E5%BD%95/" rel="prev" title="上一篇"><i class="ic i-chevron-left"></i></a></li><li class="up"><i class="ic i-arrow-up"></i></li><li class="down"><i class="ic i-arrow-down"></i></li><li class="next pjax"><a href="/crypto/write/RSA%E5%92%8C%E4%B8%80%E4%BA%9B%E5%85%B6%E4%BB%96%E5%AF%86%E7%A0%81%E7%9F%A5%E8%AF%86%E7%9A%84%E5%BD%92%E7%BA%B3I/" rel="next" title="下一篇"><i class="ic i-chevron-right"></i></a></li><li class="percent"></li></ul></div></div><div class="dimmer"></div></div></main><footer id="footer"><div class="inner"><div class="widgets"><div class="rpost pjax"><h2>随机文章</h2><ul><li class="item"><div class="breadcrumb"><a href="/categories/crypto/" title="分类于 Write-up">Write-up</a> <i class="ic i-angle-right"></i> <a href="/categories/crypto/write/" title="分类于 密码学">密码学</a></div><span><a href="/crypto/write/DH/" title="浅谈Diffie-Hellman">浅谈Diffie-Hellman</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/WEB%E5%89%8D%E5%90%8E%E7%AB%AF%E5%8E%9F%E7%90%86/" title="分类于 WEB前后端原理">WEB前后端原理</a> <i class="ic i-angle-right"></i> <a href="/categories/WEB%E5%89%8D%E5%90%8E%E7%AB%AF%E5%8E%9F%E7%90%86/%E5%90%8E%E7%AB%AF%E5%9F%BA%E7%A1%80SQL/" title="分类于 后端基础SQL">后端基础SQL</a></div><span><a href="/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%AE%80%E4%BB%8B%E5%8F%8ASQL%E8%AF%AD%E6%B3%95/" title="数据库简介及SQL语法">数据库简介及SQL语法</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/WEB%E5%89%8D%E5%90%8E%E7%AB%AF%E5%8E%9F%E7%90%86/" title="分类于 WEB前后端原理">WEB前后端原理</a> <i class="ic i-angle-right"></i> <a href="/categories/WEB%E5%89%8D%E5%90%8E%E7%AB%AF%E5%8E%9F%E7%90%86/%E5%90%8E%E7%AB%AF%E5%9F%BA%E7%A1%80SQL/" title="分类于 后端基础SQL">后端基础SQL</a></div><span><a href="/MySQL-Group-concat-%E7%9A%84%E7%94%A8%E6%B3%95/" title="MySQL Group_concat()的用法">MySQL Group_concat()的用法</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/%E6%91%84%E5%BD%B1/" title="分类于 摄影">摄影</a></div><span><a href="/%E5%91%90-%E7%B3%96%E6%9E%9C%E8%89%B2%E8%B0%83%E7%9A%84%E5%9B%BE%E7%89%87/" title="夏天就该喝糖果汽水才对嘛">夏天就该喝糖果汽水才对嘛</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/wp/" title="分类于 wp">wp</a> <i class="ic i-angle-right"></i> <a href="/categories/wp/web/" title="分类于 web">web</a></div><span><a href="/ctf-show-%E8%90%8C%E6%96%B0%E8%AE%A1%E5%88%921-7/" title="ctf.show-萌新web1-4">ctf.show-萌新web1-4</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/crypto/" title="分类于 Write-up">Write-up</a> <i class="ic i-angle-right"></i> <a href="/categories/crypto/write/" title="分类于 密码学">密码学</a></div><span><a href="/crypto/write/RSA%E5%92%8C%E4%B8%80%E4%BA%9B%E5%85%B6%E4%BB%96%E5%AF%86%E7%A0%81%E7%9F%A5%E8%AF%86%E7%9A%84%E5%BD%92%E7%BA%B3I/" title="十万个 Crypto【Updating...】">十万个 Crypto【Updating...】</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/%E7%94%9F%E6%B4%BB%E9%9A%8F%E7%AC%94/" title="分类于 生活随笔">生活随笔</a> <i class="ic i-angle-right"></i> <a href="/categories/%E7%94%9F%E6%B4%BB%E9%9A%8F%E7%AC%94/GAME/" title="分类于 GAME">GAME</a></div><span><a href="/Catherine/" title="Catherine">Catherine</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/wp/" title="分类于 wp">wp</a> <i class="ic i-angle-right"></i> <a href="/categories/wp/Re/" title="分类于 Re">Re</a></div><span><a href="/EZre/" title="RE-新年快乐">RE-新年快乐</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/number/" title="分类于 数论">数论</a> <i class="ic i-angle-right"></i> <a href="/categories/number/math/" title="分类于 Math">Math</a></div><span><a href="/number/math/RSA%E5%8A%A0%E5%AF%86%E7%AE%97%E6%B3%95%E8%AF%A6%E7%BB%86%E8%A7%A3%E8%AF%B4/" title="RSA加密算法详细解说">RSA加密算法详细解说</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/wiki/" title="分类于 wiki">wiki</a> <i class="ic i-angle-right"></i> <a href="/categories/wiki/python/" title="分类于 python">python</a></div><span><a href="/Python%E4%B8%ADtranslate-%E5%92%8Cmaketrans-%E7%9A%84%E4%BD%BF%E7%94%A8/" title="Python中translate()和maketrans()的使用">Python中translate()和maketrans()的使用</a></span></li></ul></div><div><h2>最新评论</h2><ul class="leancloud-recent-comment"></ul></div></div><div class="status"><div class="copyright">&copy; 2010 – <span itemprop="copyrightYear">2022</span> <span class="with-love"><i class="ic i-sakura rotate"></i> </span><span class="author" itemprop="copyrightHolder">GNIeliauk @ E raser</span></div><div class="count"><span class="post-meta-item-icon"><i class="ic i-chart-area"></i> </span><span title="站点总字数">319k 字</span> <span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="ic i-coffee"></i> </span><span title="站点阅读时长">4:50</span></div><img src="pic/o_1dfilp8ruo521thr1hvf18ji17soa.png"> <a href="https://beian.miit.gov.cn" style="color:#f72b07" target="_blank">苏ICP备 - 2021023834号</a><div class="powered-by">基于 <span class="exturl" data-url="aHR0cHM6Ly9oZXhvLmlv">Hexo</span> & Theme.<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2FtZWhpbWUvaGV4by10aGVtZS1zaG9rYQ==">Shoka</span></div></div></div></footer></div><script data-config type="text/javascript">var LOCAL={path:"hgame2/",favicon:{show:"咦?（●´3｀●)又好了",hide:"(´Д｀)坏掉了"},search:{placeholder:"文章搜索",empty:"关于 「 ${query} 」，什么也没搜到",stats:"${time} ms 内找到 ${hits} 条结果"},valine:!0,fancybox:!0,copyright:'复制成功，转载请遵守 <i class="ic i-creative-commons"></i>BY-NC-SA 协议。',ignores:[function(e){return e.includes("#")},function(e){return new RegExp(LOCAL.path+"$").test(e)}]}</script><script src="https://cdn.polyfill.io/v2/polyfill.js"></script><script src="//cdn.jsdelivr.net/combine/npm/pace-js@1.0.2/pace.min.js,npm/pjax@0.2.8/pjax.min.js,npm/whatwg-fetch@3.4.0/dist/fetch.umd.min.js,npm/animejs@3.2.0/lib/anime.min.js,npm/algoliasearch@4/dist/algoliasearch-lite.umd.js,npm/instantsearch.js@4/dist/instantsearch.production.min.js,npm/lozad@1/dist/lozad.min.js,npm/quicklink@2/dist/quicklink.umd.js"></script><script src="/js/app.js?v=0.2.5"></script></body></html>